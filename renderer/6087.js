(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[6087],{41716:(o,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>l});var t=n(23645),i=n.n(t)()((function(o){return o[1]}));i.push([o.id,".promotion {\n  position: absolute;\n  z-index: 1021;\n  bottom: 0;\n  right: 0;\n  padding: 0;\n  cursor: default;\n  user-select: none;\n  transition-timing-function: linear;\n}\n.promotion-close {\n  position: absolute;\n  z-index: 1;\n  fill-opacity: 0.5;\n  padding: 5px;\n  opacity: var(--opacity);\n  width: 20px;\n  height: 20px;\n  right: 6px;\n  top: 12px;\n}\n.promotion-close:hover {\n  opacity: 1;\n}\n.promotion-close:before,\n.promotion-close:after {\n  position: absolute;\n  left: 9px;\n  content: ' ';\n  height: 11px;\n  width: 1px;\n  background-color: var(--close-color);\n}\n.promotion-close:before {\n  transform: rotate(45deg);\n}\n.promotion-close:after {\n  transform: rotate(-45deg);\n}\n.promotion.expand {\n  margin-bottom: 0 !important;\n}\n.promotion webview {\n  display: inline-flex;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  margin: 0px;\n  padding: 0px;\n}\n",""]);const l=i},91202:(o,e,n)=>{"use strict";n.d(e,{$0:()=>i});var t=n(67657);t.app.vud;const i=t.app.eventManager;t.app.tvud,t.app.workspace},46087:(o,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var t=n(2954),i=n(57310),l=n(63477),a=n.n(l),r=n(67657),s=n(87141),u=n(27049),p=n(46016),c=n(91202),d=n(18621),v=n(85786),m=n(23352);const h=(0,t.aZ)({__name:"index",setup(o){const e=(0,m.ZP)("promotion"),n=(0,t.iH)(!1),l=(0,t.iH)(!1),h=(0,t.iH)(!0),f=(0,t.iH)(null),g=(0,t.iH)(null),w=(0,t.Fl)((()=>(0,s.Gu)().currentPromotion.id)),b=(0,t.Fl)((()=>(0,s.Gu)().currentPromotion.duration)),x=(0,t.Fl)((()=>(0,s.Gu)().currentPromotion.url)),y=(0,t.Fl)((()=>i.parse(x.value))),F=(0,t.Fl)((()=>a().parse(y.value.query))),P=(0,t.Fl)((()=>F.value.w||0)),_=(0,t.Fl)((()=>F.value.h||0)),C=(0,t.Fl)((()=>"#"+F.value["close-color"]||0)),G=(0,t.Fl)((()=>F.value.opacity||.3)),k=(0,t.Fl)((()=>l.value&&n.value&&h.value&&!(0,u.E)().isBeginnerModeVisible&&!(0,u.E)().isBeginnerDialogVisible&&!(0,p.$)().zenMode&&!(0,p.$)().pitchMode)),O=(0,t.Fl)((()=>({width:P.value+"px",height:_.value+"px",marginBottom:"-"+_.value+"px",transition:l.value?"margin-bottom .8s":null}))),H=(0,t.Fl)((()=>({"--close-color":C.value,"--opacity":G.value}))),L=(0,t.Fl)((()=>({expand:k.value}))),W=(o=!0)=>{b.value<=0||(o?f.value=setTimeout((()=>{n.value=!1,l.value=!1,j("autoClose")}),b.value):clearTimeout(f.value))},j=o=>{n.value=!1,c.$0.emit("promotion:completedOne",{eventid:w.value,winid:r.getCurrentWindow().id}),(0,d.L9)({eventCategory:"Notification",eventAction:"closePromotionBy"+o,eventName:w.value}),(0,s.Gu)().setCurrentPromotion(null)};if((0,s.Gu)().currentPromotion&&"popup"===(0,s.Gu)().currentPromotion.style)if(e.info("Event id:",(0,s.Gu)().currentPromotion.id),P.value&&_.value){const o=y.value.protocol;"http:"!==o&&"https:"!==o&&(e.warn("Wrong url protocol!"),j("wrongProtocol"))}else e.warn("Wrong width or height!"),j("wrongWidthOrHeight");return(0,t.YP)(k,(()=>{W(k.value)})),(0,t.bv)((()=>{l.value=!1})),(0,t.Jd)((()=>{g.value&&delete g.value,(0,s.Gu)().setCurrentPromotion(null),(0,s.Gu)().addEvents((0,s.Gu)().matchEvents),(0,s.Gu)().setIsPromotionShowing(!1)})),{__sfc:!0,logger:e,ready:n,loadFinish:l,httpResponseStatus:h,timer:f,webviewRef:g,eventid:w,duration:b,url:x,uri:y,uriquery:F,width:P,height:_,closeColor:C,opacity:G,show:k,styleObject:O,closeStyleObject:H,classObject:L,setAutoClose:W,finishLoad:()=>{l.value=!0,n.value=!0,(0,d.Fk)({actionName:"Promotion"})},newWindow:o=>{const n=i.parse(o.url).protocol;if("http:"!==n&&"https:"!==n)return void e.info("Invalid protocol:",o.url);j("newWindow");const t=(0,s.JE)().T;(0,v.DL)(o.url,t)},checkHttpResponse:o=>{200!==o.httpResponseCode&&(e.info("Http request fail:",o),h.value=!1)},failLoad:o=>{e.info("FailLoad:",o),n.value=!1},closeOne:j}}});n(3868);const f=(0,n(51900).Z)(h,(function(){var o=this,e=o._self._c,n=o._self._setupProxy;return e("div",{staticClass:"promotion",class:n.classObject,style:n.styleObject},[e("span",{staticClass:"promotion-close",style:n.closeStyleObject,on:{click:function(o){return n.closeOne("closeButton")}}}),o._v(" "),e("webview",{ref:"webviewRef",attrs:{src:n.url,allowpopups:""},on:{"did-finish-load":n.finishLoad,"did-fail-load":n.failLoad,"new-window":n.newWindow,"did-get-response-details":n.checkHttpResponse}})],1)}),[],!1,null,null,null).exports},3868:(o,e,n)=>{var t=n(41716);t.__esModule&&(t=t.default),"string"==typeof t&&(t=[[o.id,t,""]]),t.locals&&(o.exports=t.locals);(0,n(45346).Z)("23e7c3ec",t,!0,{})}}]);