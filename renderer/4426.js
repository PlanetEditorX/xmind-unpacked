/*! For license information please see 4426.js.LICENSE.txt */
(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[4426],{26601:(t,e,n)=>{"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t){var e,n,r=t.sizes.shift(),i=Math.max(Math.ceil(r[0]),1),o=Math.max(Math.ceil(r[1]),1),s=[i-1,o-1,1,1],a=Date.now(),l="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;l?(e=new OffscreenCanvas(1,1),n=new OffscreenCanvas(i,o)):((e=document.createElement("canvas")).width=1,e.height=1,(n=document.createElement("canvas")).width=i,n.height=o);var c=e.getContext("2d"),u=n.getContext("2d");u&&(u.fillRect.apply(u,s),c.drawImage(n,i-1,o-1,1,1,0,0,1,1));var d=c&&0!==c.getImageData(0,0,1,1).data[3],p=Date.now()-a;return[e,n].forEach((function(t){t.height=0,t.width=0})),l?(postMessage({width:i,height:o,benchmark:p,isTestPass:d}),!d&&t.sizes.length&&h(t)):d?t.onSuccess(i,o,p):(t.onError(i,o,p),t.sizes.length&&h(t)),d}n.d(e,{Z:()=>v});var d=[16384,14188,11402,11180,10836,8192,4096,1],p=[8388607,65535,32767,16384,8192,4096,1],f=[4194303,65535,32767,16384,8192,4096,1],m=["onError","onSuccess"],g={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},y={};function b(t){var e=t.width===t.height,n=1===t.height,r=1===t.width,i=[];if(t.width&&t.height)for(var o=t.min||g.min,s=t.step||g.step,a=Math.max(t.width,t.height);a>=o;){var l=e||n?a:1,c=e||r?a:1;i.push([l,c]),a-=s}else t.sizes.forEach((function(t){var o=e||n?t:1,s=e||r?t:1;i.push([o,s])}));return i}function _(t){var e=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),o=t.onError,l=t.onSuccess,c=s(t,m),u=null;if(!e)return!1;if(t.useWorker&&n){var d="\n            var canvasTest = ".concat(h.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),p=new Blob([d],{type:"application/javascript"}),f=URL.createObjectURL(p);u=new Worker(f),URL.revokeObjectURL(f),u.onmessage=function(t){var e=t.data,n=e.width,i=e.height,o=e.benchmark;e.isTestPass?(y[r].onSuccess(n,i,o),delete y[r]):y[r].onError(n,i,o)}}return t.usePromise?new Promise((function(e,n){var s=i(i({},t),{},{onError:function(e,r,i){var s;if(0===t.sizes.length)s=!0;else{var l=a(t.sizes.slice(-1),1),c=a(l[0],2),u=c[0],h=c[1];s=e===u&&r===h}o(e,r,i),s&&n({width:e,height:r,benchmark:i})},onSuccess:function(t,n,r){l(t,n,r),e({width:t,height:n,benchmark:r})}});if(u){var d=s.onError,p=s.onSuccess;y[r]={onError:d,onSuccess:p},u.postMessage(c)}else h(s)})):u?(y[r]={onError:o,onSuccess:l},void u.postMessage(c)):h(t)}var v={maxArea:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=b({width:t.max,height:t.max,min:t.min,step:t.step,sizes:l(d)});return _(i(i(i({},g),t),{},{sizes:e}))},maxHeight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=b({width:1,height:t.max,min:t.min,step:t.step,sizes:l(p)});return _(i(i(i({},g),t),{},{sizes:e}))},maxWidth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=b({width:t.max,height:1,min:t.min,step:t.step,sizes:l(f)});return _(i(i(i({},g),t),{},{sizes:e}))},test:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i(i({},g),t);return e.sizes=l(e.sizes),e.width&&e.height&&(e.sizes=[[e.width,e.height]]),_(e)}}},41809:(t,e)=>{"use strict";function n(t){var e=-1;r||(r=function(){for(var t=new Int32Array(256),e=0;e<256;e++){for(var n=e,r=0;r<8;r++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t}());for(var n=0;n<t.length;n++)e=r[255&(e^t[n])]^e>>>8;return-1^e}e.E4=function(t,e){var n=t.slice(0,33);return new Promise((function(r,i){var o=new FileReader;o.onload=function(){var n=new Uint8Array(o.result),i=t.slice(33),s=p(n,e,t.type);r(new Blob([s,i],{type:t.type}))},o.readAsArrayBuffer(n)}))},e.Hv=function(t,e){var n=t.split(","),r=n[0],c=n[1],u=void 0,h=void 0,d=!1;if(-1!==r.indexOf(i)){u=i;var f=function(t){var e=t.indexOf(s);-1===e&&(e=t.indexOf(a));-1===e&&(e=t.indexOf(l));return e}(c);f>=0?(h=4*Math.ceil((f+28)/3),d=!0):h=44}-1!==r.indexOf(o)&&(u=o,h=24);for(var m=c.substring(0,h),g=c.substring(h),y=atob(m),b=new Uint8Array(y.length),_=0;_<b.length;_++)b[_]=y.charCodeAt(_);var v=p(b,e,u,d),x=btoa(String.fromCharCode.apply(String,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(v)));return[r,",",x,g].join("")};var r=void 0,i="image/png",o="image/jpeg",s="AAlwSFlz",a="AAAJcEhZ",l="AAAACXBI",c="p".charCodeAt(0),u="H".charCodeAt(0),h="Y".charCodeAt(0),d="s".charCodeAt(0);function p(t,e,r,s){if(r===o)return t[13]=1,t[14]=e>>8,t[15]=255&e,t[16]=e>>8,t[17]=255&e,t;if(r===i){var a=new Uint8Array(13);e*=39.3701,a[0]=c,a[1]=u,a[2]=h,a[3]=d,a[4]=e>>>24,a[5]=e>>>16,a[6]=e>>>8,a[7]=255&e,a[8]=a[4],a[9]=a[5],a[10]=a[6],a[11]=a[7],a[12]=1;var l=n(a),p=new Uint8Array(4);if(p[0]=l>>>24,p[1]=l>>>16,p[2]=l>>>8,p[3]=255&l,s){var f=function(t){for(var e=t.length-1;e>=4;e--)if(9===t[e-4]&&t[e-3]===c&&t[e-2]===u&&t[e-1]===h&&t[e]===d)return e-3}(t);return t.set(a,f),t.set(p,f+13),t}var m=new Uint8Array(4);m[0]=0,m[1]=0,m[2]=0,m[3]=9;var g=new Uint8Array(54);return g.set(t,0),g.set(m,33),g.set(a,37),g.set(p,50),g}}},18552:(t,e,n)=>{var r=n(10852)(n(55639),"DataView");t.exports=r},1989:(t,e,n)=>{var r=n(51789),i=n(80401),o=n(57667),s=n(21327),a=n(81866);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=a,t.exports=l},38407:(t,e,n)=>{var r=n(27040),i=n(14125),o=n(82117),s=n(67518),a=n(54705);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=a,t.exports=l},57071:(t,e,n)=>{var r=n(10852)(n(55639),"Map");t.exports=r},83369:(t,e,n)=>{var r=n(24785),i=n(11285),o=n(96e3),s=n(49916),a=n(95265);function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=a,t.exports=l},53818:(t,e,n)=>{var r=n(10852)(n(55639),"Promise");t.exports=r},58525:(t,e,n)=>{var r=n(10852)(n(55639),"Set");t.exports=r},88668:(t,e,n)=>{var r=n(83369),i=n(90619),o=n(72385);function s(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,t.exports=s},46384:(t,e,n)=>{var r=n(38407),i=n(37465),o=n(63779),s=n(67599),a=n(44758),l=n(34309);function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=l,t.exports=c},62705:(t,e,n)=>{var r=n(55639).Symbol;t.exports=r},11149:(t,e,n)=>{var r=n(55639).Uint8Array;t.exports=r},70577:(t,e,n)=>{var r=n(10852)(n(55639),"WeakMap");t.exports=r},34963:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}},14636:(t,e,n)=>{var r=n(22545),i=n(35694),o=n(1469),s=n(44144),a=n(65776),l=n(36719),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),u=!n&&i(t),h=!n&&!u&&s(t),d=!n&&!u&&!h&&l(t),p=n||u||h||d,f=p?r(t.length,String):[],m=f.length;for(var g in t)!e&&!c.call(t,g)||p&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,m))||f.push(g);return f}},62488:t=>{t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},82908:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},18470:(t,e,n)=>{var r=n(77813);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},68866:(t,e,n)=>{var r=n(62488),i=n(1469);t.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},44239:(t,e,n)=>{var r=n(62705),i=n(89607),o=n(2333),s=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?i(t):o(t)}},9454:(t,e,n)=>{var r=n(44239),i=n(37005);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},90939:(t,e,n)=>{var r=n(2492),i=n(37005);t.exports=function t(e,n,o,s,a){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,o,s,t,a))}},2492:(t,e,n)=>{var r=n(46384),i=n(67114),o=n(18351),s=n(16096),a=n(64160),l=n(1469),c=n(44144),u=n(36719),h="[object Arguments]",d="[object Array]",p="[object Object]",f=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,m,g,y){var b=l(t),_=l(e),v=b?d:a(t),x=_?d:a(e),w=(v=v==h?p:v)==p,S=(x=x==h?p:x)==p,j=v==x;if(j&&c(t)){if(!c(e))return!1;b=!0,w=!1}if(j&&!w)return y||(y=new r),b||u(t)?i(t,e,n,m,g,y):o(t,e,v,n,m,g,y);if(!(1&n)){var R=w&&f.call(t,"__wrapped__"),I=S&&f.call(e,"__wrapped__");if(R||I){var O=R?t.value():t,k=I?e.value():e;return y||(y=new r),g(O,k,n,m,y)}}return!!j&&(y||(y=new r),s(t,e,n,m,g,y))}},28458:(t,e,n)=>{var r=n(23560),i=n(15346),o=n(13218),s=n(80346),a=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,h=c.hasOwnProperty,d=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?d:a).test(s(t))}},38749:(t,e,n)=>{var r=n(44239),i=n(41780),o=n(37005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!s[r(t)]}},280:(t,e,n)=>{var r=n(25726),i=n(86916),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},22545:t=>{t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},7518:t=>{t.exports=function(t){return function(e){return t(e)}}},74757:t=>{t.exports=function(t,e){return t.has(e)}},14429:(t,e,n)=>{var r=n(55639)["__core-js_shared__"];t.exports=r},67114:(t,e,n)=>{var r=n(88668),i=n(82908),o=n(74757);t.exports=function(t,e,n,s,a,l){var c=1&n,u=t.length,h=e.length;if(u!=h&&!(c&&h>u))return!1;var d=l.get(t),p=l.get(e);if(d&&p)return d==e&&p==t;var f=-1,m=!0,g=2&n?new r:void 0;for(l.set(t,e),l.set(e,t);++f<u;){var y=t[f],b=e[f];if(s)var _=c?s(b,y,f,e,t,l):s(y,b,f,t,e,l);if(void 0!==_){if(_)continue;m=!1;break}if(g){if(!i(e,(function(t,e){if(!o(g,e)&&(y===t||a(y,t,n,s,l)))return g.push(e)}))){m=!1;break}}else if(y!==b&&!a(y,b,n,s,l)){m=!1;break}}return l.delete(t),l.delete(e),m}},18351:(t,e,n)=>{var r=n(62705),i=n(11149),o=n(77813),s=n(67114),a=n(68776),l=n(21814),c=r?r.prototype:void 0,u=c?c.valueOf:void 0;t.exports=function(t,e,n,r,c,h,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new i(t),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var p=a;case"[object Set]":var f=1&r;if(p||(p=l),t.size!=e.size&&!f)return!1;var m=d.get(t);if(m)return m==e;r|=2,d.set(t,e);var g=s(p(t),p(e),r,c,h,d);return d.delete(t),g;case"[object Symbol]":if(u)return u.call(t)==u.call(e)}return!1}},16096:(t,e,n)=>{var r=n(58234),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,o,s,a){var l=1&n,c=r(t),u=c.length;if(u!=r(e).length&&!l)return!1;for(var h=u;h--;){var d=c[h];if(!(l?d in e:i.call(e,d)))return!1}var p=a.get(t),f=a.get(e);if(p&&f)return p==e&&f==t;var m=!0;a.set(t,e),a.set(e,t);for(var g=l;++h<u;){var y=t[d=c[h]],b=e[d];if(o)var _=l?o(b,y,d,e,t,a):o(y,b,d,t,e,a);if(!(void 0===_?y===b||s(y,b,n,o,a):_)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var v=t.constructor,x=e.constructor;v==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof x&&x instanceof x||(m=!1)}return a.delete(t),a.delete(e),m}},31957:t=>{var e="object"==typeof global&&global&&global.Object===Object&&global;t.exports=e},58234:(t,e,n)=>{var r=n(68866),i=n(99551),o=n(3674);t.exports=function(t){return r(t,o,i)}},45050:(t,e,n)=>{var r=n(37019);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},10852:(t,e,n)=>{var r=n(28458),i=n(47801);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},89607:(t,e,n)=>{var r=n(62705),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),n=t[a];try{t[a]=void 0;var r=!0}catch(t){}var i=s.call(t);return r&&(e?t[a]=n:delete t[a]),i}},99551:(t,e,n)=>{var r=n(34963),i=n(70479),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(t){return null==t?[]:(t=Object(t),r(s(t),(function(e){return o.call(t,e)})))}:i;t.exports=a},64160:(t,e,n)=>{var r=n(18552),i=n(57071),o=n(53818),s=n(58525),a=n(70577),l=n(44239),c=n(80346),u="[object Map]",h="[object Promise]",d="[object Set]",p="[object WeakMap]",f="[object DataView]",m=c(r),g=c(i),y=c(o),b=c(s),_=c(a),v=l;(r&&v(new r(new ArrayBuffer(1)))!=f||i&&v(new i)!=u||o&&v(o.resolve())!=h||s&&v(new s)!=d||a&&v(new a)!=p)&&(v=function(t){var e=l(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case m:return f;case g:return u;case y:return h;case b:return d;case _:return p}return e}),t.exports=v},47801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},51789:(t,e,n)=>{var r=n(94536);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},80401:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},57667:(t,e,n)=>{var r=n(94536),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},21327:(t,e,n)=>{var r=n(94536),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},81866:(t,e,n)=>{var r=n(94536);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},65776:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,n){var r=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&e.test(t))&&t>-1&&t%1==0&&t<n}},37019:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},15346:(t,e,n)=>{var r,i=n(14429),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},25726:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},27040:t=>{t.exports=function(){this.__data__=[],this.size=0}},14125:(t,e,n)=>{var r=n(18470),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},82117:(t,e,n)=>{var r=n(18470);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},67518:(t,e,n)=>{var r=n(18470);t.exports=function(t){return r(this.__data__,t)>-1}},54705:(t,e,n)=>{var r=n(18470);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},24785:(t,e,n)=>{var r=n(1989),i=n(38407),o=n(57071);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},11285:(t,e,n)=>{var r=n(45050);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},96e3:(t,e,n)=>{var r=n(45050);t.exports=function(t){return r(this,t).get(t)}},49916:(t,e,n)=>{var r=n(45050);t.exports=function(t){return r(this,t).has(t)}},95265:(t,e,n)=>{var r=n(45050);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},68776:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}},94536:(t,e,n)=>{var r=n(10852)(Object,"create");t.exports=r},86916:(t,e,n)=>{var r=n(5569)(Object.keys,Object);t.exports=r},31167:(t,e,n)=>{t=n.nmd(t);var r=n(31957),i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,s=o&&o.exports===i&&r.process,a=function(){try{var t=o&&o.require&&o.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=a},2333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5569:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},55639:(t,e,n)=>{var r=n(31957),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},90619:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},72385:t=>{t.exports=function(t){return this.__data__.has(t)}},21814:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}},37465:(t,e,n)=>{var r=n(38407);t.exports=function(){this.__data__=new r,this.size=0}},63779:t=>{t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},67599:t=>{t.exports=function(t){return this.__data__.get(t)}},44758:t=>{t.exports=function(t){return this.__data__.has(t)}},34309:(t,e,n)=>{var r=n(38407),i=n(57071),o=n(83369);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(t,e),this.size=n.size,this}},80346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},77813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},35694:(t,e,n)=>{var r=n(9454),i=n(37005),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,l=r(function(){return arguments}())?r:function(t){return i(t)&&s.call(t,"callee")&&!a.call(t,"callee")};t.exports=l},1469:t=>{var e=Array.isArray;t.exports=e},98612:(t,e,n)=>{var r=n(23560),i=n(41780);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},44144:(t,e,n)=>{t=n.nmd(t);var r=n(55639),i=n(95062),o=e&&!e.nodeType&&e,s=o&&t&&!t.nodeType&&t,a=s&&s.exports===o?r.Buffer:void 0,l=(a?a.isBuffer:void 0)||i;t.exports=l},18446:(t,e,n)=>{var r=n(90939);t.exports=function(t,e){return r(t,e)}},23560:(t,e,n)=>{var r=n(44239),i=n(13218);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},41780:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},13218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},37005:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},36719:(t,e,n)=>{var r=n(38749),i=n(7518),o=n(31167),s=o&&o.isTypedArray,a=s?i(s):r;t.exports=a},3674:(t,e,n)=>{var r=n(14636),i=n(280),o=n(98612);t.exports=function(t){return o(t)?r(t):i(t)}},70479:t=>{t.exports=function(){return[]}},95062:t=>{t.exports=function(){return!1}},83556:(t,e,n)=>{"use strict";n.d(e,{ER:()=>c,EW:()=>l,WX:()=>a,Zf:()=>s,s_:()=>i,yo:()=>o});var r=n(54586);function i(){return new r.t3}function o(t){return new r.eN(t)}function s(){return new r.GO}function a(){return new r.XZ}function l(){return new r.r3}function c(){return new r.gn}},54586:(t,e,n)=>{"use strict";n.d(e,{GO:()=>u,XZ:()=>h,eN:()=>c,gn:()=>p,r3:()=>d,t3:()=>l});var r=n(71381),i=n(77997),o=n(69798),s=n(87494),a=n(69598);class l{_patch={metadata:{[r.KZ.DataStructureVersion]:s.iO}};metadataFor(t,e){return this._patch.metadata={...this._patch.metadata,[t]:e},this}sheets(t){return this._patch.sheets=(Array.isArray(t)?t:t.sheets??[]).map((t=>(0,o.xp)(t,c).patch)),this}build(){return new i.s((0,a.vA)(this._patch))}Sheet(){return new c}Topic(){return new u}Relationship(){return new h}Boundary(){return new d}Summary(){return new p}Callout(){return new u}}class c{_patch;constructor(t){this._patch={...t,id:t?.id??(0,o.Vj)(),rootTopic:t?.rootTopic??(new u).patch}}get id(){return this._patch.id}get patch(){return this._patch}rootTopic(t){return this._patch.rootTopic=(0,o.xp)(t,u).patch,this}relationships(t){return this._patch.relationships=t.map((t=>(0,o.xp)(t,h).patch)),this}attrs(t){return Object.assign(this._patch,(0,o.zO)(t)),this}extensionBy(t,e){return this._patch.extensions||(this._patch.extensions={}),this._patch.extensions[t]=(0,o.zO)(e),this}markerDescriptionFor(t,e){return this._patch.legendMarkers||(this._patch.legendMarkers={}),Object.assign(this._patch.legendMarkers,{[t]:e}),this}styleFor(t,e){if("string"==typeof t){const n=t;this._patch.themeStyles={...this._patch.themeStyles,[n]:e?{...e}:null}}else{const e=t;this._patch.themeStyles={...this._patch.themeStyles,...e}}return this}Topic(){return new u}Relationship(){return new h}Boundary(){return new d}Summary(){return new p}Callout(){return new u}}class u{_patch;_ownerSummaryPatch;constructor(t){t&&"topic"in t?(this._patch=(0,o.yR)(t.topic),this._ownerSummaryPatch=t):this._patch={...t,id:t?.id??(0,o.Vj)()}}get id(){return this._patch.id}get patch(){return this._patch}extensionBy(t,e){return this._patch.extensions||(this._patch.extensions={}),this._patch.extensions[t]=(0,o.zO)(e),this}attrs(t){return Object.assign(this._patch,(0,o.zO)(t)),this}children(t){return this._patch.children=(Array.isArray(t)?t:t.topics??[]).map((t=>(0,o.xp)(t,u).patch)),this._patch.childrenAssociations=Array.isArray(t)?{boundaries:[],summaries:[],relationships:[]}:{boundaries:(t.boundaries??[]).map((t=>(0,o.xp)(t,d).patch)),summaries:(t.summaries??[]).map((t=>(0,o.xp)(t,p).patch)),relationships:(t.relationships??[]).map((t=>(0,o.xp)(t,h).patch))},this}detachedChildren(t){return this._patch.detachedChildren=(Array.isArray(t)?t:t.topics??[]).map((t=>(0,o.xp)(t,u).patch)),this._patch.detachedChildrenAssociations=Array.isArray(t)?{boundaries:[],summaries:[],relationships:[]}:{boundaries:(t.boundaries??[]).map((t=>(0,o.xp)(t,d).patch)),summaries:(t.summaries??[]).map((t=>(0,o.xp)(t,p).patch)),relationships:(t.relationships??[]).map((t=>(0,o.xp)(t,h).patch))},this}callout(t){return this._patch.callout=(0,o.xp)(t,u).patch,this}boundaries(t){return this._patch.boundaries=t.map((t=>(0,o.xp)(t,d).patch)),this}summaries(t){return this._patch.summaries=t.map((t=>(0,o.xp)(t,p).patch)),this}asSummary(){return new p(this._ownerSummaryPatch??{topic:this._patch})}}class h{_patch;constructor(t){this._patch={...t,id:t?.id??(0,o.Vj)()}}get id(){return this._patch.id}get patch(){return this._patch}target(t){return this._patch.target=t,this}source(t){return this._patch.source=t,this}attrs(t){return Object.assign(this._patch,(0,o.zO)(t)),this}}class d{_patch;constructor(t){this._patch={...t,id:t?.id??(0,o.Vj)()}}get id(){return this._patch.id}get patch(){return this._patch}rangeStart(t){return this._patch.rangeStart=t,this}rangeEnd(t){return this._patch.rangeEnd=t,this}rangeType(t){return this._patch.rangeType=t,this}attrs(t){return Object.assign(this._patch,(0,o.zO)(t)),this}}class p{_patch;constructor(t){this._patch={...t,id:t?.id??(0,o.Vj)(),topic:t?.topic??(new u).patch}}get id(){return this._patch.id}get patch(){return this._patch}topic(t){return this._patch.topic=(0,o.xp)(t,u).patch,this}rangeStart(t){return this._patch.rangeStart=t,this}rangeEnd(t){return this._patch.rangeEnd=t,this}asTopic(){return new u(this._patch)}attrs(t){return Object.assign(this._patch,(0,o.zO)(t)),this}}},67649:(t,e,n)=>{"use strict";n.d(e,{A_:()=>d,G5:()=>p,Py:()=>y,VR:()=>b,_N:()=>f,bJ:()=>m,bW:()=>g});var r=n(71381),i=n(69798),o=n(69598),s=n(49787),a=n(39546),l=n(53105),c=n(60681),u=n(2104),h=n(84727);function d(t,e){return(0,o.s6)(t,((t,n,r)=>{const o=(0,i.yR)((0,s.az)(t,e.id)),l=(0,i.yR)((0,a.XS)(t,e.id));f(t,e,{refResolver:n,ownerSheetId:o,parentTopicId:l}),r(o)}))}function p(t,e){return(0,o.s6)(t,((t,n,r)=>{for(const[o,l]of Object.entries(e.boundaryPatchById)){const e=(0,i.yR)((0,s.az)(t,o));f(t,{id:o,...l},{refResolver:n,ownerSheetId:e,parentTopicId:(0,i.yR)((0,a.XS)(t,o))}),r(e)}}))}function f(t,e,n){const{id:r,ref:o,title:c,rangeStart:u,rangeEnd:h,rangeType:d}=e;(0,s.sb)(t,r)||(0,s.pE)(t,{id:r,type:"boundary"},n.ownerSheetId);const{parentTopicId:p}=n;(0,a.er)(t,r,p);const f=(0,i.yR)((0,s.j4)((0,s.sb)(t,r)));return void 0!==o&&(0,l.Pt)(t,f,o),void 0!==c&&(0,i.Lj)(f,"title",c),void 0!==e.attributedTitle&&(0,i.Lj)(f,"attributedTitle",e.attributedTitle),"parent"===d?((0,i.Lj)(f,"rangeType","parent"),(0,i.Lj)(f,"rangeStart",0),(0,i.Lj)(f,"rangeEnd",0)):"parent"!==f.rangeType&&((0,i.Lj)(f,"rangeType","children"),void 0!==u&&(0,i.Lj)(f,"rangeStart",u),void 0!==h&&(0,i.Lj)(f,"rangeEnd",h)),void 0!==e.classes&&(0,i.Lj)(f,"classes",e.classes.length>0?[...e.classes]:null),void 0!==e.shapeClass&&(0,i.Lj)(f,"shapeClass",e.shapeClass),void 0!==e.fillColor&&(0,i.Lj)(f,"fillColor",e.fillColor),void 0!==e.fillOpacity&&(0,i.Lj)(f,"fillOpacity",e.fillOpacity),void 0!==e.textColor&&(0,i.Lj)(f,"textColor",e.textColor),void 0!==e.fontFamily&&(0,i.Lj)(f,"fontFamily",e.fontFamily),void 0!==e.fontSize&&(0,i.Lj)(f,"fontSize",e.fontSize),void 0!==e.lineColor&&(0,i.Lj)(f,"lineColor",e.lineColor),void 0!==e.lineWidth&&(0,i.Lj)(f,"lineWidth",e.lineWidth),void 0!==e.linePattern&&(0,i.Lj)(f,"linePattern",e.linePattern),void 0!==e.fillPattern&&(0,i.Lj)(f,"fillPattern",e.fillPattern),void 0!==e.fontWeight&&(0,i.Lj)(f,"fontWeight",e.fontWeight),void 0!==e.fontStyle&&(0,i.Lj)(f,"fontStyle",e.fontStyle),void 0!==e.textTransform&&(0,i.Lj)(f,"textTransform",e.textTransform),void 0!==e.textDecoration&&(0,i.Lj)(f,"textDecoration",e.textDecoration),void 0!==e.textAlign&&(0,i.Lj)(f,"textAlign",e.textAlign),r}function m(t,e,n=!0){const r=(0,s.j4)((0,s.sb)(t,e));if(!r)return;if(n){const n=(0,a.XS)(t,e);if(n){const r=(0,i.yR)((0,s.Ob)((0,s.sb)(t,n)));r.boundaries=r.boundaries?.filter((t=>t!==e))}}const o=r.ref;o&&(0,l.OO)(t,o),[...(0,c.um)(t,e)??[]].forEach((e=>(0,h.sE)(t,e))),[...(0,c.$r)(t,e)??[]].forEach((e=>(0,h.sE)(t,e))),(0,c.Eo)(t,e),(0,c.it)(t,e),(0,a.FW)(t,e),(0,s.bX)(t,e)}function g(t,e){const n=(0,i.yR)((0,s.Ob)((0,s.sb)(t,e))),{children:r,boundaries:o}=n;if(!o?.length)return;const a=o?.map((e=>{const{rangeStart:n,rangeEnd:o,rangeType:a}=(0,i.yR)((0,s.j4)((0,s.sb)(t,e)));return"parent"===a||(0,i.KC)(n,o,r?.length??0)?e:(m(t,e,!1),null)})).filter((t=>null!==t))??[];(0,i.Lj)(n,"boundaries",a.length?a:null)}function y(t,e,n){const{parentTopic:o,rangeType:c}=n;if("parent"===c){const e=o?(0,l.IP)(t,o):null;return e&&(0,s.Ob)((0,s.sb)(t,e))&&(0,u.HA)(t,e)===r.oz.Detached?{rangeType:"parent",parentTopicId:e}:null}let h=null;if(o&&(h=o?(0,l.IP)(t,o):null,!h||!(0,s.Ob)((0,s.sb)(t,h))))return null;const d=h??(0,i.yR)((0,a.XS)(t,e)),p=(0,i.yR)((0,s.Ob)((0,s.sb)(t,d))),f=p.children?.length??0;if(f<=0)return null;const{rangeStart:m,rangeEnd:g}=n,y=(0,i.yR)((0,s.j4)((0,s.sb)(t,e))),b=(0,i.hj)(m)&&m>=0&&m<f?m:y.rangeStart,_=(0,i.hj)(g)&&g>=0&&g<f?g:y.rangeEnd;if(!(0,i.hj)(b)||!(0,i.hj)(_)||b>_)return null;const v={rangeType:"children",rangeStart:b,rangeEnd:_};return h?{...v,parentTopicId:h}:v}function b(t,e,n){const{rangeStart:r,rangeEnd:o,parentTopicId:l,rangeType:c}=n,u=(0,i.yR)((0,s.j4)((0,s.sb)(t,e)));l&&(0,a.er)(t,e,l),"parent"===c?((0,i.Lj)(u,"rangeType","parent"),(0,i.Lj)(u,"rangeStart",0),(0,i.Lj)(u,"rangeEnd",0)):((0,i.Lj)(u,"rangeType","children"),(0,i.hj)(r)&&(0,i.Lj)(u,"rangeStart",r),(0,i.hj)(o)&&(0,i.Lj)(u,"rangeEnd",o))}},37941:(t,e,n)=>{"use strict";n.d(e,{FL:()=>m,b6:()=>f,kZ:()=>g});var r=n(71381),i=n(53105),o=n(49787),s=n(39546),a=n(2104),l=n(60681),c=n(94792),u=n(69798),h=n(18682),d=n(99023),p=n(54586);function f(t,e){const n={sheets:[],topics:[],boundaries:[],summaries:[],relationships:[],idMap:{},resources:new Set},c=(0,i.JR)(t,e);return b(t,c,n),function(t,e,{topics:n,boundaries:i,summaries:c,relationships:p,idMap:f,resources:m}){const g=e.filter((e=>(0,o.Ob)((0,o.sb)(t,e)))).sort((0,d.hT)(t));if(g.length<=0)return;const y=x(t,g),b={},_=new Set,v=new Set,C=new Set;let A=0;for(const e of g){if(e in b)continue;const l=T(t,e);l&&C.add(l);const c=(0,s.XS)(t,e);if(c){if(g.includes(c))continue;const n=(0,a.HA)(t,e);if(n===r.oz.Summary){v.add(e);const n=(0,u.yR)((0,h.hg)(t,e));if(S(n,(0,u.yR)((0,o.Ob)((0,o.sb)(t,c))).children??[],g)>0)continue;C.delete(n.id)}n===r.oz.Attached&&_.add(c)}const d=R(t,e,b,m,y);d.boundaries&&(d.boundaries=d.boundaries.filter((t=>"children"===t.rangeType||(i.push({...t,rangeType:"children",rangeStart:A,rangeEnd:A}),!1))),d.boundaries&&0===d.boundaries.length&&delete d.boundaries),n.push(d),A+=1}for(const e of _){const n=(0,u.yR)((0,o.Ob)((0,o.sb)(t,e))),r=(n.boundaries??[]).map((e=>(0,u.yR)((0,o.j4)((0,o.sb)(t,e))))),s=(n.summaries??[]).map((e=>(0,u.yR)((0,h.hg)(t,e)))),a=n.children??[];i.push(...r.filter((t=>"children"===t.rangeType&&w(t,a,g))).map((e=>I(t,e.id,b,j(e,a,g))))),c.push(...s.map((e=>{if(!C.has(e.id)){if(w(e,a,g))return O(t,e.id,b,m,y,j(e,a,g));if(e.topicId&&v.has(e.topicId)){const n=S(e,a,g);if(n>0){const r=j(e,a,g);return O(t,e.id,b,m,y,r,r+n-1)}}}})).filter((t=>!!t)))}const D=new Set;Object.keys(b).forEach((e=>{f[e]=b[e],((0,l.um)(t,e)??[]).forEach((t=>D.add(t))),((0,l.$r)(t,e)??[]).forEach((t=>D.add(t)))}));for(const e of D){if(e in f)continue;const n=k(t,e,f);n&&p.push(n)}n.map((t=>L(t,f)))}(t,c,n),n}function m(t,e){const n={sheets:[],topics:[],boundaries:[],summaries:[],relationships:[],idMap:{},resources:new Set},l=(0,i.JR)(t,e);return b(t,l,n),function(t,e,{topics:n,idMap:i,resources:l}){const c=e.filter((e=>(0,o.Ob)((0,o.sb)(t,e)))).sort((0,d.hT)(t));if(c.length<=0)return;const u=x(t,c),h={},p=new Set;for(const e of c){if(e in h)continue;const i=(0,s.XS)(t,e);if(i&&c.includes(i))continue;i&&(0,a.HA)(t,i)===r.oz.Attached&&p.add(i);const o=R(t,e,h,l,u);n.push(...v(o))}Object.keys(h).forEach((t=>{i[t]=h[t]})),n.map((t=>L(t,i)))}(t,l,n),n}function g({sheets:t,topics:e,boundaries:n,summaries:r,relationships:i,idMap:o,resources:s}){return{sheets:t.map((t=>new p.eN(t))),topics:e.map((t=>new p.GO(t))),boundaries:n.map((t=>new p.r3(t))),summaries:r.map((t=>new p.gn(t))),relationships:i.map((t=>new p.XZ(t))),idMap:o,resources:[...s]}}function y(t,e){t&&t.startsWith("xap:")&&e.add(t.slice(4))}function b(t,e,{sheets:n,idMap:r,resources:i}){for(const o of e){const e=_(t,o,r,i);e&&n.push(e)}}function _(t,e,n,r){const i=(0,o.vB)((0,o.sb)(t,e));if(!i)return null;const{type:s,revisionId:a,rootTopicId:l,relationships:c,...h}=i,d=l?R(t,l,n,r,{},!0):{id:(0,u.Vj)()},p=(c??[]).map((e=>k(t,e,n))).filter((t=>!!t)),f={...h,id:(0,u.Vj)(),rootTopic:d,...p.length>0?{relationships:p}:{}};return n[i.id]=f.id,L(d,n),f}function v(t){const e=[t];if(t.children)for(const n of t.children)e.push(...v(n));return delete t.boundaries,delete t.summaries,delete t.children,e}function x(t,e){const n={};for(const i of e){if((0,a.HA)(t,i)!==r.oz.Attached)continue;let o=(0,s.XS)(t,i)??null,l=!0;for(;null!==o;){if(e.includes(o)){if(l){n[o]=[...n[o]??[],i];break}n[o]=n[o]??[]}o=(0,s.XS)(t,o)??null,l=!1}}return n}function w({rangeStart:t,rangeEnd:e},n,r){return!(!(0,u.hj)(t)||!(0,u.hj)(e))&&(!(t<0||t>e||e>n.length)&&[...n].splice(t,e-t+1).every((t=>r.includes(t))))}function S({rangeStart:t,rangeEnd:e},n,r){if(!(0,u.hj)(t)||!(0,u.hj)(e))return 0;if(t<0||t>e||e>n.length)return 0;let i=0;for(let o=t;o<=e;o++)r.includes(n[o])&&i++;return i}function j({rangeStart:t},e,n){if(!(0,u.hj)(t))return 0;const r=e[t],i=n.indexOf(r);return i<0?t??0:i}function R(t,e,n,r,i,s=!1){const a=(0,u.yR)((0,o.Ob)((0,o.sb)(t,e))),{type:l,detachedChildren:c=[],children:d=[],boundaries:p=[],summaries:f=[],callout:m,...g}=a,b=i[e]??d,_=b.map((e=>R(t,e,n,r,i))),v=s?c.map((e=>R(t,e,n,r,i))):[],x=p.map((e=>(0,u.yR)((0,o.j4)((0,o.sb)(t,e))))),S=f.map((e=>(0,u.yR)((0,h.hg)(t,e)))),k=[],T=[];k.push(...x.filter((t=>"children"!==t.rangeType||w(t,d,b))).map((e=>I(t,e.id,n,j(e,d,b))))),T.push(...S.filter((t=>w(t,d,b))).map((e=>O(t,e.id,n,r,i,j(e,d,b)))));const L=m?R(t,m,n,r,i):null,C={...g,..._.length>0?{children:_}:{},...v.length>0?{detachedChildren:v}:{},...k.length>0?{boundaries:k}:{},...T.length>0?{summaries:T}:{},...L?{callout:L}:{},id:(0,u.Vj)()};return n[e]=C.id,a.imageSource&&y(a.imageSource,r),a.href&&y(a.href,r),a.extensions&&Object.values(a.extensions).forEach((t=>{t.resources?.forEach((t=>y(t,r)))})),C}function I(t,e,n,r){const i=(0,u.yR)((0,o.j4)((0,o.sb)(t,e))),{type:s,rangeStart:a,rangeEnd:l,...c}=i,h={...c,id:(0,u.Vj)()};if((0,u.hj)(a)&&(0,u.hj)(l)){const t=void 0!==r?r:a,e=t+l-a;h.rangeStart=t,h.rangeEnd=e}return n[e]=h.id,h}function O(t,e,n,r,i,s,a){const l=(0,u.yR)((0,o.So)((0,o.sb)(t,e))),{topicId:c,type:h,rangeStart:d,rangeEnd:p,...f}=l,m={...f,id:(0,u.Vj)(),...c?{topic:R(t,c,n,r,i)}:{id:(0,u.Vj)()}};if((0,u.hj)(d)&&(0,u.hj)(p)){const t=void 0!==s?s:d,e=void 0!==a?a:t+p-d;m.rangeStart=t,m.rangeEnd=e}return n[e]=m.id,m}function k(t,e,n){const r=(0,u.yR)((0,o.$D)((0,o.sb)(t,e))),{type:i,sourceId:s,targetId:a,...l}=r,c=s?n[s]:null,h=a?n[a]:null;if(!c||!h)return null;const d={...l,id:(0,u.Vj)(),source:{id:c},target:{id:h}};return n[e]=d.id,d}function T(t,e){if((0,a.HA)(t,e)===r.oz.Summary)return;let n=e;for(;n&&(0,a.HA)(t,n)!==r.oz.Summary;)n=(0,s.XS)(t,n);return n?(0,c.hT)(t,n):void 0}function L(t,e){if(t.href?.startsWith("xmind:#")){const n=e[t.href.slice(7)];n&&(t.href="xmind:#"+n)}t.children?.map((t=>L(t,e))),t.detachedChildren?.map((t=>L(t,e))),t.summaries?.map((t=>{t.topic&&L(t.topic,e)})),t.callout&&L(t.callout,e)}},28610:(t,e,n)=>{"use strict";n.d(e,{fM:()=>o,wb:()=>s,wz:()=>i});var r=n(53105);class i{_callbacksMap=new Map;onResolved(t,e){const n=this._callbacksMap.get(t)??[];this._callbacksMap.set(t,[...n,e])}resolve(t){this._callbacksMap.forEach(((e,n)=>{const i=(0,r.l_)(t,n);i&&e.forEach((e=>e(t,i)))}))}}function o(t,e,n,r){const i=s(t,e,r);i<0?e.push(...n):e.splice(i,0,...n)}function s(t,e,n){if(!n)return e.length;if("number"==typeof n.at){const t=n.at;return"number"!=typeof t||t<0||t>e.length?-1:t}if(n.after){const i=(0,r.IP)(t,n.after);if(!i)return-1;const o=e.indexOf(i);return o<0?-1:o+1}if(n.before){const i=(0,r.IP)(t,n.before);if(!i)return-1;const o=e.indexOf(i);return o<0?-1:o}return e.length}},6083:(t,e,n)=>{"use strict";n.d(e,{Tz:()=>l,iq:()=>h,vV:()=>u});var r=n(69598),i=n(49787),o=n(28610),s=n(52639),a=n(84727);function l(t,e){return(0,r.s6)(t,((t,n,r)=>{u(t,e,{refResolver:n,registerRelatedSheet:r})}))}function c(t,e,n){const{sheets:r,options:i}=e,a=r.map((e=>(0,s.Zq)(t,e,n)));(0,o.fM)(t,t.sheets,a,i)}function u(t,e,n){const{metadata:r,sheets:i}=e,{registerRelatedSheet:o}=n;void 0!==r&&function(t,e){for(const[n,r]of Object.entries(e))r?t.metadata[n]=r:delete t.metadata[n]}(t,r),void 0!==i&&((0,s.rZ)(t,i,n),i.forEach((t=>o(t.id)))),e.operations?.forEach((e=>{switch(e.type){case"addSheets":c(t,e.patch,n),e.patch.sheets.forEach((t=>o(t.id)));break;case"removeSheets":e.patch.forEach((e=>(0,s.Pu)(t,e)));break;case"moveSheet":{const{sheet:n,options:r}=e.patch;t.sheets.includes(n)&&(0,s.j1)(t,n,r);break}case"updatedSheets":e.patch.forEach((e=>{const r=t.sheets.indexOf(e.id);-1!==r&&((0,s.Pu)(t,e.id),c(t,{sheets:[e],options:{at:r}},n),o(e.id))}))}}))}function h(t,e){const n=(0,i.vB)((0,i.sb)(t,e));if(!n)return;const r=[...n.relationships??[]];r.length&&r.forEach((e=>{const n=(0,i.$D)((0,i.sb)(t,e));if(!n)return;const{sourceId:r,targetId:o}=n;r&&o||(0,a.sE)(t,e)}))}},84727:(t,e,n)=>{"use strict";n.d(e,{Bp:()=>c,Ie:()=>d,RQ:()=>p,Zb:()=>h,bT:()=>l,sE:()=>u});var r=n(69598),i=n(49787),o=n(53105),s=n(60681),a=n(69798);function l(t,e){return(0,r.s6)(t,((t,n,r)=>{const o=(0,a.yR)((0,i.az)(t,e.id));h(t,e,{refResolver:n,ownerSheetId:o}),r(o)}))}function c(t,e){return(0,r.s6)(t,((t,n,r)=>{for(const[o,s]of Object.entries(e.relationshipPatchById)){const e=(0,a.yR)((0,i.az)(t,o));h(t,{id:o,...s},{refResolver:n,ownerSheetId:e}),r(e)}}))}function u(t,e){const n=(0,a.yR)((0,i.az)(t,e)),r=(0,a.yR)((0,i.vB)((0,i.sb)(t,n))),l=(r.relationships??[]).filter((t=>t!==e));l.length>0?r.relationships=l:delete r.relationships;const c=(0,a.yR)((0,i.$D)((0,i.sb)(t,e))),{ref:u,sourceId:h,targetId:d}=c;u&&(0,o.OO)(t,u),h&&(0,s.Jy)(t,h,e),d&&(0,s.RN)(t,d,e),(0,i.bX)(t,e)}function h(t,e,n){const{id:r,ref:l,source:c,target:u}=e;(0,i.sb)(t,r)||(0,i.pE)(t,{id:r,type:"relationship"},n.ownerSheetId);const h=(0,a.yR)((0,i.$D)((0,i.sb)(t,r)));void 0!==l&&(0,o.Pt)(t,h,l),void 0!==e.classes&&(0,a.Lj)(h,"classes",e.classes.length>0?[...e.classes]:null),void 0!==e.title&&(0,a.Lj)(h,"title",e.title),void 0!==e.attributedTitle&&(0,a.Lj)(h,"attributedTitle",e.attributedTitle),void 0!==e.controlPoint1&&(0,a.Lj)(h,"controlPoint1",e.controlPoint1),void 0!==e.controlPoint2&&(0,a.Lj)(h,"controlPoint2",e.controlPoint2),void 0!==e.sourceRefPoint&&(0,a.Lj)(h,"sourceRefPoint",e.sourceRefPoint),void 0!==e.targetRefPoint&&(0,a.Lj)(h,"targetRefPoint",e.targetRefPoint),void 0!==e.shapeClass&&(0,a.Lj)(h,"shapeClass",e.shapeClass),void 0!==e.textColor&&(0,a.Lj)(h,"textColor",e.textColor),void 0!==e.fontFamily&&(0,a.Lj)(h,"fontFamily",e.fontFamily),void 0!==e.fontSize&&(0,a.Lj)(h,"fontSize",e.fontSize),void 0!==e.lineColor&&(0,a.Lj)(h,"lineColor",e.lineColor),void 0!==e.lineWidth&&(0,a.Lj)(h,"lineWidth",e.lineWidth),void 0!==e.linePattern&&(0,a.Lj)(h,"linePattern",e.linePattern),void 0!==e.arrowBeginClass&&(0,a.Lj)(h,"arrowBeginClass",e.arrowBeginClass),void 0!==e.arrowEndClass&&(0,a.Lj)(h,"arrowEndClass",e.arrowEndClass),void 0!==e.fontWeight&&(0,a.Lj)(h,"fontWeight",e.fontWeight),void 0!==e.fontStyle&&(0,a.Lj)(h,"fontStyle",e.fontStyle),void 0!==e.textTransform&&(0,a.Lj)(h,"textTransform",e.textTransform),void 0!==e.textDecoration&&(0,a.Lj)(h,"textDecoration",e.textDecoration),void 0!==e.textAlign&&(0,a.Lj)(h,"textAlign",e.textAlign);const d=e=>(0,i.az)(t,e)===(0,i.az)(t,r),p=(e,n)=>{if("targetId"===e){const e=(0,s.um)(t,n);(0,s.fo)(t,n,[...e??[],r])}else{const e=(0,s.$r)(t,n);(0,s.FX)(t,n,[...e??[],r])}},f=(e,o)=>{if("id"in o){const n=o.id;(0,i.sb)(t,n)&&d(n)&&((0,a.Lj)(h,e,n),p(e,n))}else n.refResolver.onResolved(o.ref,((t,n)=>{d(n)&&((0,a.yR)((0,i.$D)((0,i.sb)(t,r)))[e]=n,p(e,n))}))};return c&&f("sourceId",c),u&&f("targetId",u),r}function d(t,e,n){const{source:r,target:s}=n,a=n=>{const r=n?(0,o.IP)(t,n):void 0;if(r&&(0,i.sb)(t,r)&&(0,i.az)(t,r)===(0,i.az)(t,e))return r},l=a(r),c=a(s);return l||c?{sourceId:l,targetId:c}:null}function p(t,e,n){const r=(0,a.yR)((0,i.$D)((0,i.sb)(t,e))),{sourceId:o,targetId:l}=n;(n=>{if(!n)return;const i=r.sourceId;i&&(0,s.Jy)(t,i,e),(0,a.Lj)(r,"sourceId",n),(0,s.pY)(t,n,e)})(o),(n=>{if(!n)return;const i=r.targetId;i&&(0,s.RN)(t,i,e),(0,a.Lj)(r,"targetId",n),(0,s.OD)(t,n,e)})(l)}},52639:(t,e,n)=>{"use strict";n.d(e,{Pu:()=>p,Zq:()=>f,gA:()=>d,j1:()=>g,rZ:()=>y,u5:()=>m});var r=n(71381),i=n(69598),o=n(49787),s=n(53105),a=n(28610),l=n(84727),c=n(99023),u=n(69798),h=n(11921);function d(t,e){return(0,i.s6)(t,((t,n,r)=>{f(t,e,{refResolver:n}),r(e.id)}))}function p(t,e){const n=(0,o.sb)(t,e);n&&"sheet"===n.type&&((0,o.rY)(t,e),(0,i.wt)(t,e),n.ref&&(0,s.OO)(t,n.ref),t.sheets=t.sheets.filter((t=>t!==e)))}function f(t,e,n){const{id:i,revisionId:d,ref:p,classes:f,title:m,rootTopic:g,relationships:y,additionalRelationships:b,topicOverlapping:_,rootTopicZIndex:v,topicPositioning:x,topicNotesDisplay:w,floatingTopicFlexibility:S,cjkFontFamily:j,lineTapered:R,themeStyles:I,fillColor:O,multiLineColors:k,colorList:T,legendVisibility:L,legendPosition:C,legendMarkers:A,skeletonThemeId:D,colorThemeId:P,compactLayoutLevel:E,labelSortOrder:M}=e,z=d??(0,u.Vj)();(0,o.sb)(t,i)||(0,o.pE)(t,{id:i,type:"sheet",revisionId:z},i);const B=(0,u.yR)((0,o.vB)((0,o.sb)(t,i)));(0,u.Lj)(B,"revisionId",z),void 0!==p&&(0,s.Pt)(t,B,p),void 0!==m&&(0,u.Lj)(B,"title",m),void 0!==f&&(0,u.Lj)(B,"classes",f.length>0?[...f]:null);const F={...n,ownerSheetId:i};if(void 0!==g){const e=B.rootTopicId;e&&(0,c.vJ)(t,e),(0,u.Lj)(B,"rootTopicId",(0,c.ik)((0,h.lC)(t)?(0,h.KN)(t):t,g,r.oz.Root,F))}if(void 0!==y&&(B.relationships?.forEach((e=>(0,l.sE)(t,e))),(0,u.Lj)(B,"relationships",y.map((e=>(0,l.Zb)(t,e,F))))),void 0!==b&&(0,u.Lj)(B,"relationships",b.reduce(((e,{relationships:n,options:r})=>((0,a.fM)(t,e,n.map((e=>(0,l.Zb)(t,e,F))),r),e)),[...B.relationships??[]])),void 0!==_&&(0,u.Lj)(B,"topicOverlapping",_),void 0!==v&&(0,u.Lj)(B,"rootTopicZIndex",v),void 0!==x&&(0,u.Lj)(B,"topicPositioning",x),void 0!==w&&(0,u.Lj)(B,"topicNotesDisplay",w),void 0!==S&&(0,u.Lj)(B,"floatingTopicFlexibility",S),void 0!==E&&(0,u.Lj)(B,"compactLayoutLevel",E),void 0!==M&&(0,u.Lj)(B,"labelSortOrder",M),void 0!==j&&(0,u.Lj)(B,"cjkFontFamily",j),void 0!==R&&(0,u.Lj)(B,"lineTapered","tapered"===R||"none"===R?R:null),void 0!==O&&(0,u.Lj)(B,"fillColor",O),void 0!==k&&(0,u.Lj)(B,"multiLineColors",k),void 0!==T&&(0,u.Lj)(B,"colorList",T),void 0!==L&&(0,u.Lj)(B,"legendVisibility",L),void 0!==C&&(0,u.Lj)(B,"legendPosition",C),void 0!==A&&(0,u.Lj)(B,"legendMarkers",A?{...B.legendMarkers,...A}:null),void 0!==D&&(0,u.Lj)(B,"skeletonThemeId",D),void 0!==P&&(0,u.Lj)(B,"colorThemeId",P),void 0!==e.extensions){const t={...B.extensions};for(const n in e.extensions){const r=e.extensions[n];r&&(r.content||r.resources)?t[n]={content:r.content??null,resources:r.resources??[]}:delete t[n]}(0,u.Lj)(B,"extensions",t)}if(void 0!==I){const t=B.themeStyles??{};for(const e in I)(0,u.Lj)(t,e,(0,u.DN)(I[e]));(0,u.Lj)(B,"themeStyles",t)}return i}function m(t,e,n){const r=t.sheets.filter((t=>t!==e)),i=(0,a.wb)(t,r,n);return i>=0?{newIndex:i}:null}function g(t,e,n){let r;if(r="number"==typeof n?n:m(t,e,n)?.newIndex,"number"!=typeof r)return;const i=t.sheets.filter((t=>t!==e));i.splice(r,0,e),t.sheets=i}function y(t,e,n){for(const e of[...t.sheets])p(t,e);t.sheets=e.map((e=>f(t,e,n)))}},18682:(t,e,n)=>{"use strict";n.d(e,{H8:()=>y,O6:()=>b,ST:()=>m,Zw:()=>p,cf:()=>d,fx:()=>f,hg:()=>h,l0:()=>g});var r=n(71381),i=n(69798),o=n(49787),s=n(2104),a=n(94792),l=n(69598),c=n(39546),u=n(99023);function h(t,e){if(!(0,o.Ob)((0,o.sb)(t,e)))return null;if((0,s.HA)(t,e)!==r.oz.Summary)return null;const n=(0,a.hT)(t,e);return n?(0,o.So)((0,o.sb)(t,n)):null}function d(t,e){return(0,l.s6)(t,((t,n,r)=>{const s=(0,i.yR)((0,o.az)(t,e.id)),a=(0,i.yR)((0,c.XS)(t,e.id));f(t,e,{refResolver:n,ownerSheetId:s,parentTopicId:a}),r(s)}))}function p(t,e){return(0,l.s6)(t,((t,n,r)=>{for(const[s,a]of Object.entries(e.summaryPatchById)){const e=(0,i.yR)((0,o.az)(t,s));f(t,{id:s,...a},{refResolver:n,ownerSheetId:e,parentTopicId:(0,i.yR)((0,c.XS)(t,s))}),r(e)}}))}function f(t,e,n){const{id:s,topic:a,rangeStart:l,rangeEnd:h}=e;(0,o.sb)(t,s)||(0,o.pE)(t,{id:s,type:"summary"},n.ownerSheetId);const{parentTopicId:d}=n;(0,c.er)(t,s,d);const p=(0,i.yR)((0,o.So)((0,o.sb)(t,s)));null!=a&&(0,i.Lj)(p,"topicId",(0,u.ik)(t,a,r.oz.Summary,{...n,ownerSummaryId:s})),void 0!==l&&(0,i.Lj)(p,"rangeStart",l),void 0!==h&&(0,i.Lj)(p,"rangeEnd",h),void 0!==e.classes&&(0,i.Lj)(p,"classes",e.classes.length>0?[...e.classes]:null),void 0!==e.shapeClass&&(0,i.Lj)(p,"shapeClass",e.shapeClass),void 0!==e.lineColor&&(0,i.Lj)(p,"lineColor",e.lineColor),void 0!==e.lineWidth&&(0,i.Lj)(p,"lineWidth",e.lineWidth),void 0!==e.linePattern&&(0,i.Lj)(p,"linePattern",e.linePattern);return(0,i.yR)(p.topicId)}function m(t,e,n=!0){const r=h(t,e);if(!r)return;const s=r.id;if(n){const n=(0,c.XS)(t,s);if(n){const r=(0,i.yR)((0,o.Ob)((0,o.sb)(t,n)));r.summaries=r.summaries?.filter((t=>t!==e))??[]}}(0,u.vJ)(t,e),(0,c.FW)(t,s),(0,o.bX)(t,s)}function g(t,e){const n=(0,i.yR)((0,o.Ob)((0,o.sb)(t,e))),{children:r,summaries:s}=n;if(!s?.length)return;const a=s.map((e=>{const{rangeStart:n,rangeEnd:s,topicId:a}=(0,i.yR)(h(t,e));return(0,i.KC)(n,s,r?.length??0)&&a&&(0,o.sb)(t,a)?e:(m(t,e,!1),null)})).filter((t=>!!t))??[];(0,i.Lj)(n,"summaries",a.length?a:null)}function y(t,e,n){const r=(0,i.yR)((0,c.XS)(t,e)),s=(0,i.yR)((0,o.Ob)((0,o.sb)(t,r))),{rangeStart:a,rangeEnd:l}=n;if(void 0===a&&void 0===l)return null;const u=s.children?.length??0,d=(0,i.yR)(h(t,e)),p=(0,i.hj)(a)?a:d.rangeStart,f=(0,i.hj)(l)?l:d.rangeEnd;return void 0===p||void 0===f?null:(0,i.KC)(p,f,u)?{rangeStart:p,rangeEnd:f}:null}function b(t,e,n){const{rangeStart:r,rangeEnd:o}=n,s=(0,i.yR)(h(t,e));(0,i.hj)(r)&&(0,i.Lj)(s,"rangeStart",r),(0,i.hj)(o)&&(0,i.Lj)(s,"rangeEnd",o)}},69942:(t,e,n)=>{"use strict";n.d(e,{Fh:()=>b,Ip:()=>v,Q_:()=>_,Qd:()=>w,a$:()=>f,kE:()=>d,oG:()=>x,oW:()=>y,r_:()=>g,w8:()=>p,xo:()=>m});var r=n(71381),i=n(69798),o=n(49787),s=n(2104),a=n(16949);function l(t){let e="";for(;t>0;)e=String.fromCharCode(65+(t-1)%26)+e,t=Math.floor((t-1)/26);return e}const c={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},u=Object.keys(c),h=Object.values(c);function d(t,e){const n={},i=(0,o.Ob)((0,o.sb)(t,e));if(!i)return;const l=(e,i)=>{if(!e.numberingPattern||!r.ZW.includes(e.numberingPattern))return;if((0,s.HA)(t,e.id)!==r.oz.Attached)return;const o=`${i.id}:${e.numberingPattern}`,l=n[o];null==l||void 0!==e.numberingFixedIndex&&null!==e.numberingFixedIndex?n[o]=e.numberingFixedIndex??0:n[o]+=1,(0,a.WH)(t,e.id,n[o])};for(const e of i.children??[]){const n=(0,o.Ob)((0,o.sb)(t,e));n&&l(n,i)}}function p(t){return!(!t.numberingPattern&&!t.numberingTiered&&void 0===t.numberingFixedIndex&&null===t.numberingFixedIndex)}function f(t){(0,i.Lj)(t,"numberingPattern",null),(0,i.Lj)(t,"numberingTiered",null),(0,i.Lj)(t,"numberingFixedIndex",null)}function m(t,e){return"numeral-arabic"===t?String(e+1)+".":null}function g(t,e){return"numeral-roman"===t?function(t){if(t<=0||Math.floor(t)!==t)throw new Error("requires an unsigned integer");if(t>=4e3)throw new Error("requires a max value of 3999 or less");let e="";for(let n=0;n<u.length;n++)for(;t>=h[n];)t-=h[n],e+=u[n];return e}(e+1)+".":null}function y(t,e){return"alphabet-uppercase"===t?l(e+1)+".":null}function b(t,e){return"alphabet-lowercase"===t?l(e+1).toLowerCase()+".":null}function _(t){return(e,n)=>{for(const r of t){const t=r(e,n);if(null!=t)return t}return null}}function v(){return _([m,g,y,b])}function x(t,e){return(e??"")+t}function w(t,e){if(!t.numberingPattern||null===t.numberingIndex)return null;let n=e(t.numberingPattern,t.numberingIndex);if(n&&t.numberingTiered){n=x(n,t.parentTopic?w(t.parentTopic,e):null)}return n}},99023:(t,e,n)=>{"use strict";n.d(e,{ik:()=>O,EK:()=>A,ym:()=>R,bv:()=>I,vJ:()=>L,qb:()=>T,hT:()=>D,QR:()=>k,yN:()=>C});var r=n(71381),i=n(69798),o=n(69598),s=n(49787),a=n(2104),l=n(39546),c=n(94792),u=n(53105),h=n(60681),d=n(16949),p=n(67649),f=n(84727),m=n(18682),g=n(28610);function y(t,e,n,r,o){if(n.length<1)return;const s=(0,i.f)((0,i.Qy)(n),r);s.length<1||(e.boundaries=[...e.boundaries??[],...s.map((e=>(0,p._N)(t,e,o)))])}function b(t,e,n,i){n.forEach(((n,o)=>{const s=function(t,e){const n=e.find((e=>e.rangeStart===t&&e.rangeEnd===t));if(!n)return null;return{...n,rangeType:"parent",rangeStart:0,rangeEnd:0}}(o,e);s&&O(t,{id:n,additionalBoundaries:[s]},r.oz.Detached,i)}))}function _(t,e,n){if(e.length<1)return;const r=(0,i.yR)((0,s.vB)((0,s.sb)(t,n.ownerSheetId)));r.relationships=[...r.relationships??[],...e.map((e=>(0,f.Zb)(t,e,n)))]}function v(t,e,n,r,o){if(n.length<1)return;const s=(0,i.f)((0,i.Qy)(n),r);s.length<1||(e.summaries=[...e.summaries??[],...s.map((e=>(0,m.fx)(t,e,o)))])}function x(t,e,n,i){const{topics:o,options:s,boundaries:a=[],summaries:l=[],relationships:c=[]}=n;if(o.length<=0)return;const u=e.children??[],h=w(t,u,s),d=o.map((e=>O(t,e,r.oz.Attached,i)));if(e.children=[...u.slice(0,h),...d,...u.slice(h)],s){const n="at"in s?"at":"before"in s?"before":"after",r=d.length;k(t,e,"boundaries",n,h,r),k(t,e,"summaries",n,h,r)}y(t,e,a,h,i),v(t,e,l,h,i),_(t,c,i)}function w(t,e,n){const r=(0,g.wb)(t,e,n);return r<0?e.length:r}function S(t,e,n,i){const{topics:o,options:s,boundaries:a=[],relationships:l=[]}=n;if(o.length<=0)return;const c=e.detachedChildren??[],u=w(t,c,s),h=o.map((e=>O(t,e,r.oz.Detached,i)));e.detachedChildren=[...c.slice(0,u),...h,...c.slice(u)],b(t,a,h,i),_(t,l,i)}var j=n(69942);function R(t,e){return(0,o.s6)(t,((t,n,r)=>{const o=(0,i.yR)((0,s.az)(t,e.id));O(t,e,(0,i.yR)((0,a.HA)(t,e.id)),{refResolver:n,ownerSheetId:o}),r(o)}))}function I(t,e){return(0,o.s6)(t,((t,n,r)=>{for(const[o,l]of Object.entries(e.topicPatchByTopicId)){const e=(0,i.yR)((0,s.az)(t,o));O(t,{id:o,...l},(0,i.yR)((0,a.HA)(t,o)),{refResolver:n,ownerSheetId:e}),r(e)}}))}function O(t,e,n,o){const{id:h,ref:d,children:f,childrenAssociations:g,detachedChildren:w,detachedChildrenAssociations:R,callout:I,boundaries:k}=e;(0,s.sb)(t,h)||(0,s.pE)(t,{id:h,type:"topic"},o.ownerSheetId),(0,a.jY)(t,h,n);const{parentTopicId:T,ownerSummaryId:C}=o;void 0!==T&&(0,l.er)(t,h,T),void 0!==C&&(0,c.LJ)(t,h,C);const A=(0,i.yR)((0,s.Ob)((0,s.sb)(t,h)));if(void 0!==e.classes&&(0,i.Lj)(A,"classes",e.classes.length>0?[...e.classes]:null),void 0!==e.title&&(0,i.Lj)(A,"title",e.title),void 0!==e.titleUnedited&&(0,i.Lj)(A,"titleUnedited",e.titleUnedited),void 0!==e.attributedTitle&&(0,i.Lj)(A,"attributedTitle",e.attributedTitle),void 0!==e.notes&&(0,i.Lj)(A,"notes",e.notes?{html:null,text:null,...e.notes}:null),void 0!==e.notesDisplay&&(0,i.Lj)(A,"notesDisplay",e.notesDisplay),void 0!==e.labels&&(0,i.Lj)(A,"labels",e.labels),void 0!==e.href&&(0,i.Lj)(A,"href",e.href),void 0!==e.position&&(0,i.Lj)(A,"position",e.position),void 0!==e.markers&&(0,i.Lj)(A,"markers",[...new Set(e.markers??[])]),void 0!==e.structureClass&&(0,i.Lj)(A,"structureClass",e.structureClass),void 0!==e.branchState&&(0,i.Lj)(A,"branchState",e.branchState),void 0!==e.imageSource&&(0,i.Lj)(A,"imageSource",e.imageSource),void 0!==e.imageWidth&&(0,i.Lj)(A,"imageWidth",e.imageWidth),void 0!==e.imageHeight&&(0,i.Lj)(A,"imageHeight",e.imageHeight),void 0!==e.imagePlacement&&(0,i.Lj)(A,"imagePlacement",e.imagePlacement),void 0!==e.imageLockRatio&&(0,i.Lj)(A,"imageLockRatio",e.imageLockRatio),void 0!==e.imageBorderLineColor&&(0,i.Lj)(A,"imageBorderLineColor",e.imageBorderLineColor),void 0!==e.imageBorderLineWidth&&(0,i.Lj)(A,"imageBorderLineWidth",e.imageBorderLineWidth),void 0!==e.imageShadowVisible&&(0,i.Lj)(A,"imageShadowVisible",e.imageShadowVisible),void 0!==e.imageOpacity&&(0,i.Lj)(A,"imageOpacity",e.imageOpacity),void 0!==e.imageIsMathJaxImage&&(0,i.Lj)(A,"imageIsMathJaxImage",e.imageIsMathJaxImage),void 0!==e.customWidth&&(0,i.Lj)(A,"customWidth",e.customWidth),void 0!==e.extensions){const t={...A.extensions};for(const n in e.extensions){const r=e.extensions[n];r&&(r.content||r.resources)?t[n]={content:r.content??null,resources:r.resources??[]}:delete t[n]}(0,i.Lj)(A,"extensions",t)}if(void 0!==e.shapeClass&&(0,i.Lj)(A,"shapeClass",e.shapeClass),void 0!==e.fillColor&&(0,i.Lj)(A,"fillColor",e.fillColor),void 0!==e.textColor&&(0,i.Lj)(A,"textColor",e.textColor),void 0!==e.fontFamily&&(0,i.Lj)(A,"fontFamily",e.fontFamily),void 0!==e.fontSize&&(0,i.Lj)(A,"fontSize",e.fontSize),void 0!==e.lineClass&&(0,i.Lj)(A,"lineClass",e.lineClass),void 0!==e.lineColor&&(0,i.Lj)(A,"lineColor",e.lineColor),void 0!==e.lineWidth&&(0,i.Lj)(A,"lineWidth",e.lineWidth),void 0!==e.linePattern&&(0,i.Lj)(A,"linePattern",e.linePattern),void 0!==e.fillPattern&&(0,i.Lj)(A,"fillPattern",e.fillPattern),void 0!==e.borderLineWidth&&(0,i.Lj)(A,"borderLineWidth",e.borderLineWidth),void 0!==e.borderLinePattern&&(0,i.Lj)(A,"borderLinePattern",e.borderLinePattern),void 0!==e.arrowEndClass&&(0,i.Lj)(A,"arrowEndClass",e.arrowEndClass),void 0!==e.borderLineColor&&(0,i.Lj)(A,"borderLineColor",e.borderLineColor),void 0!==e.fontWeight&&(0,i.Lj)(A,"fontWeight",e.fontWeight),void 0!==e.fontStyle&&(0,i.Lj)(A,"fontStyle",e.fontStyle),void 0!==e.textTransform&&(0,i.Lj)(A,"textTransform",e.textTransform),void 0!==e.textDecoration&&(0,i.Lj)(A,"textDecoration",e.textDecoration),void 0!==e.textAlign&&(0,i.Lj)(A,"textAlign",e.textAlign),void 0!==e.alignmentByLevel&&(0,i.Lj)(A,"alignmentByLevel",e.alignmentByLevel),void 0!==e.numberingPattern&&(0,i.Lj)(A,"numberingPattern",e.numberingPattern),void 0!==e.numberingTiered&&(0,i.Lj)(A,"numberingTiered",e.numberingTiered),void 0!==e.numberingFixedIndex&&(0,i.Lj)(A,"numberingFixedIndex",e.numberingFixedIndex),n===r.oz.Attached&&(void 0!==e.numberingPattern||void 0!==e.numberingFixedIndex)){const e=(0,l.XS)(t,h);e&&(0,j.kE)(t,e)}void 0!==d&&(0,u.Pt)(t,A,d);const D={...o,parentTopicId:h};if(void 0!==f&&(!function(t,e,n,o){!n||n.length<1||(e.children?.forEach((e=>L(t,e))),(0,i.Lj)(e,"children",n.map((e=>O(t,e,r.oz.Attached,o)))))}(t,A,f,D),(0,j.kE)(t,h)),void 0!==w&&function(t,e,n,o){!n||n.length<1||(e.detachedChildren?.forEach((e=>L(t,e))),(0,i.Lj)(e,"detachedChildren",n.map((e=>O(t,e,r.oz.Detached,o)))))}(t,A,w,D),void 0!==k){A.boundaries?.forEach((e=>(0,p.bJ)(t,e,!1)));const e=k.map((e=>(0,p._N)(t,e,{...D,parentTopicId:h})));(0,i.Lj)(A,"boundaries",e)}const P=e.summaries;if(void 0!==P){A.summaries?.forEach((e=>(0,m.ST)(t,e,!1)));const e=P.map((e=>(0,m.fx)(t,e,{...D,parentTopicId:h})));(0,i.Lj)(A,"summaries",e)}if(null!=I){L(t,I.id);const e=O(t,I,r.oz.Callout,{...D,parentTopicId:h});(0,i.Lj)(A,"callout",e)}if(void 0!==g){const{boundaries:e=[],summaries:n=[],relationships:r=[]}=g;y(t,A,e,0,D),v(t,A,n,0,D),_(t,r,D)}if(void 0!==R){const{boundaries:e=[],relationships:n=[]}=R;b(t,e,A.detachedChildren??[],D),_(t,n,D)}for(const n of e.additionalChildren??[])x(t,A,n,D);e.additionalChildren&&(0,j.kE)(t,h);for(const n of e.additionalDetachedChildren??[])S(t,A,n,D);if(void 0!==e.additionalBoundaries){const n=e.additionalBoundaries.map((e=>(0,p._N)(t,e,{...D,parentTopicId:h})));(0,i.Lj)(A,"boundaries",[...A.boundaries??[],...n])}if(void 0!==e.additionalSummaries){const n=e.additionalSummaries.map((e=>(0,m.fx)(t,e,{...D,parentTopicId:h}))),r=[...A.summaries??[],...n];(0,i.Lj)(A,"summaries",r)}return(0,p.bW)(t,h),(0,m.l0)(t,h),h}function k(t,e,n,r,o,a=1){e[n]?.map((e=>{const l="boundaries"===n?(0,s.j4)((0,s.sb)(t,e)):(0,m.hg)(t,e);if(!l)return;const{rangeStart:c,rangeEnd:u}=l;!(0,i.hj)(c)||!(0,i.hj)(u)||c<0||u<c||(o<c||"before"!==r&&o===c?((0,i.Lj)(l,"rangeStart",c+a),(0,i.Lj)(l,"rangeEnd",u+a)):o<=("after"===r?u+1:u)&&(0,i.Lj)(l,"rangeEnd",u+a))}))}function T(t,e,n){const o=(0,s.Ob)((0,s.sb)(t,e))?.numberingPattern;(0,a.HA)(t,e)===r.oz.Summary&&(0,m.ST)(t,e),L(t,e);const l=(0,i.yR)((0,s.Ob)((0,s.sb)(t,n)));l.children=l.children?.filter((t=>t!==e)),l.detachedChildren=l.detachedChildren?.filter((t=>t!==e)),l.callout===e&&(0,i.Lj)(l,"callout",null),o&&(0,j.kE)(t,n)}function L(t,e){const n=(0,s.Ob)((0,s.sb)(t,e));if(!n)return;const r=(0,l.XS)(t,e);if(r){const n=(0,i.yR)((0,s.Ob)((0,s.sb)(t,r)));C(t,n,e,"boundaries"),C(t,n,e,"summaries")}[...(0,h.um)(t,e)??[]].forEach((e=>(0,f.sE)(t,e))),[...(0,h.$r)(t,e)??[]].forEach((e=>(0,f.sE)(t,e))),n.summaries?.map((e=>(0,m.ST)(t,e,!1))),n.boundaries?.map((e=>(0,p.bJ)(t,e,!1)));const{ref:o,children:g,callout:y}=n;g?.forEach((e=>L(t,e))),y&&L(t,y),o&&(0,u.OO)(t,o),(0,l.FW)(t,e),(0,c.LG)(t,e),(0,h.Eo)(t,e),(0,h.it)(t,e),(0,a.Lo)(t,e),(0,d.rV)(t,e),(0,s.bX)(t,e)}function C(t,e,n,r,o=!1){const a=(e.children??[]).indexOf(n);a<0||(e[r]=e[r]?.map((e=>{const n="boundaries"===r?(0,s.j4)((0,s.sb)(t,e)):(0,m.hg)(t,e);if(!n)return;const{rangeStart:l,rangeEnd:c}=n;if((0,i.hj)(l)&&(0,i.hj)(c)){if(a<l)n.rangeStart=l-1,n.rangeEnd=c-1;else if(l<=a&&a<=c){if(a===l&&l===c)return"boundary"===n.type&&"parent"===n.rangeType?e:void(o||("boundaries"===r?p.bJ:m.ST)(t,e,!1));n.rangeEnd=c-1}return e}})).filter((t=>!!t)))}function A(t,e){const n=[];let i=e;for(;i;)if(n.push(i),(0,a.HA)(t,i)!==r.oz.Summary)i=(0,l.XS)(t,i);else{const e=(0,m.hg)(t,i);i=(0,l.XS)(t,i),e&&"number"==typeof e.rangeStart&&"number"==typeof e.rangeEnd&&i&&n.push(...(0,s.Ob)((0,s.sb)(t,i))?.children?.slice(e.rangeStart,e.rangeEnd+1)??[])}return n}function D(t){const e=(n,r=1)=>{const i=(0,l.XS)(t,n);return i?e(i,r++):r},n=e=>[r.oz.Detached,r.oz.Summary,r.oz.Callout].includes((0,i.yR)((0,a.HA)(t,e))),o=e=>{const n=(0,l.XS)(t,e);return(0,s.Ob)(n?(0,s.sb)(t,n):null)?.children?.findIndex((t=>t===e))??-1},c=(r,i)=>{if(n(r))return 1;if(n(i))return-1;const s=e(r),a=e(i);if(s!==a)return s-a;const u=(0,l.XS)(t,r),h=(0,l.XS)(t,i);return u?h?u===h?o(r)-o(i):c(u,h):1:-1};return c}},58718:(t,e,n)=>{"use strict";n.d(e,{A:()=>s,W:()=>o});var r=n(53105),i=n(49787);class o{_ownerDocument;selector;_element;constructor(t,e,n){this._ownerDocument=t,this.selector=e,this._element=n}get internalElement(){return this._element}get ownerDocument(){return this._ownerDocument}}class s{_ownerDocument;_selectors;_ownerSheets;_ids;constructor(t,e){this._ownerDocument=t;const n=this._ownerDocument.internalRepository;this._selectors=e,this._ids=(0,r.JR)(n,e),this._ownerSheets=new Set(e.map((t=>{const e=(0,r.IP)(n,t);return e?(0,i.az)(n,e):null})).filter((t=>!!t)))}get ownerDocument(){return this._ownerDocument}get primaryOwnerSheet(){return this._ownerSheets.size>0?this._ownerDocument.query({id:[...this._ownerSheets][0]})?.asSheet()??null:null}get ownerSheets(){return[...this._ownerSheets].map((t=>this._ownerDocument.query({id:t})?.asSheet())).filter((t=>!!t))}get selectors(){return[...this._selectors]}get ids(){return[...this._ids]}}},77997:(t,e,n)=>{"use strict";n.d(e,{s:()=>u});var r=n(69798),i=n(54586),o=n(6083);class s{_patch={};_repo;constructor(t){this._repo=t}metadataFor(t,e){return this._patch.metadata={...this._patch.metadata,[t]:e},this}addSheets(t,e){const n=(Array.isArray(t)?t:t.sheets??[]).map((t=>(0,r.xp)(t,i.eN).patch));return this._patch.operations=[...this._patch.operations??[],{type:"addSheets",patch:{sheets:n,options:e}}],this}removeSheets(t){return this._patch.operations=[...this._patch.operations??[],{type:"removeSheets",patch:t}],this}updateSheets(t){const e=(Array.isArray(t)?t:t.sheets??[]).map((t=>(0,r.xp)(t,i.eN).patch));return this._patch.operations=[...this._patch.operations??[],{type:"updatedSheets",patch:e}],this}moveSheet(t,e){return this._patch.operations=[...this._patch.operations??[],{type:"moveSheet",patch:{sheet:t,options:e}}],this}commit(){return new u((0,o.Tz)(this._repo,this._patch))}Sheet(t){return new i.eN(t)}Topic(){return new i.GO}Relationship(){return new i.XZ}Boundary(){return new i.r3}Summary(){return new i.gn}Callout(){return new i.GO}}var a=n(53105),l=n(49787),c=n(98005);class u{_repo;constructor(t){this._repo=t}get internalRepository(){return this._repo}get sheets(){return this._repo.sheets.map((t=>(0,r.yR)(this.query({id:t})?.asSheet())))}get metadataKeys(){return Object.keys(this._repo.metadata)}metadataFor(t){return this._repo.metadata[t]??""}query(t){const e=(0,a.IP)(this._repo,t);if(!e)return null;const n=(0,l.sb)(this._repo,e);return"summary"===n?.type?null:n?new c.M(this,t,n):null}queryList(t){return new c.L(this,t)}asMutable(){return new s(this._repo)}Sheet(t){return new i.eN(t)}Topic(){return new i.GO}Relationship(){return new i.XZ}Boundary(){return new i.r3}Summary(){return new i.gn}Callout(){return new i.GO}}},98005:(t,e,n)=>{"use strict";n.d(e,{L:()=>ut,M:()=>ct});var r=n(18682),i=n(37941),o=n(58718),s=n(69798);const a=t=>t?.map((t=>({fontFamily:null,fontSize:null,fontWeight:null,fontStyle:null,textDecoration:null,textColor:null,textAlign:null,textTransform:null,...t}))).filter((t=>""!==t.text))??[];var l=n(77997),c=n(67649),u=n(69598),h=n(49787),d=n(39546);class p{_patch;_repo;constructor(t,e){this._patch={id:e},this._repo=t}get id(){return this._patch.id}attrs(t){return Object.assign(this._patch,(0,s.zO)(t)),this}commit(){return(0,s.yR)(new l.s((0,c.A_)(this._repo,this._patch)).query({id:this.id})?.asBoundary())}}class f{static make(t,e,n){const r=(0,c.Py)(t,e,n);return r?new f(t,e,r):null}_repo;_id;_info;constructor(t,e,n){this._repo=t,this._id=e,this._info=n}move(){const t=(0,u.s6)(this._repo,((t,e,n)=>{(0,c.VR)(t,this._id,this._info),n((0,s.yR)((0,h.az)(t,this._id)))}));return(0,s.yR)(new l.s(t).query({id:this._id})?.asBoundary())}}class m{static remove(t,e){const n=(0,s.yR)((0,h.az)(t,e)),r=(0,s.yR)((0,d.XS)(t,e)),i=(0,u.s6)(t,((t,r,i)=>{(0,c.bJ)(t,e),i(n)}));return(0,s.yR)(new l.s(i).query({id:r})?.asTopic())}}class g{patch;repo;constructor(t,e){this.patch={boundaryPatchById:[...e].reduce(((t,e)=>(t[e]={},t)),{})},this.repo=t}attrs(t){for(const[e,n]of Object.entries(this.patch.boundaryPatchById))Object.assign(n,(0,s.zO)(t));return this}mapAttrs(t){for(const[e,n]of Object.entries(this.patch.boundaryPatchById)){const r=t(e);Object.assign(n,(0,s.zO)(r))}return this}commit(){return(0,s.yR)(new l.s((0,c.G5)(this.repo,this.patch)).queryList(Object.keys(this.patch.boundaryPatchById).map((t=>({id:t})))).asBoundaries())}}class y{static remove(t,e){if(!e.length)return null;const n=e.map((e=>(0,s.yR)((0,d.XS)(t,e)))),r=e.map((e=>(0,s.yR)((0,h.az)(t,e)))),i=(0,u.s6)(t,((t,n,i)=>{e.forEach((e=>(0,c.bJ)(t,e))),r.forEach((t=>i(t)))}));return(0,s.yR)(new l.s(i).queryList(n.map((t=>({id:t})))).asTopics())}}var b=n(53105);class _ extends o.W{get id(){return this._element.id}get ref(){return this._element.ref??null}get classes(){return this._element.classes??[]}get rangeType(){return this._element.rangeType??"children"}get title(){return this._element.title??null}get attributedTitle(){return a(this._element.attributedTitle)}get rangeStart(){return(0,s.yR)(this._element.rangeStart)}get rangeEnd(){return(0,s.yR)(this._element.rangeEnd)}get parentTopic(){const t=(0,s.yR)((0,d.XS)(this._ownerDocument.internalRepository,this.id));return(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic())}get ownerSheet(){const t=(0,s.yR)((0,h.az)(this._ownerDocument.internalRepository,this.id));return(0,s.yR)(this._ownerDocument.query({id:t})?.asSheet())}get shapeClass(){return this._element.shapeClass??null}get lineWidth(){return this._element.lineWidth??null}get linePattern(){return this._element.linePattern??null}get fillPattern(){return this._element.fillPattern??null}get fillColor(){return this._element.fillColor??null}get fillOpacity(){return this._element.fillOpacity??null}get lineColor(){return this._element.lineColor??null}get fontFamily(){return this._element.fontFamily??null}get fontSize(){return this._element.fontSize??null}get fontWeight(){return this._element.fontWeight??null}get fontStyle(){return this._element.fontStyle??null}get textTransform(){return this._element.textTransform??null}get textDecoration(){return this._element.textDecoration??null}get textAlign(){return this._element.textAlign??null}get textColor(){return this._element.textColor??null}asMovable(t){return f.make(this._ownerDocument.internalRepository,this._element.id,t)}remove(){return m.remove(this._ownerDocument.internalRepository,this._element.id)}asMutable(){return new p(this._ownerDocument.internalRepository,this.id)}}class v extends o.A{static make(t,e){const n=(0,b.l9)(t.internalRepository,e,(t=>null!==(0,h.j4)(t)));return n.length?new v(t,n):null}asMutable(){return new g(this.ownerDocument.internalRepository,this.ids)}remove(){return y.remove(this.ownerDocument.internalRepository,this.ids)}}var x=n(84727);class w{_patch;_repo;constructor(t,e){this._patch={id:t},this._repo=e}get id(){return this._patch.id}attrs(t){return Object.assign(this._patch,(0,s.zO)(t)),this}commit(){return(0,s.yR)(new l.s((0,x.bT)(this._repo,this._patch)).query({id:this.id})?.asRelationship())}}class S{static make(t,e,n){const r=(0,x.Ie)(t,e,n);return r?new S(t,e,r):null}_repo;_id;_info;constructor(t,e,n){this._repo=t,this._id=e,this._info=n}move(){const t=(0,u.s6)(this._repo,((t,e,n)=>{(0,x.RQ)(t,this._id,this._info),n((0,s.yR)((0,h.az)(t,this._id)))}));return(0,s.yR)(new l.s(t).query({id:this._id})?.asRelationship())}}class j{static remove(t,e){const n=(0,s.yR)((0,h.az)(t,e)),r=(0,u.s6)(t,((t,r,i)=>{(0,x.sE)(t,e),i(n)}));return(0,s.yR)(new l.s(r).query({id:n})?.asSheet())}}class R{patch;repo;constructor(t,e){this.patch={relationshipPatchById:[...e].reduce(((t,e)=>(t[e]={},t)),{})},this.repo=t}attrs(t){for(const[e,n]of Object.entries(this.patch.relationshipPatchById))Object.assign(n,(0,s.zO)(t));return this}mapAttrs(t){for(const[e,n]of Object.entries(this.patch.relationshipPatchById)){const r=t(e);Object.assign(n,(0,s.zO)(r))}return this}commit(){return(0,s.yR)(new l.s((0,x.Bp)(this.repo,this.patch)).queryList(Object.keys(this.patch.relationshipPatchById).map((t=>({id:t}))))?.asRelationships())}}class I{static remove(t,e){if(0===e.length)return null;const n=(0,h.az)(t,e[0]);if(!n)return null;const r=(0,u.s6)(t,((t,n,r)=>{e.forEach((e=>{r((0,s.yR)((0,h.az)(t,e))),(0,x.sE)(t,e)}))}));return(0,s.yR)(new l.s(r).query({id:n})?.asSheet())}}var O=n(60681),k=n(83556),T=n(54586),L=n(99023),C=n(71381),A=n(2104),D=n(16949),P=n(28610),E=n(69942);function M(t,e,n){const i=function(t,e,n){const{parent:r}=n,i=(0,b.IP)(t,r);if(!i)return null;if((0,A.HA)(t,i)==C.oz.Callout)return null;const o=(0,h.Ob)((0,h.sb)(t,i));if(!o)return null;const s=e.every((e=>(0,h.e9)(t,e,i)));if(!s)return null;return o}(t,e,n);if(!i)return null;const o=i.id,a=function(t,e,n){const r=(0,L.EK)(t,n);let i=[...new Set(e)].filter((e=>(0,A.HA)(t,e)===C.oz.Attached||(0,A.HA)(t,e)===C.oz.Detached)).filter((t=>!r.includes(t))).filter((e=>(0,d.XS)(t,e)));return i=i.filter((e=>(0,L.EK)(t,e).filter((t=>t!==e)).every((t=>!i.includes(t))))).sort((0,L.hT)(t)),i}(t,e,o);if(!a.length)return null;const{as:l=C.oz.Attached}=n,c=B(l),u=i[c]?.filter((t=>!a.includes(t)))??[],p=(0,P.wb)(t,u,n);if(p<0)return null;const f=function(t,e){const n=new Map;return e.forEach((e=>{const r=(0,s.yR)((0,d.XS)(t,e)),i=n.get(r)??{children:[],detachedChildren:[]};(0,A.HA)(t,e)===C.oz.Attached?i.children.push(e):(0,A.HA)(t,e)===C.oz.Detached&&i.detachedChildren.push(e),n.set(r,i)})),n}(t,a);if(0===f.size)return null;const m=function(t,e){const n=new Map;return F(t,e).forEach((i=>{const o=(0,s.yR)((0,h.Ob)((0,h.sb)(t,i)));o.summaries?.forEach((i=>{const s=(0,r.hg)(t,i),a=s?W(s,o,e):null;a&&n.set(i,a)}))})),n}(t,a),g=function(t,e){const n=new Map;return F(t,e).forEach((r=>{const i=(0,s.yR)((0,h.Ob)((0,h.sb)(t,r)));i.boundaries?.forEach((r=>{const o=(0,h.j4)((0,h.sb)(t,r)),s="children"===o?.rangeType?W(o,i,e):null;s&&n.set(r,{...s,rangeType:"children"})}))})),e.filter((e=>(0,A.HA)(t,e)===C.oz.Detached)).forEach((r=>{const i=(0,h.Ob)((0,h.sb)(t,r));i?.boundaries?.forEach((i=>{const o=(0,h.j4)((0,h.sb)(t,i));"parent"===o?.rangeType&&n.set(i,{start:e.indexOf(r),end:e.indexOf(r),rangeType:"parent"})}))})),n}(t,a);return{topics:a,as:l,at:p,newParentId:o,oldParentTopicInfoMap:f,takeAwaySummaryInfoMap:m,takeAwayBoundaryInfoMap:g}}function z(t,e){!function(t,e){const{as:n,oldParentTopicInfoMap:r,takeAwaySummaryInfoMap:i,takeAwayBoundaryInfoMap:o}=e;r.forEach((({children:e,detachedChildren:r},a)=>{const l=(0,s.yR)((0,h.Ob)((0,h.sb)(t,a)));for(const n of e??[])(0,L.yN)(t,l,n,"summaries",!0),(0,L.yN)(t,l,n,"boundaries",!0),(0,s.Lj)(l,"children",l.children?.filter((t=>t!==n))),(0,s.Lj)(l,"summaries",l.summaries?.filter((t=>!i.has(t)))??[]),(0,s.Lj)(l,"boundaries",l.boundaries?.filter((t=>!o.has(t)))??[]);for(const e of r??[]){const r=(0,s.yR)((0,h.Ob)((0,h.sb)(t,e)));if((0,s.Lj)(l,"detachedChildren",l.detachedChildren?.filter((t=>t!==e))),"attached"!==n)return;(0,s.Lj)(r,"boundaries",r.boundaries?.filter((t=>!o.has(t)))??[])}}))}(t,e),function(t,e){const{topics:n,as:r,at:i,newParentId:o}=e,a=(0,s.yR)((0,h.Ob)((0,h.sb)(t,o))),l=B(r),c=[...a[l]??[]];c.splice(i,0,...n),(0,s.Lj)(a,l,c),n.forEach((e=>{(0,d.er)(t,e,o),(0,A.jY)(t,e,"detached"===r?C.oz.Detached:C.oz.Attached)}))}(t,e),function(t,e){const{topics:n,as:i,at:o,newParentId:a,takeAwaySummaryInfoMap:l}=e;if(i===C.oz.Detached)Array.from(l.keys()).forEach((e=>(0,r.ST)(t,e)));else{const e=(0,s.yR)((0,h.Ob)((0,h.sb)(t,a)));(0,L.QR)(t,e,"summaries","at",o,n.length),(0,s.Lj)(e,"summaries",[...e.summaries??[],...Array.from(l.keys()).filter((t=>!!t))]),l.forEach((({start:e,end:n},i)=>{const l=(0,s.yR)((0,r.hg)(t,i));l.rangeStart=e+o,l.rangeEnd=n+o,(0,d.er)(t,i,a),(0,d.er)(t,l.id,a)}))}}(t,e),function(t,e){const{topics:n,as:r,at:i,newParentId:o,takeAwayBoundaryInfoMap:a}=e;if(r===C.oz.Detached)a.forEach((({start:e,end:r,rangeType:i},o)=>{if("children"!==i)return;if(e!==r||n.length<=e)return(0,c.bJ)(t,o);const a=(0,s.yR)((0,h.Ob)((0,h.sb)(t,n[e])));(0,s.Lj)(a,"boundaries",[...a.boundaries??[],o]);const l=(0,s.yR)((0,h.j4)((0,h.sb)(t,o)));(0,s.Lj)(l,"rangeType","parent"),(0,s.Lj)(l,"rangeStart",0),(0,s.Lj)(l,"rangeEnd",0),(0,d.er)(t,o,a.id)}));else{const e=(0,s.yR)((0,h.Ob)((0,h.sb)(t,o)));(0,L.QR)(t,e,"boundaries","at",i,n.length),(0,s.Lj)(e,"boundaries",[...e.boundaries??[],...Array.from(a.keys()).filter((t=>!!t))]),a.forEach((({start:e,end:n},r)=>{const a=(0,s.yR)((0,h.j4)((0,h.sb)(t,r)));a.rangeType="children",a.rangeStart=e+i,a.rangeEnd=n+i,(0,d.er)(t,r,o)}))}}(t,e),function(t,e){const{topics:n,newParentId:r,oldParentTopicInfoMap:i}=e,o=new Set;i.forEach((({children:e},n)=>{for(const r of e??[]){const e=(0,s.yR)((0,h.Ob)((0,h.sb)(t,r)));(0,E.w8)(e)&&o.add(n)}}));for(const e of n){(0,D.rV)(t,e);const n=(0,s.yR)((0,h.Ob)((0,h.sb)(t,e)));(0,A.HA)(t,e)===C.oz.Detached&&(0,E.a$)(n)}o.forEach((e=>(0,E.kE)(t,e))),o.size>0&&(0,E.kE)(t,r)}(t,e)}function B(t){return t===C.oz.Detached?"detachedChildren":"children"}function F(t,e){return[...new Set(e.map((e=>(0,d.XS)(t,e))).filter((t=>!!t)))]}function W(t,e,n){const{rangeStart:r,rangeEnd:i}=t;if("number"!=typeof r||"number"!=typeof i)return null;const o=e.children?.slice(r,i+1);return o?.every((t=>n.includes(t)))?{start:n.indexOf(o[0]),end:n.indexOf(o[o.length-1])}:null}class N{_patch;_repo;constructor(t,e){this._patch={id:t},this._repo=e}get id(){return this._patch.id}extensionBy(t,e){return this._patch.extensions||(this._patch.extensions={}),this._patch.extensions[t]=e?(0,s.zO)(e):null,this}attrs(t){return Object.assign(this._patch,(0,s.zO)(t)),this}addChildren(t,e){return this._patch.additionalChildren=[...this._patch.additionalChildren??[],Array.isArray(t)?{topics:t.map((t=>(0,s.xp)(t,T.GO).patch)),options:e}:{topics:(t.topics??[]).map((t=>(0,s.xp)(t,T.GO).patch))??[],boundaries:(t.boundaries??[]).map((t=>(0,s.xp)(t,T.r3).patch)),summaries:(t.summaries??[]).map((t=>(0,s.xp)(t,T.gn).patch)),relationships:(t.relationships??[]).map((t=>(0,s.xp)(t,T.XZ).patch)),options:e}],this}addDetachedChildren(t,e){return this._patch.additionalDetachedChildren=[...this._patch.additionalDetachedChildren??[],Array.isArray(t)?{topics:t.map((t=>(0,s.xp)(t,T.GO).patch)),options:e}:{topics:(t.topics??[]).map((t=>(0,s.xp)(t,T.GO).patch)),boundaries:(t.boundaries??[]).map((t=>(0,s.xp)(t,T.r3).patch)),summaries:(t.summaries??[]).map((t=>(0,s.xp)(t,T.gn).patch)),relationships:(t.relationships??[]).map((t=>(0,s.xp)(t,T.XZ).patch)),options:e}],this}addBoundaries(t){return this._patch.additionalBoundaries=[...this._patch.additionalBoundaries??[],...t.map((t=>(0,s.xp)(t,T.r3).patch))],this}addSummaries(t){return this._patch.additionalSummaries=[...this._patch.additionalSummaries??[],...t.map((t=>(0,s.xp)(t,T.gn).patch))],this}callout(t){return this._patch.callout=(0,s.xp)(t,T.GO).patch,this}commit(){return(0,s.yR)(new l.s((0,L.ym)(this._repo,this._patch)).query({id:this.id})?.asTopic())}}class q{static make(t,e,n){const r=function(t,e,n){const r=(0,d.XS)(t,e);if(!r)return null;const i=n.parent??{id:r};return M(t,[e],{...n,parent:i})}(t,e,n);return r?new q(t,e,r):null}_repo;_id;_info;constructor(t,e,n){this._repo=t,this._id=e,this._info=n}move(){const t=(0,u.s6)(this._repo,((t,e,n)=>{z(t,this._info),n((0,s.yR)((0,h.az)(t,this._id)))}));return(0,s.yR)(new l.s(t).query({id:this._id})?.asTopic())}}class H{static make(t,e){const n=(0,d.XS)(t,e);return n?new H(t,e,n):null}_repo;_id;_parentTopicId;constructor(t,e,n){this._repo=t,this._id=e,this._parentTopicId=n}remove(){const t=(0,u.s6)(this._repo,((t,e,n)=>{const r=(0,s.yR)((0,h.az)(t,this._id));(0,L.qb)(t,this._id,this._parentTopicId),n(r)}));return(0,s.yR)(new l.s(t).query({id:this._parentTopicId})?.asTopic())}}class V{_patch;_repo;constructor(t,e){this._patch={topicPatchByTopicId:[...e].reduce(((t,e)=>(t[e]={},t)),{})},this._repo=t}attrs(t){for(const[e,n]of Object.entries(this._patch.topicPatchByTopicId))Object.assign(n,(0,s.zO)(t));return this}mapAttrs(t){for(const[e,n]of Object.entries(this._patch.topicPatchByTopicId)){const r=t(e);Object.assign(n,(0,s.zO)(r))}return this}extensionBy(t,e){for(const[n,r]of Object.entries(this._patch.topicPatchByTopicId))r.extensions||(r.extensions={}),r.extensions[t]=e?(0,s.zO)(e):null;return this}mapExtensionBy(t){for(const[e,n]of Object.entries(this._patch.topicPatchByTopicId)){const{provider:r,extension:i}=t(e);n.extensions||(n.extensions={}),n.extensions[r]=i?(0,s.zO)(i):null}return this}commit(){return(0,s.yR)(new l.s((0,L.bv)(this._repo,this._patch)).queryList(Object.keys(this._patch.topicPatchByTopicId).map((t=>({id:t}))))?.asTopics())}}class X{static make(t,e,n){const r=M(t,e,n);return r?new X(t,r):null}_repo;_info;constructor(t,e){this._repo=t,this._info=e}move(){const t=(0,u.s6)(this._repo,((t,e,n)=>{z(t,this._info),this._info.topics.forEach((e=>n((0,s.yR)((0,h.az)(t,e)))))}));return(0,s.yR)(new l.s(t).queryList(this._info.topics.map((t=>({id:t}))))?.asTopics())}}class J{static make(t,e){const n=e.filter((e=>!!(0,d.XS)(t,e)));return n.length?new J(t,[...n]):null}_repo;_ids;constructor(t,e){this._repo=t,this._ids=e}remove(){const t=new Set,e=(0,u.s6)(this._repo,((e,n,r)=>{for(const n of this._ids)if((0,h.sb)(e,n)){const i=(0,d.XS)(e,n);if(!i)continue;const o=(0,s.yR)((0,h.az)(e,n));(0,L.qb)(e,n,i),r(o),t.add(i)}}));return(0,s.yR)(new l.s(e).queryList([...t].map((t=>(0,h.sb)(e,t)?{id:t}:null)).filter((t=>!!t)))?.asTopics())}}var Z=n(75143),$=n(11921);class U extends o.W{get id(){return this._element.id}get ref(){return this._element.ref??null}get classes(){return this._element.classes??[]}get topicType(){return(0,s.yR)((0,A.HA)(this._ownerDocument.internalRepository,this.id))}get title(){return this._element.title??null}get titleUnedited(){return this._element.titleUnedited??null}get attributedTitle(){return a(this._element.attributedTitle)}get href(){return this._element.href??null}get labels(){return[...this._element.labels??[]]}get markers(){return[...this._element.markers??[]]}get notes(){return this._element.notes??null}get notesDisplay(){return this._element.notesDisplay??null}get position(){return this._element.position??null}get structureClass(){return this._element.structureClass??null}get branchState(){return this._element.branchState??null}get extensionProviders(){return Object.keys(this._element.extensions??{})}get imageSource(){return this._element.imageSource??null}get imageWidth(){return this._element.imageWidth??null}get imageHeight(){return this._element.imageHeight??null}get imagePlacement(){return this._element.imagePlacement??null}get imageLockRatio(){return this._element.imageLockRatio??null}get imageBorderLineColor(){return this._element.imageBorderLineColor??null}get imageBorderLineWidth(){return this._element.imageBorderLineWidth??null}get imageShadowVisible(){return this._element.imageShadowVisible??null}get imageOpacity(){return this._element.imageOpacity??null}get imageIsMathJaxImage(){return this._element.imageIsMathJaxImage??null}get shapeClass(){return this._element.shapeClass??null}get lineClass(){return this._element.lineClass??null}get lineWidth(){return this._element.lineWidth??null}get linePattern(){return this._element.linePattern??null}get fillPattern(){return this._element.fillPattern??null}get borderLineWidth(){return this._element.borderLineWidth??null}get borderLinePattern(){return this._element.borderLinePattern??null}get arrowEndClass(){return this._element.arrowEndClass??null}get fontFamily(){return this._element.fontFamily??null}get fontSize(){return this._element.fontSize??null}get fillColor(){return this._element.fillColor??null}get lineColor(){return this._element.lineColor??null}get textColor(){return this._element.textColor??null}get borderLineColor(){return this._element.borderLineColor??null}get fontWeight(){return this._element.fontWeight??null}get fontStyle(){return this._element.fontStyle??null}get textTransform(){return this._element.textTransform??null}get textDecoration(){return this._element.textDecoration??null}get textAlign(){return this._element.textAlign??null}get customWidth(){return this._element.customWidth??null}get alignmentByLevel(){return this._element.alignmentByLevel??null}get parentTopic(){const t=(0,d.XS)(this._ownerDocument.internalRepository,this.id);return t?this._ownerDocument.query({id:t})?.asTopic()??null:null}get ownerSheet(){const t=(0,s.yR)((0,h.az)(this._ownerDocument.internalRepository,this.id));return(0,s.yR)(this._ownerDocument.query({id:t})?.asSheet())}get ownerSummary(){return this._ownerDocument.query({id:this.id})?.asSummary()??null}get children(){return(this._element.children??[]).map((t=>(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic())))}get detachedChildren(){return(this._element.detachedChildren??[]).map((t=>(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic())))}get boundaries(){return(this._element.boundaries??[]).map((t=>(0,s.yR)(this._ownerDocument.query({id:t})?.asBoundary())))}get summaries(){return(this._element.summaries??[]).map((t=>(0,s.yR)(this._ownerDocument.query({id:t})?.asSummary())))}get callout(){const t=this._element.callout;return t?(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic()):null}extensionBy(t){const e=this._element.extensions?.[t];return e?(0,$.u7)(e):null}asRelationshipEnd(){return(0,s.yR)(this._ownerDocument.query({id:this.id})?.asRelationshipEnd())}asMovable(t){return q.make(this._ownerDocument.internalRepository,this._element.id,t)}asRemovable(){return H.make(this._ownerDocument.internalRepository,this._element.id)}asMutable(){return new N(this.id,this._ownerDocument.internalRepository)}asSummary(){return this._ownerDocument.query({id:this.id})?.asSummary()??null}Boundary(){return(0,k.EW)()}get numberingPattern(){return this._element.numberingPattern??null}get numberingTiered(){return this._element.numberingTiered??null}get numberingFixedIndex(){return this._element.numberingFixedIndex??null}get numberingIndex(){return(0,D.og)(this._ownerDocument.internalRepository,this._element.id)??null}get taskIndex(){return(0,Z.I)(this._ownerDocument.internalRepository,this.id)??null}get taskTodoStatus(){return this.taskIndex?.taskTodoStatus??null}get taskPresentation(){return this.taskIndex?.taskPresentation??null}get taskInfoRollup(){return this.taskIndex?.taskInfoRollup??null}get taskProgress(){return this.taskIndex?.taskProgress??null}get taskInfoRollupProgress(){return this.taskIndex?.taskInfoRollupProgress??null}get taskInfoStartDate(){return this.taskIndex?.taskInfoStartDate??null}get taskInfoRollupStartDate(){return this.taskIndex?.taskInfoRollupStartDate??null}get taskInfoDueDate(){return this.taskIndex?.taskInfoDueDate??null}get taskInfoRollupDueDate(){return this.taskIndex?.taskInfoRollupDueDate??null}get taskInfoCreator(){return this.taskIndex?.taskInfoCreator??null}get taskInfoAssignees(){return this.taskIndex?.taskInfoAssignees??null}get taskInfoRollupAssignees(){return this.taskIndex?.taskInfoRollupAssignees??null}get taskInfoPriority(){return this.taskIndex?.taskInfoPriority??null}get taskInfoDisplay(){return this.taskIndex?.taskInfoDisplay??null}get taskDescendants(){return this.taskIndex?.taskDescendants?[...this.taskIndex.taskDescendants]:null}}class G extends o.A{static make(t,e){const n=(0,b.l9)(t.internalRepository,e,(t=>null!==(0,h.Ob)(t)));return n.length?new G(t,n):null}asMutable(){return new V(this.ownerDocument.internalRepository,this.ids)}asMovable(t){return X.make(this.ownerDocument.internalRepository,this.ids,t)}asRemovable(){return J.make(this.ownerDocument.internalRepository,this.ids)}flattenClone(){return(0,i.kZ)((0,i.FL)(this.ownerDocument.internalRepository,this.selectors))}}class K extends o.W{get id(){return this._element.id}get ref(){return this._element.ref??null}get classes(){return this._element.classes??[]}get source(){const t=(0,s.yR)(this._element.sourceId);return(0,s.yR)(this._ownerDocument.query({id:t})?.asRelationshipEnd())}get target(){const t=(0,s.yR)(this._element.targetId);return(0,s.yR)(this._ownerDocument.query({id:t})?.asRelationshipEnd())}get ownerSheet(){const t=(0,s.yR)((0,h.az)(this._ownerDocument.internalRepository,this.id));return(0,s.yR)(this._ownerDocument.query({id:t})?.asSheet())}get title(){return this._element.title??null}get attributedTitle(){return a(this._element.attributedTitle)}get controlPoint1(){return this._element.controlPoint1??null}get controlPoint2(){return this._element.controlPoint2??null}get sourceRefPoint(){return this._element.sourceRefPoint??null}get targetRefPoint(){return this._element.targetRefPoint??null}get shapeClass(){return this._element.shapeClass??null}get lineWidth(){return this._element.lineWidth??null}get linePattern(){return this._element.linePattern??null}get arrowBeginClass(){return this._element.arrowBeginClass??null}get arrowEndClass(){return this._element.arrowEndClass??null}get fontFamily(){return this._element.fontFamily??null}get fontSize(){return this._element.fontSize??null}get lineColor(){return this._element.lineColor??null}get textColor(){return this._element.textColor??null}get fontWeight(){return this._element.fontWeight??null}get fontStyle(){return this._element.fontStyle??null}get textTransform(){return this._element.textTransform??null}get textDecoration(){return this._element.textDecoration??null}get textAlign(){return this._element.textAlign??null}asMovable(t){return S.make(this._ownerDocument.internalRepository,this._element.id,t)}remove(){return j.remove(this._ownerDocument.internalRepository,this._element.id)}asMutable(){return new w(this.id,this._ownerDocument.internalRepository)}}class Y extends o.W{get id(){return this._element.id}get type(){return"topic"}asTopic(){return"topic"!==this._element.type?null:new U(this._ownerDocument,this.selector,this._element)}asBoundary(){return"boundary"!==this._element.type?null:new _(this._ownerDocument,this.selector,this._element)}get incomingRelationships(){return((0,O.um)(this._ownerDocument.internalRepository,this.id)??[]).map((t=>(0,s.yR)(this._ownerDocument.query({id:t})?.asRelationship())))}get outgoingRelationships(){return((0,O.$r)(this._ownerDocument.internalRepository,this.id)??[]).map((t=>(0,s.yR)(this._ownerDocument.query({id:t})?.asRelationship())))}}class Q extends o.A{static make(t,e){const n=(0,b.l9)(t.internalRepository,e,(t=>null!==(0,h.$D)(t)));return n.length?new Q(t,n):null}asMutable(){return new R(this.ownerDocument.internalRepository,this.ids)}remove(){return I.remove(this.ownerDocument.internalRepository,this.ids)}}var tt=n(73130),et=n(94792);class nt{_summaryTopicId;_patch;_repo;constructor(t,e){this._summaryTopicId=e,this._patch={id:(0,s.yR)((0,et.hT)(t,e))},this._repo=t}get id(){return this._summaryTopicId}attrs(t){return Object.assign(this._patch,(0,s.zO)(t)),this}commit(){return(0,s.yR)(new l.s((0,r.cf)(this._repo,this._patch)).query({id:this.id})?.asSummary())}}class rt{static make(t,e,n){const i=(0,r.H8)(t,e,n);return i?new rt(t,e,i):null}_repo;_summaryTopicId;_info;constructor(t,e,n){this._repo=t,this._summaryTopicId=e,this._info=n}move(){const t=(0,u.s6)(this._repo,((t,e,n)=>{(0,r.O6)(t,this._summaryTopicId,this._info),n((0,s.yR)((0,h.az)(t,this._summaryTopicId)))}));return(0,s.yR)(new l.s(t).query({id:this._summaryTopicId})?.asSummary())}}class it{static remove(t,e){const n=(0,s.yR)((0,h.az)(t,e)),i=(0,s.yR)((0,d.XS)(t,e)),o=(0,u.s6)(t,((t,i,o)=>{(0,r.ST)(t,e),o(n)}));return(0,s.yR)(new l.s(o).query({id:i})?.asTopic())}}class ot{patch;repo;summaryTopicIds;constructor(t,e){const n=e.map((e=>(0,s.yR)((0,et.hT)(t,e))));this.patch={summaryPatchById:n.reduce(((t,e)=>(t[e]={},t)),{})},this.repo=t,this.summaryTopicIds=e}attrs(t){for(const[e,n]of Object.entries(this.patch.summaryPatchById))Object.assign(n,(0,s.zO)(t));return this}mapAttrs(t){for(const[e,n]of Object.entries(this.patch.summaryPatchById)){const r=t(e);Object.assign(n,(0,s.zO)(r))}return this}commit(){return(0,s.yR)(new l.s((0,r.Zw)(this.repo,this.patch)).queryList(this.summaryTopicIds.map((t=>({id:t})))).asSummaries())}}class st{static remove(t,e){if(!e.length)return null;const n=e.map((e=>(0,s.yR)((0,h.az)(t,e)))),i=e.map((e=>(0,s.yR)((0,d.XS)(t,e)))),o=(0,u.s6)(t,((t,i,o)=>{e.forEach((e=>(0,r.ST)(t,e))),n.forEach((t=>o(t)))}));return new l.s(o).queryList(i.map((t=>({id:t})))).asTopics()}}class at extends o.W{get id(){return(0,s.yR)(this._element.topicId)}get classes(){return this._element.classes??[]}get rangeStart(){return(0,s.yR)(this._element.rangeStart)}get rangeEnd(){return(0,s.yR)(this._element.rangeEnd)}get topic(){const t=(0,s.yR)(this._element.topicId);return(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic())}get parentTopic(){const t=(0,s.yR)((0,d.XS)(this._ownerDocument.internalRepository,this._element.id));return(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic())}get ownerSheet(){const t=(0,s.yR)((0,h.az)(this._ownerDocument.internalRepository,this._element.id));return(0,s.yR)(this._ownerDocument.query({id:t})?.asSheet())}get shapeClass(){return this._element.shapeClass??null}get lineWidth(){return this._element.lineWidth??null}get linePattern(){return this._element.linePattern??null}get lineColor(){return this._element.lineColor??null}asMutable(){return new nt(this._ownerDocument.internalRepository,this.id)}asMovable(t){return rt.make(this._ownerDocument.internalRepository,this.id,t)}asTopic(){const t=(0,s.yR)(this._element.topicId);return(0,s.yR)(this._ownerDocument.query({id:t})?.asTopic())}remove(){return it.remove(this._ownerDocument.internalRepository,this.id)}}class lt extends o.A{static make(t,e){const n=(0,b.l9)(t.internalRepository,e,(t=>null!==(0,h.Ob)(t)));return n.length?new lt(t,n):null}asMutable(){return new ot(this.ownerDocument.internalRepository,this.ids)}remove(){return st.remove(this.ownerDocument.internalRepository,this.ids)}}class ct extends o.W{get type(){return this._element.type}asSheet(){return"sheet"!==this._element.type?null:new tt.k(this._ownerDocument,this.selector,this._element)}asTopic(){return"topic"!==this._element.type?null:new U(this._ownerDocument,this.selector,this._element)}asRelationship(){return"relationship"!==this._element.type?null:new K(this._ownerDocument,this.selector,this._element)}asRelationshipEnd(){return"topic"!==this._element.type&&"boundary"!==this._element.type?null:new Y(this._ownerDocument,this.selector,this._element)}asBoundary(){return"boundary"!==this._element.type?null:new _(this._ownerDocument,this.selector,this._element)}asSummary(){const t=(0,r.hg)(this._ownerDocument.internalRepository,this._element.id);return t?new at(this._ownerDocument,this.selector,t):null}}class ut{ownerDocument;selectors;constructor(t,e){this.ownerDocument=t,this.selectors=e}asTopics(){return G.make(this.ownerDocument,this.selectors)}asRelationships(){return Q.make(this.ownerDocument,this.selectors)}asBoundaries(){return v.make(this.ownerDocument,this.selectors)}asSummaries(){return lt.make(this.ownerDocument,this.selectors)}clone(){return(0,i.kZ)((0,i.b6)(this.ownerDocument.internalRepository,this.selectors))}}},73130:(t,e,n)=>{"use strict";n.d(e,{k:()=>_});var r=n(54586),i=n(77997),o=n(52639),s=n(69598),a=n(69798);class l{_patch;_repo;constructor(t,e){this._patch={id:t},this._repo=e}get id(){return this._patch.id}rootTopic(t){return this._patch.rootTopic=(0,a.xp)(t,r.GO).patch,this}addRelationships(t,e){return this._patch.additionalRelationships=[...this._patch.additionalRelationships??[],{relationships:t.map((t=>(0,a.xp)(t,r.XZ).patch)),options:e}],this}attrs(t){return Object.assign(this._patch,(0,a.zO)(t)),this}extensionBy(t,e){return this._patch.extensions||(this._patch.extensions={}),this._patch.extensions[t]=e?(0,a.zO)(e):null,this}markerDescriptionFor(t,e){return this._patch.legendMarkers||(this._patch.legendMarkers={}),Object.assign(this._patch.legendMarkers,{[t]:e}),this}styleFor(t,e){if("string"==typeof t){const n=t;this._patch.themeStyles={...this._patch.themeStyles,[n]:e?{...e}:null}}else{const e=t;this._patch.themeStyles={...this._patch.themeStyles,...e}}return this}commit(){return(0,a.yR)(new i.s((0,o.gA)(this._repo,this._patch)).query({id:this.id})?.asSheet())}Topic(){return new r.GO}Relationship(){return new r.XZ}Boundary(){return new r.r3}Summary(){return new r.gn}Callout(){return new r.GO}}class c{static make(t,e,n){const r=(0,o.u5)(t,e,n);return r?new c(t,e,r.newIndex):null}_repo;_id;_newIndex;constructor(t,e,n){this._repo=t,this._id=e,this._newIndex=n}move(){const t=(0,s.s6)(this._repo,(t=>{(0,o.j1)(t,this._id,this._newIndex)}));return(0,a.yR)(new i.s(t).query({id:this._id})?.asSheet())}}class u{static make(t,e){return t.sheets.length>1?new u(t,e):null}_repo;_id;constructor(t,e){this._repo=t,this._id=e}remove(){return new i.s((0,s.s6)(this._repo,(t=>{(0,o.Pu)(t,this._id)})))}}var h=n(37941),d=n(53105),p=n(49787),f=n(98005),m=n(11921);const g=["lineWidth","fontFamily","globalFontFamilyDisabled","globalLineWidthDisabled"];class y{_style;constructor(t){this._style=t}asTopicStyle(){return(0,m.u7)(this._style)}asSheetStyle(){return(0,m.u7)(this._style)}asRelationshipStyle(){return(0,m.u7)(this._style)}asBoundaryStyle(){return(0,m.u7)(this._style)}asSummaryStyle(){return(0,m.u7)(this._style)}asGlobalStyle(){const t=this._style;if(!Object.keys(t).some((t=>!g.includes(t))))return(0,m.u7)(t);const e=Object.keys(t).reduce(((e,n)=>g.includes(n)?{...e,[n]:t[n]}:e),{});return(0,m.u7)(e)}asAnyStyle(){return(0,m.u7)(this._style)}}var b=n(58718);class _ extends b.W{get id(){return this._element.id}get revisionId(){return this._element.revisionId}get rootTopic(){const t=(0,a.yR)(this._element.rootTopicId);return(0,a.yR)(this._ownerDocument.query({id:t})?.asTopic())}get relationships(){return(this._element.relationships??[]).map((t=>(0,a.yR)(this._ownerDocument.query({id:t})?.asRelationship())))}get styleClassNames(){return Object.keys(this._element.themeStyles??{})}get skeletonThemeId(){return this._element.skeletonThemeId??null}get colorThemeId(){return this._element.colorThemeId??null}get ref(){return this._element.ref??null}get classes(){return this._element.classes??[]}get title(){return this._element.title??null}get topicOverlapping(){return this._element.topicOverlapping??null}get rootTopicZIndex(){return this._element.rootTopicZIndex??null}get topicPositioning(){return this._element.topicPositioning??null}get topicNotesDisplay(){return this._element.topicNotesDisplay??null}get floatingTopicFlexibility(){return this._element.floatingTopicFlexibility??null}get labelSortOrder(){return this._element.labelSortOrder??null}get compactLayoutLevel(){return this._element.compactLayoutLevel??null}get cjkFontFamily(){return this._element.cjkFontFamily??null}get lineTapered(){return this._element.lineTapered??null}get fillColor(){return this._element.fillColor??null}get multiLineColors(){return this._element.multiLineColors??null}get colorList(){return this._element.colorList??null}get legendVisibility(){return this._element.legendVisibility??null}get legendPosition(){return this._element.legendPosition??null}get describedMarkers(){return[...new Set(Object.keys(this._element.legendMarkers??{}))].sort(((t,e)=>t.localeCompare(e)))}get extensionProviders(){return Object.keys(this._element.extensions??{})}extensionBy(t){const e=this._element.extensions?.[t];return e?(0,m.u7)(e):null}clone(){return(0,h.kZ)((0,h.b6)(this._ownerDocument.internalRepository,[{id:this._element.id}]))}query(t){const e=(0,d.IP)(this._ownerDocument.internalRepository,t);if(!e||(0,p.az)(this._ownerDocument.internalRepository,e)!==this.id)return null;const n=(0,p.sb)(this._ownerDocument.internalRepository,e);return n?new f.M(this._ownerDocument,t,n):null}queryList(t){return new f.L(this._ownerDocument,t)}markerDescriptionFor(t){return this._element.legendMarkers?.[t]??null}styleFor(t){const e=t?this._element.themeStyles?.[t]:null;return e?new y(e):null}asMutable(){return new l(this.id,this._ownerDocument.internalRepository)}asMovable(t){return c.make(this._ownerDocument.internalRepository,this._element.id,t)}asRemovable(){return u.make(this._ownerDocument.internalRepository,this._element.id)}Topic(){return new r.GO}Relationship(){return new r.XZ}Boundary(){return new r.r3}Summary(){return new r.gn}Callout(){return new r.GO}}},49787:(t,e,n)=>{"use strict";function r(t,e){return t.elementRegistryBySheetId[e]??{}}function i(t,e){delete t.elementRegistryBySheetId[e]}function o(t,e){const n=p(t,e);if(n)return t.elementRegistryBySheetId[n][e]}function s(t,e,n){t.elementRegistryBySheetId[n]||(t.elementRegistryBySheetId[n]={}),t.elementRegistryBySheetId[n][e.id]=e}function a(t,e,n){(n=n??p(t,e))&&delete t.elementRegistryBySheetId[n]?.[e]}function l(t){return"sheet"===t?.type?t:null}function c(t){return"topic"===t?.type?t:null}function u(t){return"relationship"===t?.type?t:null}function h(t){return"boundary"===t?.type?t:null}function d(t){return"summary"===t?.type?t:null}function p(t,e){return Object.keys(t.elementRegistryBySheetId).find((n=>e in t.elementRegistryBySheetId[n]))}function f(t,e,n){const r=p(t,e),i=p(t,n);return Boolean(r&&i&&r===i)}n.d(e,{$D:()=>u,Cz:()=>r,Ob:()=>c,So:()=>d,az:()=>p,bX:()=>a,e9:()=>f,j4:()=>h,pE:()=>s,rY:()=>i,sb:()=>o,vB:()=>l})},53105:(t,e,n)=>{"use strict";n.d(e,{IP:()=>a,JR:()=>l,OO:()=>s,Pt:()=>u,l9:()=>c,l_:()=>o});var r=n(49787),i=n(69798);function o(t,e){return t.idRefRegistry[e]}function s(t,e){delete t.idRefRegistry[e]}function a(t,e){return"id"in e?e.id:o(t,e.ref)??null}function l(t,e){return[...new Set(e.map((e=>a(t,e))).filter((t=>null!==t)))]}function c(t,e,n){return e.filter((e=>{const i=a(t,e);return!!i&&n((0,r.sb)(t,i))}))}function u(t,e,n){const r=e.ref;r!==n&&((0,i.Lj)(e,"ref",n),r&&s(t,r),n&&function(t,e,n){t.idRefRegistry[e]=n}(t,n,e.id))}},69598:(t,e,n)=>{"use strict";n.d(e,{s6:()=>p,vA:()=>d,wt:()=>u,xy:()=>c});var r=n(69798),i=n(11921),o=n(28610),s=n(6083),a=n(49787),l=n(75143);function c(t,e){t.indexSetBySheetId[e]||(t.indexSetBySheetId[e]={parentTopicIdRegistry:{},ownerSummaryIdRegistry:{},incomingRelationshipIdsRegistry:{},outgoingRelationshipIdsRegistry:{},topicTypeRegistry:{},topicNumberingIndexRegistry:{},topicTaskRegistry:{}})}function u(t,e){delete t.indexSetBySheetId[e]}function h(t,e){const n=new o.wz,i=new Set;return e(t,n,(t=>i.add(t))),n.resolve(t),i.forEach((e=>{(0,l.F)(t,e),(0,s.iq)(t,e);const n=(0,a.vB)((0,a.sb)(t,e));n&&(0,a.pE)(t,{...n,revisionId:(0,r.Vj)()},e)})),t}function d(t){return h({metadata:{},sheets:[],elementRegistryBySheetId:{},idRefRegistry:{},indexSetBySheetId:{}},((e,n,r)=>{(0,s.vV)(e,t,{refResolver:n,registerRelatedSheet:r})}))}function p(t,e){return(0,i.JG)(t,(t=>h(t,e)))}},39546:(t,e,n)=>{"use strict";n.d(e,{FW:()=>a,XS:()=>o,er:()=>s});var r=n(49787),i=n(69598);function o(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n]?.parentTopicIdRegistry[e]}function s(t,e,n){const o=(0,r.az)(t,e);o&&((0,i.xy)(t,o),t.indexSetBySheetId[o].parentTopicIdRegistry[e]=n)}function a(t,e){const n=(0,r.az)(t,e);n&&delete t.indexSetBySheetId[n]?.parentTopicIdRegistry[e]}},60681:(t,e,n)=>{"use strict";n.d(e,{$r:()=>h,Eo:()=>c,FX:()=>p,Jy:()=>m,OD:()=>l,RN:()=>u,fo:()=>a,it:()=>f,pY:()=>d,um:()=>s});var r=n(49787),i=n(69598),o=n(69798);function s(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n]?.incomingRelationshipIdsRegistry[e]}function a(t,e,n){const o=(0,r.az)(t,e);o&&((0,i.xy)(t,o),t.indexSetBySheetId[o].incomingRelationshipIdsRegistry[e]=n)}function l(t,e,n){a(t,e,[...s(t,e)??[],n])}function c(t,e){const n=(0,r.az)(t,e);n&&delete t.indexSetBySheetId[n]?.incomingRelationshipIdsRegistry[e]}function u(t,e,n){const i=(0,r.az)(t,e);if(!i)return;const s=t.indexSetBySheetId[i]?.incomingRelationshipIdsRegistry;s&&(0,o.cl)(s,e,n)}function h(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n]?.outgoingRelationshipIdsRegistry[e]}function d(t,e,n){p(t,e,[...h(t,e)??[],n])}function p(t,e,n){const o=(0,r.az)(t,e);o&&((0,i.xy)(t,o),t.indexSetBySheetId[o].outgoingRelationshipIdsRegistry[e]=n)}function f(t,e){const n=(0,r.az)(t,e);n&&delete t.indexSetBySheetId[n]?.outgoingRelationshipIdsRegistry[e]}function m(t,e,n){const i=(0,r.az)(t,e);if(!i)return;const s=t.indexSetBySheetId[i]?.outgoingRelationshipIdsRegistry;s&&(0,o.cl)(s,e,n)}},94792:(t,e,n)=>{"use strict";n.d(e,{LG:()=>a,LJ:()=>s,hT:()=>o});var r=n(49787),i=n(69598);function o(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n]?.ownerSummaryIdRegistry[e]}function s(t,e,n){const o=(0,r.az)(t,e);o&&((0,i.xy)(t,o),t.indexSetBySheetId[o].ownerSummaryIdRegistry[e]=n)}function a(t,e){const n=(0,r.az)(t,e);n&&delete t.indexSetBySheetId[n]?.ownerSummaryIdRegistry[e]}},16949:(t,e,n)=>{"use strict";n.d(e,{WH:()=>s,og:()=>o,rV:()=>a});var r=n(49787),i=n(69598);function o(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n]?.topicNumberingIndexRegistry[e]}function s(t,e,n){const o=(0,r.az)(t,e);o&&((0,i.xy)(t,o),t.indexSetBySheetId[o].topicNumberingIndexRegistry[e]=n)}function a(t,e){const n=(0,r.az)(t,e);n&&delete t.indexSetBySheetId[n]?.topicNumberingIndexRegistry[e]}},75143:(t,e,n)=>{"use strict";n.d(e,{F:()=>l,I:()=>c});var r=n(49787),i=n(2104),o=n(71381),s=n(34904),a=n(88950);function l(t,e){if(!function(t,e){for(const n in(0,r.Cz)(t,e))if(u(t,n))return!0;return!1}(t,e))return void function(t,e){t.indexSetBySheetId[e]&&(t.indexSetBySheetId[e].topicTaskRegistry={})}(t,e);const n=(0,r.vB)((0,r.sb)(t,e));if(!n)return;const i=n.rootTopicId;i&&h(t,i)}function c(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n].topicTaskRegistry[e]}function u(t,e){const n=(0,r.Ob)((0,r.sb)(t,e));if(!n)return null;const i=n.extensions?.["org.xmind.ui.task"]?.content;if(!(0,a.gK)(i)||"object"!=typeof i||Array.isArray(i))return null;const{status:o,progress:s}=i;return"todo"!==o&&"done"!==o&&"number"!=typeof s?null:i}function h(t,e){const n=(0,r.Ob)((0,r.sb)(t,e));if(!n)return;const a=[...n.children??[],...n.detachedChildren??[],...n.summaries??[]],l=new Set,p=[];let f=null,m=null,g=0,y=0;a.forEach((e=>{h(t,e);const n=c(t,e);if(!n)return;const r=(0,i.HA)(t,e);if(r===o.oz.Detached||r===o.oz.Summary)return;const a=u(t,e);f=(0,s.h5)(f,n.taskInfoRollupStartDate,a?.start),m=(0,s.V8)(m,n.taskInfoRollupDueDate,a?.due),p.push(...n.taskInfoRollupAssignees??[],...a?.assignees??[]),n.taskDescendants?.forEach((t=>{l.add(t)})),a&&l.add(e),n.taskPresentation&&(y+=1,g+=n.taskProgress??0),!a&&n.taskDescendants?.length&&(y+=1,g+=n.taskInfoRollupProgress??0)}));const b=u(t,n.id),_=function(t,e){if(0===e)return 0;return Number((t/e).toFixed(2))}(g,y),v=function(t,e){if(!t)return null;if("number"==typeof t.progress)return"task-info-progress";return 0===e?"todo-checkbox":"todo-progress"}(b,l.size),x=function(t,e,n){if(!t||!e)return null;if("todo-checkbox"===e)return"done"===t.status?1:0;if("todo-progress"===e&&"number"==typeof n)return Number(n.toFixed(2));if("task-info-progress"===e){if(t.rollup)return Number(n.toFixed(2));if("number"==typeof t.progress)return Number(t.progress.toFixed(2))}return null}(b,v,_),w="number"==typeof b?.priority?Math.min(Math.max(b.priority,0),9):null;!function(t,e,n){const i=(0,r.az)(t,e);i&&(t.indexSetBySheetId[i].topicTaskRegistry[e]=n)}(t,e,{taskPresentation:v,taskDescendants:Array.from(l),taskTodoStatus:b?.status??null,taskInfoStartDate:b?.start??null,taskInfoRollupStartDate:f,taskInfoDueDate:b?.due??null,taskInfoRollupDueDate:m,taskProgress:x,taskInfoRollupProgress:_,taskInfoRollupAssignees:d(p),taskInfoPriority:w,taskInfoDisplay:b?.display??null,taskInfoRollup:b?.rollup??!1,taskInfoCreator:b?.creator??null,taskInfoAssignees:b?.assignees??[],countOfChildrenTaskDenominator:y,countOfChildrenTaskProgressNumerator:g})}function d(t){const e=[];return t.forEach((t=>{e.find((e=>e.id===t.id))||e.push(t)})),e}},2104:(t,e,n)=>{"use strict";n.d(e,{HA:()=>o,Lo:()=>a,jY:()=>s});var r=n(49787),i=n(69598);function o(t,e){const n=(0,r.az)(t,e);if(n)return t.indexSetBySheetId[n]?.topicTypeRegistry[e]}function s(t,e,n){const o=(0,r.az)(t,e);o&&((0,i.xy)(t,o),t.indexSetBySheetId[o].topicTypeRegistry[e]=n)}function a(t,e){const n=(0,r.az)(t,e);n&&delete t.indexSetBySheetId[n]?.topicTypeRegistry[e]}},88950:(t,e,n)=>{"use strict";n.d(e,{C3:()=>p,CW:()=>v,FA:()=>x,IY:()=>d,JJ:()=>R,Ko:()=>S,bi:()=>g,gK:()=>M,hX:()=>h});var r=n(71381),i=n(94792),o=n(69598),s=n(73130),a=n(77997),l=n(87494),c=n(69798);function u(t,e){return 1===t.length&&function(t,e){return 1==Object.entries(t).filter((t=>!!t[1])).map((([t])=>t)).length&&t.text===e}(t[0],e)}function h(t){if(!t.sheets.length)return{content:[],metadata:{},resources:[]};const e=new Set,n=t=>{t.startsWith("xap:")&&e.add(t.slice(4))};return{content:t.sheets.map((t=>p(t,n))),metadata:d(t),resources:[...e]}}function d(t){const e={[r.KZ.DataStructureVersion]:l.iO},n=t.metadataKeys;return n.forEach((n=>{const r=t.metadataFor(n);if(!r)return;const i=n.split("/"),o=i.pop();let s=e;if(o){for(let t=0;t<i.length;++t)a=i[t],(l=s)[a]||(l[a]={}),s=l[a];var a,l;s[o]=r}})),e}function p(t,e){const{id:n,rootTopic:r,relationships:i,revisionId:o}=t,a={id:n,revisionId:o};if(a.class=_([...t.classes,"sheet"]).join(" "),a.rootTopic=f(r,e),i.length&&(a.relationships=i.map((t=>function(t){const e={id:t.id},n=_([...t.classes??[]]);n.length&&(e.class=n.join(" "));e.end1Id=t.source.id,e.end2Id=t.target.id,t.title&&(e.title=t.title);t.attributedTitle?.length&&(u(t.attributedTitle,t.title)||(e.attributedTitle=t.attributedTitle.map((t=>({text:t.text,...b(t)})))));const r={};t.controlPoint1&&(r[0]=t.controlPoint1);t.controlPoint2&&(r[1]=t.controlPoint2);Object.keys(r).length&&(e.controlPoints=r);const i={};t.sourceRefPoint&&(i[0]=t.sourceRefPoint);t.targetRefPoint&&(i[1]=t.targetRefPoint);Object.keys(i).length&&(e.lineEndPoints=i);const o=y(t);o&&(e.style={id:(0,c.Vj)(),properties:o});return e}(t)))),t.title&&(a.title=t.title),t.topicOverlapping&&(a.topicOverlapping=t.topicOverlapping),t.rootTopicZIndex&&(a.rootTopicZIndex=t.rootTopicZIndex),t.topicPositioning&&(a.topicPositioning=t.topicPositioning),t.topicNotesDisplay&&(a.topicNotesDisplay=t.topicNotesDisplay),"flexible"===t.floatingTopicFlexibility&&(a.floatingTopicFlexible=!0),t.compactLayoutLevel&&(a.compactLayoutModeLevel=t.compactLayoutLevel),t.labelSortOrder&&(a.labelSortOrder=t.labelSortOrder),t.legendVisibility){const e=a.legend??{};e.visibility=t.legendVisibility,a.legend=e}if(t.legendPosition){const e=a.legend??{};e.position=t.legendPosition,a.legend=e}if(t.describedMarkers.length){const e={};for(const n of t.describedMarkers)e[n]=t.markerDescriptionFor(n);const n=a.legend??{};a.legend={...n,markers:e}}if(t.extensionProviders?.length){const n=t.extensionProviders.map((n=>{const r=t.extensionBy(n);if(!r)return null;const i={provider:n};return r.content&&(i.content=r.content),r.resources.length&&(i.resourceRefs=r.resources,r.resources.forEach((t=>e?.(t)))),i})).filter((t=>!!t));n.length&&(a.extensions=n)}const l=y(t);l&&(a.style={id:(0,c.Vj)(),properties:l});const h={},d=(0,c.xp)(t,s.k).internalElement.themeStyles;for(const t in d){const e=y(d[t]);e&&(h[t]={id:(0,c.Vj)(),properties:e})}return t.skeletonThemeId&&(h.skeletonThemeId=t.skeletonThemeId),t.colorThemeId&&(h.colorThemeId=t.colorThemeId),a.theme=h,a}function f(t,e){const{id:n,classes:o,title:s,titleUnedited:a,attributedTitle:l,notes:h,notesDisplay:d,labels:p,imageSource:g,imageWidth:v,imageHeight:x,imagePlacement:w,imageLockRatio:S,imageBorderLineColor:j,imageBorderLineWidth:R,imageShadowVisible:I,imageOpacity:O,imageIsMathJaxImage:k,href:L,position:C,children:A,detachedChildren:D,summaries:P,boundaries:E,callout:z,markers:B,branchState:F,structureClass:W,customWidth:N,numberingPattern:q,numberingTiered:H,numberingFixedIndex:V}=t,X={id:n},J=_([...o??[],...t.topicType===r.oz.Root?["topic"]:[]]);if(J.length&&(X.class=J.join(" ")),s&&(X.title=s),null!==a&&(X.titleUnedited=a),l?.length&&(u(l,s)||(X.attributedTitle=l.map((t=>({text:t.text,...b(t)}))))),h&&(X.notes={...null!==h.text?{plain:{content:h.text}}:{},...null!==h.html?{realHTML:{content:h.html}}:{}}),d&&(X.notesDisplay=d),p.length&&(X.labels=p),g){e?.(g);const t={src:g};v&&(t.width=v),x&&(t.height=x),w&&(t.align=w),S&&(t.lockRatio=S),j&&(t.borderColor=j),R&&(t.borderWidth=R),I&&(t.shadowVisible=I),O&&(t.opacity=O),k&&(t.isMathJaxImage=k),X.image=t}if(N&&(X.customWidth=N),L&&(e?.(L),X.href=L),B.length&&(X.markers=B.map((t=>({markerId:t})))),C&&(X.position=C),F&&(X.branch=F),W&&(X.structureClass=W),t.extensionProviders?.length){const n=t.extensionProviders.map((n=>{const r=t.extensionBy(n);if(!r)return null;const i={provider:n};return r.content&&(i.content=r.content),r.resources.length&&(i.resourceRefs=r.resources,r.resources.forEach((t=>e?.(t)))),i})).filter((t=>!!t));n.length&&(X.extensions=n)}if(M(q)||M(H)||M(V)){const t=r.OM,e={};M(q)&&(e.pattern=q),M(H)&&(e.tiered=H),M(V)&&(e.fixedIndex=V);const n=(X.extensions??[]).find((e=>e.provider===t));if(n)n.content=e;else{const n={provider:t,content:e};X.extensions=[...X.extensions??[],n]}}else X.extensions&&X.extensions.length&&(X.extensions=X.extensions.filter((t=>t.provider!==r.OM)),X.extensions.length||delete X.extensions);if(A.length&&(X.children={attached:A.map((t=>f(t,e)))}),D.length){const t="children"in X?T(X.children):{};X.children={...t,detached:D.map((t=>f(t,e)))}}if(E.length&&(X.boundaries=E.map((t=>function(t){const e={id:t.id},n=_([...t.classes??[]]);n.length&&(e.class=n.join(" "));e.range="parent"===t.rangeType?"master":`(${t.rangeStart},${t.rangeEnd})`,t.title&&(e.title=t.title);t.attributedTitle?.length&&(u(t.attributedTitle,t.title)||(e.attributedTitle=t.attributedTitle.map((t=>({text:t.text,...b(t)})))));const r=y(t);r&&(e.style={id:(0,c.Vj)(),properties:r});return e}(t)))),P.length){X.summaries=P.map((t=>function(t){const e=t.id,n=t.ownerDocument.internalRepository,r={id:(0,c.yR)((0,i.hT)(n,e))},o=_([...t.classes??[]]);o.length&&(r.class=o.join(" "));r.range=`(${t.rangeStart},${t.rangeEnd})`,r.topicId=e;const s=y(t);s&&(r.style={id:(0,c.Vj)(),properties:s});return r}(t)));const t="children"in X?T(X.children):{};X.children={...t,summary:P.map((t=>f(t.asTopic(),e)))}}if(z){const t="children"in X?T(X.children):{};X.children={...t,callout:[m(z,e)]}}const Z=y(t);return Z&&(X.style={id:(0,c.Vj)(),properties:Z}),X}function m(t,e){const n=f(t,e),r=y(t);if(r&&t.shapeClass){let e=t.shapeClass;"org.xmind.topicShape.ellipse"===t.shapeClass?e="org.xmind.calloutTopicShape.balloon.ellipse":"org.xmind.topicShape.roundedRect"===t.shapeClass?e="org.xmind.calloutTopicShape.balloon.roundedRect":"org.xmind.topicShape.rect"===t.shapeClass&&(e="org.xmind.calloutTopicShape.balloon.rectangle"),delete r["shape-class"],r["callout-shape-class"]=e,n.style={id:(0,c.Vj)(),properties:r}}return n}function g(t){const e={};Object.keys(t.fileEntries).forEach((n=>{const r=t.fileEntries[n],i={};r.keyDerivationSize&&(i.size=r.keyDerivationSize),r.keyDerivationIterationCount&&(i["iteration-count"]=r.keyDerivationIterationCount),r.keyDerivationAlgorithm&&(i["algorithm-name"]=r.keyDerivationAlgorithm),r.cipherAlgorithm&&(i["key-derivation-name"]=r.cipherAlgorithm),r.keyDerivationSalt&&(i.salt=r.keyDerivationSalt),r.keyDerivationIV&&(i.iv=r.keyDerivationIV);const o={};Object.keys(i).length>0&&(o["encryption-data"]=i),e[n]=o}));const n={"file-entries":e};return t.passwordHint&&(n["password-hint"]=t.passwordHint),n}function y(t){const e={};return Object.assign(e,b(t)),t.fillColor&&(e["svg:fill"]=t.fillColor),t.fillOpacity&&(e["svg:opacity"]=t.fillOpacity),t.fillPattern&&(e["fill-pattern"]=t.fillPattern),t.lineWidth&&(e["line-width"]=t.lineWidth),t.lineColor&&(e["line-color"]=t.lineColor),t.linePattern&&(e["line-pattern"]=t.linePattern),t.borderLineColor&&(e["border-line-color"]=t.borderLineColor),t.borderLineWidth&&(e["border-line-width"]=t.borderLineWidth),t.borderLinePattern&&(e["border-line-pattern"]=t.borderLinePattern),t.shapeClass&&(e["shape-class"]=t.shapeClass),t.lineClass&&(e["line-class"]=t.lineClass),t.arrowBeginClass&&(e["arrow-begin-class"]=t.arrowBeginClass),t.arrowEndClass&&(e["arrow-end-class"]=t.arrowEndClass),t.cjkFontFamily&&(e["cjk-font-family"]=t.cjkFontFamily),t.multiLineColors&&(e["multi-line-colors"]=t.multiLineColors),t.colorList&&(e["color-list"]=t.colorList),t.lineTapered&&(e["line-tapered"]=t.lineTapered),t.alignmentByLevel&&(e["alignment-by-level"]=t.alignmentByLevel),t.globalLineWidthDisabled&&(e["global_line-width"]=t.globalLineWidthDisabled),t.globalFontFamilyDisabled&&(e["global_fo:font-family"]=t.globalFontFamilyDisabled),0===Object.keys(e).length?null:e}function b(t){const e={};return t.fontFamily&&(e["fo:font-family"]=t.fontFamily),t.fontSize&&(e["fo:font-size"]=t.fontSize),t.fontWeight&&(e["fo:font-weight"]=t.fontWeight),t.fontStyle&&(e["fo:font-style"]=t.fontStyle),t.textColor&&(e["fo:color"]=t.textColor),t.textTransform&&(e["fo:text-transform"]=t.textTransform),t.textDecoration&&(e["fo:text-decoration"]=t.textDecoration),t.textAlign&&(e["fo:text-align"]=t.textAlign),Object.keys(e).length?e:null}function _(t){return Array.from(new Set(t.map((t=>t.trim())).filter((t=>!!t))))}function v(t,e){const n={};n.metadata=x(e);const r=[],i=t=>{if(r.includes(t))throw new Error("Duplicated ID found during deserialization process.");r.push(t)};return n.sheets=L(t).map((t=>S(t,i))),new a.s((0,o.vA)(n))}function x(t){const e={},n=(t,r)=>{if("object"!=typeof t||null===t||Array.isArray(t))"string"==typeof t&&r&&(e[r]=t);else{const e=t;Object.keys(e).forEach((t=>n(e[t],r?r+"/"+t:t)))}};return n(t),e}function w(t){if("number"==typeof t)return t;if("boolean"==typeof t)return t;if("string"==typeof t)return t;if(Array.isArray(t))return t.map((t=>w(t))).filter((t=>null!==t));if("object"==typeof t&&t){const e={},n=t;return Object.keys(n).forEach((t=>{const r=w(n[t]);M(r)&&(e[t]=r)})),e}return null}function S(t,e){const n=C(t);e?.(n.id);const r={id:n.id};if(M(n.revisionId)&&(r.revisionId=A(n.revisionId)),M(n.class)&&(r.classes=k(A(n.class),"sheet")),M(n.title)&&(r.title=A(n.title)),M(n.topicOverlapping)&&(r.topicOverlapping=A(n.topicOverlapping)),M(n.rootTopicZIndex)&&(r.rootTopicZIndex=D(n.rootTopicZIndex)),M(n.topicPositioning)&&(r.topicPositioning=A(n.topicPositioning)),M(n.topicNotesDisplay)&&(r.topicNotesDisplay=A(n.topicNotesDisplay)),M(n.floatingTopicFlexible)&&(r.floatingTopicFlexibility="flexible"),M(n.compactLayoutModeLevel)&&(r.compactLayoutLevel=A(n.compactLayoutModeLevel)),M(n.labelSortOrder)&&(r.labelSortOrder=A(n.labelSortOrder)),M(n.style)){const t=I(n.style);for(const e in t){const n=e;r[n]=(0,c.yR)(t[n])}}if(M(n.rootTopic)&&(r.rootTopic=j(n.rootTopic,e)),M(n.relationships)&&(r.relationships=L(n.relationships).map((t=>function(t,e){const n=C(t);e?.(n.id);const r={id:n.id};M(n.class)&&(r.classes=k(A(n.class),"relationship"));M(n.title)&&(r.title=A(n.title));M(n.attributedTitle)&&(r.attributedTitle=L(n.attributedTitle).map((t=>{const e=T(t);return{text:A(e.text),...O(e)}})));if(M(n.controlPoints)){const t=t=>"angle"in t&&"number"==typeof t.angle&&"amount"in t&&"number"==typeof t.amount,e=T(n.controlPoints);if(M(e[0])){const n=T(e[0]);r.controlPoint1=t(n)?n:E(n)}if(M(e[1])){const n=T(e[1]);r.controlPoint2=t(n)?n:E(n)}}if(M(n.lineEndPoints)){const t=T(n.lineEndPoints);M(t[0])&&(r.sourceRefPoint=E(t[0])),M(t[1])&&(r.targetRefPoint=E(t[1]))}if(M(n.style)){const t=I(n.style);for(const e in t){const n=e;r[n]=(0,c.yR)(t[n])}}M(n.end1Id)&&(r.source={id:A(n.end1Id)});M(n.end2Id)&&(r.target={id:A(n.end2Id)});return r}(t)),e)),M(n.extensions)){const t=L(n.extensions);r.extensions={};for(const e of t){const t=T(e),n=t.provider?A(t.provider):null;if(n){const e=t.content?w(t.content):null,i=t.resourceRefs?L(t.resourceRefs).map((t=>t)).filter((t=>!!t)):[];(e||i.length)&&(r.extensions[n]={content:e,resources:i})}}}if(M(n.theme)){const t=T(n.theme);r.themeStyles={};for(const e in t){const n=I(t[e]);n&&(r.themeStyles[e]=n)}M(t.skeletonThemeId)&&(r.skeletonThemeId=A(t.skeletonThemeId)),M(t.colorThemeId)&&(r.colorThemeId=A(t.colorThemeId))}if(M(n.legend)){const t=T(n.legend);if(M(t.visibility)&&(r.legendVisibility=A(t.visibility)),M(t.position)){const e=T(t.position);M(e.x)&&M(e.y)&&(r.legendPosition=E(t.position))}if(M(t.markers)){const e=T(t.markers??{});r.legendMarkers={};for(const t of Object.keys(e))r.legendMarkers[t]=e[t]}}return r}function j(t,e){const n=C(t);e?.(n.id);const i={id:n.id};if(M(n.class)&&(i.classes=k(A(n.class),"topic")),M(n.title)&&(i.title=A(n.title)),M(n.titleUnedited)&&(i.titleUnedited=P(n.titleUnedited)),M(n.attributedTitle)&&(i.attributedTitle=L(n.attributedTitle).map((t=>{const e=T(t);return{text:A(e.text),...O(e)}}))),M(n.notes)){const t=T(n.notes),e={text:null,html:null};M(t.plain)&&M(T(t.plain).content)&&(e.text=A(T(t.plain).content)),M(t.realHTML)&&M(T(t.realHTML).content)&&(e.html=A(T(t.realHTML).content)),i.notes=e}if(M(n.notesDisplay)&&(i.notesDisplay=A(n.notesDisplay)),M(n.labels)&&(i.labels=L(n.labels).map((t=>A(t)))),M(n.image)){const t=T(n.image);M(t.src)&&(i.imageSource=A(t.src)),M(t.width)&&(i.imageWidth=D(t.width)),M(t.height)&&(i.imageHeight=D(t.height)),M(t.align)&&(i.imagePlacement=A(t.align)),M(t.lockRatio)&&(i.imageLockRatio=P(t.lockRatio)),M(t.borderColor)&&(i.imageBorderLineColor=A(t.borderColor)),M(t.borderWidth)&&(i.imageBorderLineWidth=D(t.borderWidth)),M(t.shadowVisible)&&(i.imageShadowVisible=P(t.shadowVisible)),M(t.opacity)&&(i.imageOpacity=D(t.opacity)),M(t.isMathJaxImage)&&(i.imageIsMathJaxImage=P(t.isMathJaxImage))}if(M(n.href)&&(i.href=A(n.href)),M(n.position)){const t=T(n.position);M(t.x)&&M(t.y)&&(i.position=E(n.position))}if(M(n.branch)&&(i.branchState=A(n.branch)),M(n.structureClass)&&(i.structureClass=A(n.structureClass)),M(n.markers)){const t=[];for(const e of L(n.markers)){const n=T(e);M(n.markerId)&&t.push(A(n.markerId))}t.length&&(i.markers=t)}if(M(n.style)){const t=I(n.style);for(const e in t){const n=e;i[n]=(0,c.yR)(t[n])}}if(M(n.customWidth)&&(i.customWidth=D(n.customWidth)),M(n.extensions)){const t=L(n.extensions);i.extensions={};for(const e of t){const t=T(e),n=M(t.provider)?A(t.provider):null;if(n){const e=M(t.content)?w(t.content):null,r=M(t.resourceRefs)?L(t.resourceRefs).map((t=>t)).filter((t=>!!t)):[];(e||r.length)&&(i.extensions[n]={content:e,resources:r})}}}if(i.extensions?.[r.OM]){const t="object"!=typeof(o=i.extensions[r.OM].content)||null===o||Array.isArray(o)?{}:o;M(t.pattern)&&(i.numberingPattern=A(t.pattern)),M(t.tiered)&&(i.numberingTiered=P(t.tiered)),M(t.fixedIndex)&&(i.numberingFixedIndex=D(t.fixedIndex)),delete i.extensions[r.OM],0===Object.keys(i.extensions).length&&delete i.extensions}var o;if(M(n.children)){const t=T(n.children);M(t.attached)&&(i.children=L(t.attached).map((t=>j(t,e)))),M(t.detached)&&(i.detachedChildren=L(t.detached).map((t=>j(t,e)))),M(t.callout)&&(i.callout=j(L(t.callout)[0],e))}return M(n.boundaries)&&(i.boundaries=L(n.boundaries).map((t=>function(t,e){const n=C(t);e?.(n.id);const r={id:n.id};M(n.class)&&(r.classes=k(A(n.class),"boundary"));M(n.title)&&(r.title=A(n.title));M(n.attributedTitle)&&(r.attributedTitle=L(n.attributedTitle).map((t=>{const e=T(t);return{text:A(e.text),...O(e)}})));if(M(n.style)){const t=I(n.style);for(const e in t){const n=e;r[n]=(0,c.yR)(t[n])}}if(M(n.range)){const t=A(n.range);if("master"===t)r.rangeType="parent";else{r.rangeType="children";const e=t.substring(1,t.length-1).split(",");r.rangeStart=parseInt(e[0]),r.rangeEnd=parseInt(e[1])}}return r}(t,e)))),M(n.summaries)&&(i.summaries=L(n.summaries).map((t=>function(t,e,n){const r=C(t);n?.(r.id);const i={id:r.id};M(r.class)&&(i.classes=k(A(r.class),"summary"));if(M(r.style)){const t=I(r.style);for(const e in t){const n=e;i[n]=(0,c.yR)(t[n])}}const o=A(r.topicId),s=T(e),a=j(L(T(s.children).summary).find((t=>T(t).id===o)),n);if(i.topic=a,M(r.range)){const t=A(r.range),e=t.substring(1,t.length-1).split(",");i.rangeStart=parseInt(e[0]),i.rangeEnd=parseInt(e[1])}return i}(t,n,e)))),i}function R(t){const e=T(t),n={};if(M(e["file-entries"])){const t=T(e["file-entries"]);Object.keys(t).forEach((e=>{const r=T(t[e]),i={};if(M(r["encryption-data"])){const t=T(r["encryption-data"]);M(t["algorithm-name"])&&(i.keyDerivationAlgorithm=A(t["algorithm-name"])),M(t["key-derivation-name"])&&(i.cipherAlgorithm=A(t["key-derivation-name"])),M(t.salt)&&(i.keyDerivationSalt=A(t.salt)),M(t.iv)&&(i.keyDerivationIV=A(t.iv)),M(t.size)&&(i.keyDerivationSize=D(t.size)),M(t["iteration-count"])&&(i.keyDerivationIterationCount=D(t["iteration-count"]))}n[e]=Object.keys(i).length>0?{path:e,encrypted:!0,...i}:{path:e,encrypted:!1}}))}const r={fileEntries:n};return M(e["password-hint"])&&(r.passwordHint=A(e["password-hint"])),r}function I(t){if(null==t||"object"!=typeof t)return null;const e=T(t);if(!e.properties)return null;const n=T(e.properties),r={};if(Object.assign(r,O(n)),M(n["svg:fill"])&&(r.fillColor=A(n["svg:fill"])),M(n["svg:opacity"])&&(r.fillOpacity=A(n["svg:opacity"])),M(n["fill-pattern"])&&(r.fillPattern=A(n["fill-pattern"])),M(n["line-width"])&&(r.lineWidth="number"==typeof n["line-width"]?n["line-width"].toString():A(n["line-width"])),M(n["line-color"])&&(r.lineColor=A(n["line-color"])),M(n["line-pattern"])&&(r.linePattern=A(n["line-pattern"])),M(n["border-line-color"])&&(r.borderLineColor=A(n["border-line-color"])),M(n["border-line-width"])&&(r.borderLineWidth="number"==typeof n["border-line-width"]?n["border-line-width"].toString():A(n["border-line-width"])),M(n["border-line-pattern"])&&(r.borderLinePattern=A(n["border-line-pattern"])),M(n["shape-class"])&&(r.shapeClass=A(n["shape-class"])),M(n["line-class"])&&(r.lineClass=A(n["line-class"])),M(n["arrow-begin-class"])&&(r.arrowBeginClass=A(n["arrow-begin-class"])),M(n["arrow-end-class"])&&(r.arrowEndClass=A(n["arrow-end-class"])),M(n["callout-shape-class"])){const t=A(n["callout-shape-class"]);let e=t;"org.xmind.calloutTopicShape.balloon.ellipse"===t?e="org.xmind.topicShape.ellipse":"org.xmind.calloutTopicShape.balloon.roundedRect"===t?e="org.xmind.topicShape.roundedRect":"org.xmind.calloutTopicShape.balloon.rectangle"===t&&(e="org.xmind.topicShape.rect"),r.shapeClass=e}return M(n["cjk-font-family"])&&(r.cjkFontFamily=A(n["cjk-font-family"])),M(n["multi-line-colors"])&&(r.multiLineColors=A(n["multi-line-colors"])),M(n["color-list"])&&(r.colorList=A(n["color-list"])),M(n["line-tapered"])&&(r.lineTapered=A(n["line-tapered"])),M(n["alignment-by-level"])&&(r.alignmentByLevel=A(n["alignment-by-level"])),M(n["global_line-width"])&&(r.globalLineWidthDisabled=P(n["global_line-width"])),M(n["global_fo:font-family"])&&(r.globalFontFamilyDisabled=P(n["global_fo:font-family"])),r}function O(t){const e=T(t),n={};return M(e["fo:font-family"])&&(n.fontFamily=A(e["fo:font-family"])),M(e["fo:font-size"])&&(n.fontSize="number"==typeof e["fo:font-size"]?e["fo:font-size"].toString():A(e["fo:font-size"])),M(e["fo:font-weight"])&&(n.fontWeight=`${e["fo:font-weight"]}`),M(e["fo:font-style"])&&(n.fontStyle=A(e["fo:font-style"])),M(e["fo:color"])&&(n.textColor=A(e["fo:color"])),M(e["fo:text-transform"])&&(n.textTransform=A(e["fo:text-transform"])),M(e["fo:text-decoration"])&&(n.textDecoration=A(e["fo:text-decoration"])),M(e["fo:text-align"])&&(n.textAlign=A(e["fo:text-align"])),n}function k(t,e){return t.split(" ").filter((t=>!!t&&t!==e))}function T(t){if("object"==typeof t&&null!==t&&!Array.isArray(t))return t;throw new Error(`Not a JSON object: ${JSON.stringify(t)}`)}function L(t){if(Array.isArray(t))return t;throw new Error(`Not a JSON array: ${JSON.stringify(t)}`)}function C(t){const e=T(t);if("id"in e&&"string"==typeof e.id)return e;throw new Error(`No "id" in object: ${JSON.stringify(t)}`)}function A(t){if("string"==typeof t)return t;throw new Error(`Not a JSON string: ${JSON.stringify(t)}`)}function D(t){if("number"==typeof t)return t;throw new Error(`Not a number: ${JSON.stringify(t)}`)}function P(t){if("boolean"==typeof t)return t;throw new Error(`Not a boolean: ${JSON.stringify(t)}`)}function E(t){const e=T(t);if("x"in e&&"y"in e)return{x:D(e.x),y:D(e.y)};throw new Error(`Not a point object: ${JSON.stringify(t)}`)}function M(t){return null!=t}},71381:(t,e,n)=>{"use strict";n.d(e,{KZ:()=>i,OM:()=>s,ZW:()=>o,oz:()=>r});var r=(t=>(t.Root="root",t.Attached="attached",t.Detached="detached",t.Summary="summary",t.Callout="callout",t))(r||{});const i=Object.freeze({CreatorName:"creator/name",CreatorVersion:"creator/version",DataStructureVersion:"dataStructureVersion",LayoutEngineVersion:"layoutEngineVersion",ActiveSheetId:"activeSheetId"}),o=["numeral-arabic","numeral-roman","alphabet-uppercase","alphabet-lowercase"],s="org.xmind.ui.numbering"},87494:(t,e,n)=>{"use strict";n.d(e,{B0:()=>c,B1:()=>h,C3:()=>i.C3,CW:()=>i.CW,CX:()=>d,FA:()=>i.FA,IY:()=>i.IY,JJ:()=>i.JJ,KR:()=>l,Ko:()=>i.Ko,VZ:()=>p,Yr:()=>f,_V:()=>u,bi:()=>i.bi,bw:()=>s,hX:()=>i.hX,iO:()=>o});var r=n(71381),i=n(88950);const o="2",s=Object.freeze({ContentJSON:"content.json",MetadataJSON:"metadata.json",ManifestJSON:"manifest.json",ThumbnailPNG:"Thumbnails/thumbnail.png",ContentXML:"content.xml"}),a='<?xml version="1.0" encoding="UTF-8" standalone="no"?><xmap-content xmlns="urn:xmind:xmap:xmlns:content:2.0" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink" modified-by="bruce" timestamp="1503058545540" version="2.0"><sheet id="7abtd0ssc7n4pi1nu6i7b6lsdh" modified-by="bruce" theme="0kdeemiijde6nuk97e4t0vpp54" timestamp="1503058545540"><topic id="1vr0lcte2og4t2sopiogvdmifc" modified-by="bruce" structure-class="org.xmind.ui.logic.right" timestamp="1503058545417"><title>Warning\n警告\nAttention\nWarnung\n경고</title><children><topics type="attached"><topic id="71h1aip2t1o8vvm0a41nausaar" modified-by="bruce" timestamp="1503058545423"><title svg:width="500">This file can not be opened normally, please do not modify and save, otherwise the contents will be permanently lost！</title><children><topics type="attached"><topic id="428akmkh9a0tog6c91qj995qdl" modified-by="bruce" timestamp="1503058545427"><title>You can try using XMind 8 Update 3 or later version to open</title></topic></topics></children></topic><topic id="2kb87f8m38b3hnfhp450c7q35e" modified-by="bruce" timestamp="1503058545434"><title svg:width="500">该文件无法正常打开，请勿修改并保存，否则文件内容将会永久性丢失！</title><children><topics type="attached"><topic id="3m9hoo4a09n53ofl6fohdun99f" modified-by="bruce" timestamp="1503058545438"><title>你可以尝试使用 XMind 8 Update 3 或更新版本打开</title></topic></topics></children></topic><topic id="7r3r4617hvh931ot9obi595r8f" modified-by="bruce" timestamp="1503058545444"><title svg:width="500">該文件無法正常打開，請勿修改並保存，否則文件內容將會永久性丟失！</title><children><topics type="attached"><topic id="691pgka6gmgpgkacaa0h3f1hjb" modified-by="bruce" timestamp="1503058545448"><title>你可以嘗試使用 XMind 8 Update 3 或更新版本打開</title></topic></topics></children></topic><topic id="0f2e3rpkfahg4spg4nda946r0b" modified-by="bruce" timestamp="1503058545453"><title svg:width="500">この文書は正常に開かないので、修正して保存しないようにしてください。そうでないと、書類の内容が永久に失われます。！</title><children><topics type="attached"><topic id="4vuubta53ksc1falk46mevge0t" modified-by="bruce" timestamp="1503058545457"><title>XMind 8 Update 3 や更新版を使って開くこともできます</title></topic></topics></children></topic><topic id="70n9i4u3lb89sq9l1m1bs255j5" modified-by="bruce" timestamp="1503058545463"><title svg:width="500">Datei kann nicht richtig geöffnet werden. Bitte ändern Sie diese Datei nicht und speichern Sie sie, sonst wird die Datei endgültig gelöscht werden.</title><children><topics type="attached"><topic id="1qpc5ee298p2sqeqbinpca46b7" modified-by="bruce" timestamp="1503058545466"><title svg:width="500">Bitte versuchen Sie, diese Datei mit XMind 8 Update 3 oder später zu öffnen.</title></topic></topics></children></topic><topic id="4dmes10uc19pq7enu8sc4bmvif" modified-by="bruce" timestamp="1503058545473"><title svg:width="500">Ce fichier ne peut pas ouvert normalement, veuillez le rédiger et sauvegarder, sinon le fichier sera perdu en permanence. </title><children><topics type="attached"><topic id="5f0rivgubii2launodiln7sdkt" modified-by="bruce" timestamp="1503058545476"><title svg:width="500">Vous pouvez essayer d\'ouvrir avec XMind 8 Update 3 ou avec une version plus récente.</title></topic></topics></children></topic><topic id="10pn1os1sgfsnqa8akabom5pej" modified-by="bruce" timestamp="1503058545481"><title svg:width="500">파일을 정상적으로 열 수 없으며, 수정 및 저장하지 마십시오. 그렇지 않으면 파일의 내용이 영구적으로 손실됩니다!</title><children><topics type="attached"><topic id="0l2nr0fq3em22rctapkj46ue58" modified-by="bruce" timestamp="1503058545484"><title svg:width="500">XMind 8 Update 3 또는 이후 버전을 사용하여</title></topic></topics></children></topic></topics></children><extensions><extension provider="org.xmind.ui.map.unbalanced"><content><right-number>-1</right-number></content></extension></extensions></topic><title>Sheet 1</title></sheet></xmap-content>';async function l(t,e,n,r={}){const{additionalResources:o=[],passwordHint:l}=r,{content:c,metadata:u,resources:h}=(0,i.hX)(t),d={},p=async(t,e)=>{const n={path:t,encryptable:!0};await e(n),d[t]={...n,encrypted:!!n.cipherAlgorithm}};await p(s.ContentJSON,(t=>e(t,JSON.stringify(c)))),await p(s.MetadataJSON,(t=>e(t,JSON.stringify(u))));for(const t of h)await p(t,n);for(const t of o)await p(t,n);const f=(0,i.bi)({fileEntries:d,...l?{passwordHint:l}:{}});await e({path:s.ManifestJSON,encryptable:!1},JSON.stringify(f)),await e({path:s.ContentXML,encryptable:!1},a)}function c(t,e){const{creatorName:n,creatorVersion:i,debugDataStructureVersion:s,...a}=e;let l=t.asMutable().metadataFor(r.KZ.CreatorName,n).metadataFor(r.KZ.CreatorVersion,i).metadataFor(r.KZ.DataStructureVersion,s??o);for(const[t,e]of Object.entries(a))l=l.metadataFor(t,e);return l.commit()}var u=(t=>(t.OverridingLowerVersionDataStructure="override-lower-version",t))(u||{});function h(t){const e=t.metadataFor(r.KZ.DataStructureVersion);if(e===o)return null;if(!e)return"override-lower-version";const n=parseInt(e);return!n||isNaN(n)||n<parseInt(o)?"override-lower-version":null}async function d(t,e,n={}){const{skipsDataStructureCheck:a=!1}=n,l=await t({path:s.ManifestJSON,encrypted:!1}),c=(0,i.JJ)(JSON.parse(l)),u=t=>c.fileEntries[t]??{path:t,encrypted:!0},h=u(s.ContentJSON),d=u(s.MetadataJSON);try{const n=JSON.parse(await t(d)),l=function(t){if(null===t||"object"!=typeof t||Array.isArray(t))return"";const e=t[r.KZ.DataStructureVersion];if("string"!=typeof e)return"";return e}(n);if(!a&&function(t){if(!t)return!1;const e=parseInt(t);if(!e||isNaN(e))return!1;const n=parseInt(o);return e>n}(l))throw new p(l);const f=JSON.parse(await t(h)),m=(0,i.CW)(f,n);for(const t in c.fileEntries)t!==s.ContentJSON&&t!==s.MetadataJSON&&t!==s.ManifestJSON&&t!==s.ContentXML&&await e(u(t));return m}catch(t){if(h.encrypted)throw new f(c.passwordHint??"");throw t}}class p extends Error{dataStructureVersion;constructor(t){super("Unsupported data structure version: "+t),this.dataStructureVersion=t}}class f extends Error{passwordHint;constructor(t){super("Wrong password or corrupted file"),this.passwordHint=t}}},69798:(t,e,n)=>{"use strict";function r(t){return JSON.parse(JSON.stringify(t))}function i(t,e,n){Array.isArray(n)&&n.length<1?delete t[e]:null!==n?t[e]=n:delete t[e]}function o(t,e,n){const r=t[e];if(!r)return;let i=-1;for(;(i=r.findIndex((t=>t===n)))>=0;)r.splice(i,1);r.length<=0&&delete t[e]}function s(t){if(null==t)throw new Error("Object is null or undefined.");return t}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}function l(t,e){if(!(t instanceof e))throw new Error("Invalid argument type");return t}function c(t){return"number"==typeof t}function u(t,e,n){const r=t=>t>=0&&t<n;return c(t)&&c(e)&&r(t)&&r(e)&&t<=e}function h(t){return t.filter((t=>c(t.rangeStart)&&c(t.rangeEnd)))}function d(t,e){return t.map((t=>{const n=t.rangeEnd+1-t.rangeStart,r=t.rangeStart+e,i=r+n-1;return{...t,rangeStart:r,rangeEnd:i}}))}function p(t){return null==t?null:Object.keys(t).reduce(((e,n)=>{const r=n,i=t[r];return null!=i&&(e[r]=i),e}),{})}n.d(e,{DN:()=>p,KC:()=>u,Lj:()=>i,Qy:()=>h,Vj:()=>a,cl:()=>o,f:()=>d,hj:()=>c,xp:()=>l,yR:()=>s,zO:()=>r})},34904:(t,e,n)=>{"use strict";function r(t){if(!t)return null;const e=new Date(t);if(isNaN(e.getTime()))return null;return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")+"T"+String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")}function i(...t){return[...t].filter((t=>t)).sort(((t,e)=>t-e))[0]??null}function o(...t){return[...t].filter((t=>t)).sort(((t,e)=>t-e)).pop()??null}function s(t){return!!t&&!isNaN(new Date(t).getTime())}function a(t,e){const n=864e5;if("number"==typeof t&&"number"==typeof e){const r=Math.abs(e-t);return Math.round(r/n)+1}if("string"==typeof t&&"string"==typeof e){if(!s(t)||!s(e))return null;const r=new Date(t),i=new Date(e),o=Math.abs(i.getTime()-r.getTime());return Math.round(o/n)+1}return null}function l(t,e){if(!s(t)||!s(e))return null;let n=new Date(t),r=new Date(e);n>r&&([n,r]=[r,n]);let i=0;const o=new Date(n);for(;o<=r;){const t=o.getDay();0!==t&&6!==t&&i++,o.setDate(o.getDate()+1)}return i}n.d(e,{Km:()=>r,Ti:()=>a,V8:()=>o,WA:()=>l,h5:()=>i})},11921:(t,e,n)=>{"use strict";n.d(e,{JG:()=>o,KN:()=>p,lC:()=>d,u7:()=>i});const r={get(...t){const e=Reflect.get(...t)??null;return"object"==typeof e&&null!==e?i(e):e},set:()=>!1,deleteProperty:()=>!1,ownKeys:(...t)=>Reflect.ownKeys(...t),getOwnPropertyDescriptor:(...t)=>Reflect.getOwnPropertyDescriptor(...t)};function i(t){return new Proxy(t,r)}function o(t,e){let n=t;return e(l(t,(()=>n),(t=>{n=t}))),n}const s=Symbol("realValue"),a=Symbol("isProxy");function l(t,e,n){return new Proxy(t??e(),{get(r,i){if(i===s)return e();if(i===a)return!0;const o=i,h=c(e(),o);return null===h||"object"!=typeof h?h:l(c(t,o),(()=>c(e(),o)),(r=>n(u(e(),o,r,t))))},set:(r,i,o)=>(n(u(e(),i,p(o),t)),!0),deleteProperty:(r,i)=>(n(function(t,e,n){if(!t||!(e in t))return t;return t=h(t,n),delete t[e],t}(e(),i,t)),!0),has:(t,n)=>Reflect.has(e(),n),ownKeys:()=>Reflect.ownKeys(e()),getOwnPropertyDescriptor:(t,n)=>Reflect.getOwnPropertyDescriptor(e(),n)})}function c(t,e){return(t??{})[e]}function u(t,e,n,r){return n===c(t,e)||((t=h(t,r))[e]=n),t}function h(t,e){return t===e?Array.isArray(t)?[...t]:{...t}:t}function d(t){const e=t[a];return"boolean"==typeof e&&!0===e}function p(t){if(null==t)return t;if("object"!=typeof(t=t[s]??t)||null===t)return t;const e=t;let n=e;for(const t in e){const r=e[t],i=p(r);i!==r&&(n=h(n,e),n[t]=i)}return n}},97234:(t,e,n)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}n.d(e,{Z:()=>s});var i=/^\s+/,o=/\s+$/;function s(t,e){if(e=e||{},(t=t||"")instanceof s)return t;if(!(this instanceof s))return new s(t,e);var n=function(t){var e={r:0,g:0,b:0},n=1,s=null,a=null,l=null,c=!1,u=!1;"string"==typeof t&&(t=function(t){t=t.replace(i,"").replace(o,"").toLowerCase();var e,n=!1;if(S[t])t=S[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};if(e=M.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=M.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=M.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=M.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=M.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=M.hsva.exec(t))return{h:e[1],s:e[2],v:e[3],a:e[4]};if(e=M.hex8.exec(t))return{r:k(e[1]),g:k(e[2]),b:k(e[3]),a:A(e[4]),format:n?"name":"hex8"};if(e=M.hex6.exec(t))return{r:k(e[1]),g:k(e[2]),b:k(e[3]),format:n?"name":"hex"};if(e=M.hex4.exec(t))return{r:k(e[1]+""+e[1]),g:k(e[2]+""+e[2]),b:k(e[3]+""+e[3]),a:A(e[4]+""+e[4]),format:n?"name":"hex8"};if(e=M.hex3.exec(t))return{r:k(e[1]+""+e[1]),g:k(e[2]+""+e[2]),b:k(e[3]+""+e[3]),format:n?"name":"hex"};return!1}(t));"object"==r(t)&&(z(t.r)&&z(t.g)&&z(t.b)?(h=t.r,d=t.g,p=t.b,e={r:255*I(h,255),g:255*I(d,255),b:255*I(p,255)},c=!0,u="%"===String(t.r).substr(-1)?"prgb":"rgb"):z(t.h)&&z(t.s)&&z(t.v)?(s=L(t.s),a=L(t.v),e=function(t,e,n){t=6*I(t,360),e=I(e,100),n=I(n,100);var r=Math.floor(t),i=t-r,o=n*(1-e),s=n*(1-i*e),a=n*(1-(1-i)*e),l=r%6,c=[n,s,o,o,a,n][l],u=[a,n,n,s,o,o][l],h=[o,o,a,n,n,s][l];return{r:255*c,g:255*u,b:255*h}}(t.h,s,a),c=!0,u="hsv"):z(t.h)&&z(t.s)&&z(t.l)&&(s=L(t.s),l=L(t.l),e=function(t,e,n){var r,i,o;function s(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(t=I(t,360),e=I(e,100),n=I(n,100),0===e)r=i=o=n;else{var a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=s(l,a,t+1/3),i=s(l,a,t),o=s(l,a,t-1/3)}return{r:255*r,g:255*i,b:255*o}}(t.h,s,l),c=!0,u="hsl"),t.hasOwnProperty("a")&&(n=t.a));var h,d,p;return n=R(n),{ok:c,format:t.format||u,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:n}}(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function a(t,e,n){t=I(t,255),e=I(e,255),n=I(n,255);var r,i,o=Math.max(t,e,n),s=Math.min(t,e,n),a=(o+s)/2;if(o==s)r=i=0;else{var l=o-s;switch(i=a>.5?l/(2-o-s):l/(o+s),o){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:i,l:a}}function l(t,e,n){t=I(t,255),e=I(e,255),n=I(n,255);var r,i,o=Math.max(t,e,n),s=Math.min(t,e,n),a=o,l=o-s;if(i=0===o?0:l/o,o==s)r=0;else{switch(o){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:i,v:a}}function c(t,e,n,r){var i=[T(Math.round(t).toString(16)),T(Math.round(e).toString(16)),T(Math.round(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function u(t,e,n,r){return[T(C(r)),T(Math.round(t).toString(16)),T(Math.round(e).toString(16)),T(Math.round(n).toString(16))].join("")}function h(t,e){e=0===e?0:e||10;var n=s(t).toHsl();return n.s-=e/100,n.s=O(n.s),s(n)}function d(t,e){e=0===e?0:e||10;var n=s(t).toHsl();return n.s+=e/100,n.s=O(n.s),s(n)}function p(t){return s(t).desaturate(100)}function f(t,e){e=0===e?0:e||10;var n=s(t).toHsl();return n.l+=e/100,n.l=O(n.l),s(n)}function m(t,e){e=0===e?0:e||10;var n=s(t).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-e/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-e/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-e/100*255))),s(n)}function g(t,e){e=0===e?0:e||10;var n=s(t).toHsl();return n.l-=e/100,n.l=O(n.l),s(n)}function y(t,e){var n=s(t).toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,s(n)}function b(t){var e=s(t).toHsl();return e.h=(e.h+180)%360,s(e)}function _(t,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var n=s(t).toHsl(),r=[s(t)],i=360/e,o=1;o<e;o++)r.push(s({h:(n.h+o*i)%360,s:n.s,l:n.l}));return r}function v(t){var e=s(t).toHsl(),n=e.h;return[s(t),s({h:(n+72)%360,s:e.s,l:e.l}),s({h:(n+216)%360,s:e.s,l:e.l})]}function x(t,e,n){e=e||6,n=n||30;var r=s(t).toHsl(),i=360/n,o=[s(t)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,o.push(s(r));return o}function w(t,e){e=e||6;for(var n=s(t).toHsv(),r=n.h,i=n.s,o=n.v,a=[],l=1/e;e--;)a.push(s({h:r,s:i,v:o})),o=(o+l)%1;return a}s.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,r=this.toRgb();return t=r.r/255,e=r.g/255,n=r.b/255,.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=R(t),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var t=l(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=l(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),r=Math.round(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+r+"%)":"hsva("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=a(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=a(this._r,this._g,this._b),e=Math.round(360*t.h),n=Math.round(100*t.s),r=Math.round(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+r+"%)":"hsla("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return c(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,n,r,i){var o=[T(Math.round(t).toString(16)),T(Math.round(e).toString(16)),T(Math.round(n).toString(16)),T(C(r))];if(i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1))return o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0);return o.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*I(this._r,255))+"%",g:Math.round(100*I(this._g,255))+"%",b:Math.round(100*I(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*I(this._r,255))+"%, "+Math.round(100*I(this._g,255))+"%, "+Math.round(100*I(this._b,255))+"%)":"rgba("+Math.round(100*I(this._r,255))+"%, "+Math.round(100*I(this._g,255))+"%, "+Math.round(100*I(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(j[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+u(this._r,this._g,this._b,this._a),n=e,r=this._gradientType?"GradientType = 1, ":"";if(t){var i=s(t);n="#"+u(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,r=this._a<1&&this._a>=0;return e||!r||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return s(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(g,arguments)},desaturate:function(){return this._applyModification(h,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(p,arguments)},spin:function(){return this._applyModification(y,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(x,arguments)},complement:function(){return this._applyCombination(b,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(v,arguments)},triad:function(){return this._applyCombination(_,[3])},tetrad:function(){return this._applyCombination(_,[4])}},s.fromRatio=function(t,e){if("object"==r(t)){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]="a"===i?t[i]:L(t[i]));t=n}return s(t,e)},s.equals=function(t,e){return!(!t||!e)&&s(t).toRgbString()==s(e).toRgbString()},s.random=function(){return s.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},s.mix=function(t,e,n){n=0===n?0:n||50;var r=s(t).toRgb(),i=s(e).toRgb(),o=n/100;return s({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},s.readability=function(t,e){var n=s(t),r=s(e);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)},s.isReadable=function(t,e,n){var r,i,o=s.readability(t,e);switch(i=!1,(r=function(t){var e,n;e=((t=t||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(t.size||"small").toLowerCase(),"AA"!==e&&"AAA"!==e&&(e="AA");"small"!==n&&"large"!==n&&(n="small");return{level:e,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},s.mostReadable=function(t,e,n){var r,i,o,a,l=null,c=0;i=(n=n||{}).includeFallbackColors,o=n.level,a=n.size;for(var u=0;u<e.length;u++)(r=s.readability(t,e[u]))>c&&(c=r,l=s(e[u]));return s.isReadable(t,l,{level:o,size:a})||!i?l:(n.includeFallbackColors=!1,s.mostReadable(t,["#fff","#000"],n))};var S=s.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},j=s.hexNames=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(S);function R(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function I(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=Math.min(e,Math.max(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function O(t){return Math.min(1,Math.max(0,t))}function k(t){return parseInt(t,16)}function T(t){return 1==t.length?"0"+t:""+t}function L(t){return t<=1&&(t=100*t+"%"),t}function C(t){return Math.round(255*parseFloat(t)).toString(16)}function A(t){return k(t)/255}var D,P,E,M=(P="[\\s|\\(]+("+(D="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+D+")[,|\\s]+("+D+")\\s*\\)?",E="[\\s|\\(]+("+D+")[,|\\s]+("+D+")[,|\\s]+("+D+")[,|\\s]+("+D+")\\s*\\)?",{CSS_UNIT:new RegExp(D),rgb:new RegExp("rgb"+P),rgba:new RegExp("rgba"+E),hsl:new RegExp("hsl"+P),hsla:new RegExp("hsla"+E),hsv:new RegExp("hsv"+P),hsva:new RegExp("hsva"+E),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function z(t){return!!M.CSS_UNIT.exec(t)}}}]);