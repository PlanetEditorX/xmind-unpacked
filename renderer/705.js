"use strict";(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[705],{3236:(e,t,i)=>{i.d(t,{yh:()=>r,dM:()=>h,I6:()=>p,zF:()=>c,Y$:()=>l.Y});var o=i(1403),n=i(78598),l=i(12645);class s{constructor(){this.eventCallbacks=new Map}on(e,t){var i;const o=null!==(i=this.eventCallbacks.get(e))&&void 0!==i?i:[];this.eventCallbacks.set(e,[...o,t])}off(e,t){var i;let o=null!==(i=this.eventCallbacks.get(e))&&void 0!==i?i:[];o=o.filter((e=>e!==t)),this.eventCallbacks.set(e,o)}emit(e){const t=this.eventCallbacks.get(e.eventName);if(t)for(const i of t)i(e)}unload(){this.eventCallbacks=new Map}}class r extends s{constructor(e){var t;super(),this._presenters=[],this._isStarted=!1,this._disableSettingsUpdate=!1,this._traveledTopicSet=new Set,this._needSubscriptionHint=!1,this.slideControl=async e=>{const{action:t,value:i}=e;switch(t){case"goto":return await this.slideshow.present(i);case"next":return await this.slideshow.forward();case"prev":return await this.slideshow.backward();case"fastBackward":return await this.slideshow.fastBackward();case"fastForward":return await this.slideshow.fastForward();case"updateSlide":return await this.slideshow.forceUpdateSlideContent()}},this.changeSlideSetting=e=>{const{action:t,option:i}=e;switch(t){case"theme":return this.changeTheme(i);case"aspect":return this.changeSlideAspect(i);case"animation":return this.switchAnimationOption(i);case"watermark":return this.switchWatermarkOption(i)}},this.unloaded=!1,this.settings=(0,l.Y)(),this._startTopicId=null!==(t=e.startTopicId)&&void 0!==t?t:null,this._suggestedSlideSize=e.suggestedSlideSize,this._disableSettingsUpdate=e.disableSettingsUpdate,this._needSubscriptionHint=!!e.needSubscriptionHint,this.initSlideshow(e)}get presenters(){return this._presenters}get slideshow(){return this._slideshow}get isShowingEnding(){return this._slideshow.isShowingEndingScreen}get currentSlide(){return this.slideshow.currentSlide}initSlideshow(e){var t,i,l,s;const r=e.contentProviderData?(0,n.xm)(e.contentProviderData):(0,n.n2)(),a=null!==(t=e.defaultAspect)&&void 0!==t?t:this.settings.slideAspect.value,d="Auto"===a?null!==(l=null===(i=e.suggestedSlideSize)||void 0===i?void 0:i.value)&&void 0!==l?l:"16:9":a;this._slideshow=new o.ur({contentProvider:r,slideTheme:null!==(s=e.defaultSlideTheme)&&void 0!==s?s:this.settings.slideTheme.value,slideSize:d,disablesWatermark:!this.settings.watermarkEnabled.value,preferredLanguage:this.settings.preferredLanguage.value}),this._slideshow.disablesAnimations=!this.settings.animationEnabled.value,this._slideshow.on("finish",(()=>this.finish())),this._slideshow.on("stateDidChange",(()=>{this.presenters.forEach((e=>e.stateChangedHandler()))})),this._slideshow.on("transitionStart",(({request:e})=>{const t=this._slideshow.computeNextStoppedSlide(e);t&&(this._traveledTopicSet.add(t),this._needSubscriptionHint&&this._traveledTopicSet.size>5&&this.emit({eventName:"needSubscription"})),this.emit({eventName:"slideChangeStart",payload:{request:e,targetSlide:t}})})),this._slideshow.on("transitionEnd",(()=>this.emit({eventName:"slideChangeEnd"}))),this._slideshow.on("modalOpened",(()=>this.emit({eventName:"presenterModal",payload:{show:!0}}))),this._slideshow.on("modalClosed",(()=>this.emit({eventName:"presenterModal",payload:{show:!1}}))),this._slideshow.on("reveal",(({request:e})=>this.emit({eventName:"presenterLinkClick",payload:{title:e.title,href:e.href,topicId:e.topicId}}))),this._slideshow.on("playWebVideo",(({request:e})=>{this.emit({eventName:"playWebVideo",payload:{videoSource:e.videoSource}})}))}addPresenter(e){this._presenters.includes(e)||(this._presenters.push(e),this.slideshow.addPresenter(e.view))}removePresenter(e){this._presenters=this._presenters.filter((t=>t!==e)),this.slideshow.removePresenter(e.view)}switchAnimationOption(e){var t;this.slideshow.disablesAnimations=!e,!this._disableSettingsUpdate&&(null===(t=this.settings)||void 0===t||t.updateAnimationSetting(e))}switchWatermarkOption(e){var t;this.slideshow.disablesWatermark!==!e&&(this.slideshow.changeWatermarkDisabled(!e),!this._disableSettingsUpdate&&(null===(t=this.settings)||void 0===t||t.updateWatermarkSetting(e)))}changeTheme(e){var t;this.slideshow.slideAppearanceId!==e&&(this.slideshow.changeSlideTheme(e),!this._disableSettingsUpdate&&(null===(t=this.settings)||void 0===t||t.updateSlideThemeSetting(e)))}changeSlideAspect(e){var t,i,n;const l="Auto"===e?null!==(i=null===(t=this._suggestedSlideSize)||void 0===t?void 0:t.value)&&void 0!==i?i:"16:9":e;this.slideshow.changeSlideSize(o.IE[l]),!this._disableSettingsUpdate&&(null===(n=this.settings)||void 0===n||n.updateSlideAspectSetting(e))}async start(e){this._isStarted||(e.forEach((e=>this.addPresenter(e))),this.slideshow.present(this._startTopicId),this._isStarted=!0)}finish(){this.emit({eventName:"slidePlayFinished"})}unload(){this.emit({eventName:"beforeUnload"}),super.unload(),this.unloaded=!0}}var a=i(90435),d=i(96829),u=i(54856);function c(){const e=(0,d.hb)(),t=a.ZP.route(u.OV.CONNECT_MAIN(e),(async e=>{switch(e.type){case"retrieveContent":return JSON.stringify(await(0,n.d4)());case"dismiss":return t();case"openHyperlink":return null}}));return e}async function p(e){const t=await a.ZP.fetch(u.OV.CONNECT_MAIN(e),{type:"retrieveContent"});return JSON.parse(t)}function h(e){a.ZP.fetch(u.OV.CONNECT_MAIN(e),{type:"dismiss"})}},12645:(e,t,i)=>{i.d(t,{Y:()=>u});var o=i(2954),n=i(87141),l=i(84374),s=i(31945),r=i(78598);function a(e){var t,i;return null!==(i=null===(t=(0,r.pP)(e))||void 0===t?void 0:t["slide-appearance"])&&void 0!==i?i:"default"}function d(e){var t,i;return null!==(i=null===(t=(0,r.pP)(e))||void 0===t?void 0:t["slide-aspect-ratio"])&&void 0!==i?i:"Auto"}const u=function(){const{activeSheet:e}=(0,l.nZ)(),t=(0,o.Fl)((()=>{var t;return null===(t=e.value)||void 0===t?void 0:t.rootTopic.id})),i=(0,n.OD)((0,s.aJ)(window.editorId)),u=(0,o.Fl)((()=>i().contexts["activation.isValid"])),c=(0,o.Fl)((()=>!(0,n.rs)().disableAnimation)),p=(0,o.Fl)((()=>!u.value||(0,n.rs)().watermarkEnabled)),h=(0,o.iH)(d(t.value)),v=(0,o.iH)(a(t.value)),F=(0,o.Fl)((()=>"zh-CN"===(0,n.S)().language||"zh-CN"===(0,n.S)().defaultLanguage?"zh":"en")),m=e=>{(0,n.rs)().updateSettings({disableAnimation:!e})},C=e=>{(0,n.rs)().updateSettings({watermarkEnabled:e})},g=e=>{e!==a(t.value)&&((0,r.nh)(t.value,{"slide-appearance":e}),v.value=e)},w=e=>{e!==d(t.value)&&((0,r.nh)(t.value,{"slide-aspect-ratio":e}),h.value=e)};return(0,o.YP)((()=>t.value),(e=>{h.value=d(e),v.value=a(e)})),()=>({animationEnabled:c,watermarkEnabled:p,slideTheme:(0,o.Fl)((()=>v.value)),slideAspect:(0,o.Fl)((()=>h.value)),preferredLanguage:F,updateAnimationSetting:m,updateWatermarkSetting:C,updateSlideThemeSetting:g,updateSlideAspectSetting:w})}()},1403:(e,t,i)=>{i.d(t,{CU:()=>r,YN:()=>a,ur:()=>o.Slideshow,I2:()=>o.SlideshowExporter,rc:()=>v,qV:()=>h,WS:()=>p,bh:()=>u,sz:()=>d,_y:()=>c,_p:()=>o.previewSlidesScopedBy,IE:()=>o.slideSizes,hf:()=>F,tT:()=>s});var o=i(32118),n=i(78598);const l={summarySlideVisibility:"summary-slide-visibility",topicSlideVisibility:"topic-slide-visibility",topicImagePlacement:"topic-slide-image-placement",listSlideVisibility:"list-slide-visibility",listSlideDelivery:"list-slide-delivery",listSlideLayout:"list-slide-layout"};function s(){const e=(e,t,i)=>(0,n.nh)(e,{[l[t]]:i});return{getSlideOption:(e,t)=>{var i;return null===(i=(0,n.pP)(e))||void 0===i?void 0:i[l[t]]},setSlideOption:e,deleteSlideOption:(t,i)=>e(t,i)}}const r="org.xmind.ui.ice-cream-pancake",a=["Auto","16:9","4:3","9:16","3:4"];function d(e){return new o.Slideshow(e)}function u(e={}){const{initialSlide:t,perspectiveMode:i,viewStyle:n,contentStyle:l}=e,s=new o.PresentationView({initialSlide:t});return i?(s.allowsActivatingPresenterPerspectiveMode=!0,s.mode="presenterPerspective"):(s.allowsActivatingPresenterPerspectiveMode=!1,s.mode="presentation"),n&&Object.keys(n).forEach((e=>s.el.style[e]=n[e])),l&&Object.keys(l).forEach((e=>s.contentEl.style[e]=l[e])),s}function c(e,t,i){return{topicSkipped:(0,o.isSlideSkippedScopedBy)(e,t,"topic",{ignoresUserValue:i}),listSkipped:(0,o.isSlideSkippedScopedBy)(e,t,"list",{ignoresUserValue:i}),summarySkipped:(0,o.isSlideSkippedScopedBy)(e,t,"summary",{ignoresUserValue:i})}}function p(e,t){const i=(0,o.computeSlideContent)(t,e.contentProvider,e.defaultListSlideDelivery);return i&&i.topic.image?(0,o.computeTopicSlideImagePlacement)(e.slideSize,i,i.topic.image,{ignoresUserValue:!0}):null}function h(e,t){return(0,o.computeSlideLayout)("list",e.slideSize,e.getSlideContent(t))}function v(e,t){return(0,o.getEligibleSlideLayouts)("list",e.getSlideContent(t))}function F(e,t){const i=e.getSlideContent(t.topicId).computedListSlideDelivery;let o=[];if("list"===t.type&&"all-at-once"===i&&(o=[...o,...t.subtopics||[]]),t.boxes){const e=i=>{for(const n of i){if((n.id.startsWith("topic:title:")||n.id.startsWith("topic:image:"))&&n.opacity){const e=n.id.split(":")[2];t.subtopics.includes(e)&&o.push(n.id.split(":")[2])}"children"in n&&e(n.children)}};e(t.boxes)}const n=t.topicId,l=[...new Set(o)].filter((e=>e!==n));return{topicId:n,subTopicIds:l}}},45133:(e,t,i)=>{i.d(t,{yh:()=>o.yh,Nn:()=>p,c4:()=>h,XT:()=>F.XT,iA:()=>F.iA,vN:()=>v,dM:()=>o.dM,HZ:()=>g,Su:()=>S,I6:()=>o.I6,zF:()=>o.zF,Y$:()=>o.Y$,_x:()=>F._x});var o=i(3236),n=i(90435),l=i(2954),s=i(1403),r=i(54856);const a=(0,i(23352).ZP)("pitchmode");class d{async sendMessage(e,t){try{return await n.ZP.fetch(r.OV.SUB_COMMAND(this.proxyId),{command:e,payload:t})}catch(e){return a.warn("SendMessage: ",e),e}}async performTransition(e){await this.sendMessage("performTransition",e)}async performStateChange(e,t){await this.sendMessage("performStateChange",{state:e,animationOptions:t})}preloadTransition(e){this.sendMessage("preloadTransition",e)}async presentEndingScreen(e,t,i,o,n){this.sendMessage("presentEndingscreen",{content:e,slideSize:t,epilogueSlide:i,backgroundColor:o,options:n})}async dismissEndingScreen(e){this.sendMessage("dismissEndingscreen",e)}async presentModalDisplay(e,t){this.sendMessage("presentModalDisplay",{options:e,boxId:t})}async dismissModalDisplay(e){this.sendMessage("dismissModalDisplay",{contentType:e})}constructor(e){this.proxyId=e}unload(){}}var u=i(96829);class c{constructor(){this.ready=(0,l.iH)(!1),this.isProxiedPresenter=!1,this._id=(0,u.hb)()}get id(){return this._id}get isReady(){return this.ready.value}setReady(){this.ready.value=!0}async init(){}stateChangedHandler(){}unload(){}}class p extends c{constructor(e){var t;super(),this._containerEle=null,this.presentationViewOptions=e.presentationViewOptions,this.isShowingPerspective=(0,l.iH)(!1),this.isEnablePerspective=!!(null===(t=e.presentationViewOptions)||void 0===t?void 0:t.perspectiveMode)}get view(){return this._presentationView}get container(){return this._containerEle}get viewEle(){return this._presentationView.el}async init(){this.createPresentationView(this.presentationViewOptions),this.setReady()}createPresentationView(e){this._presentationView=(0,s.bh)({initialSlide:e.initialSlide,perspectiveMode:e.perspectiveMode,viewStyle:{left:"0",right:"0",width:"100%",height:"100%",backgroundColor:"#000000"},contentStyle:{backgroundColor:"#000000"}})}update(){this._presentationView.update()}connect(){this._presentationView.connect()}stateChangedHandler(){this.isEnablePerspective&&(this.isShowingPerspective.value="presenterPerspective"===this.view.mode)}setContainer(e){this._containerEle||(this._containerEle=e,this._containerEle.appendChild(this.viewEle),this.update(),this.connect())}unload(){var e;null===(e=this._containerEle)||void 0===e||e.removeChild(this.viewEle),this._containerEle=null}}class h extends c{constructor(e){super(),this.isProxy=!0,this._unRoute=[],this.presentationViewOptions=e.presentationViewOptions}get view(){return this._proxyView}async init(){return this.createPresentationProxyView(this.id),await this.connectProxiedPresenter()}createPresentationProxyView(e){this._proxyView=new d(e)}connectProxiedPresenter(){const e=window.id;return this._unRoute.push(n.ZP.route(r.OV.CONNECT_MAIN(e),(()=>(setTimeout((()=>{this.setReady()}),50),{presentationViewOptions:this.presentationViewOptions,proxyId:this.id})))),new Promise((e=>{const t=(0,l.YP)((()=>this.ready.value),(i=>{i&&(e(),t())}))}))}unload(){this._unRoute.forEach((e=>e()))}}class v extends p{constructor(e){super({}),this.isProxiedPresenter=!0,this.remoteWindowId=e}async init(){await this.connectProxy(),this.setReady()}async connectProxy(){const e=async()=>await Promise.race([n.ZP.fetch(r.OV.CONNECT_MAIN(this.remoteWindowId)),new Promise((e=>setTimeout(e,1e3)))])||await e(),t=await e();var i,o;this.createPresentationView(t.presentationViewOptions),i=this._presentationView,o=t.proxyId,n.ZP.route(r.OV.SUB_COMMAND(o),(e=>{switch(e.command){case"performTransition":return i.performTransition(e.payload);case"performStateChange":return i.performStateChange(e.payload.state,e.payload.animationOptions);case"preloadTransition":return i.preloadTransition(e.payload);case"presentEndingscreen":return i.presentEndingScreen(e.payload.content,e.payload.slideSize,e.payload.epilogueSlide,e.payload.backgroundColor,e.payload.options);case"dismissEndingscreen":return i.dismissEndingScreen(e.payload);case"presentModalDisplay":return i.presentModalDisplay(e.payload.options,e.payload.boxId);case"dismissModalDisplay":return i.dismissModalDisplay(e.payload.contentType)}}))}}var F=i(58510),m=i(53775),C=i(12645);function g(e,t){const i=t=>{(function(e,t){const i=(0,m.Ds)(e.slideControl,100),{animationEnabled:o}=(0,C.Y)();switch(t.key){case"PageDown":case"ArrowDown":case"Enter":case" ":return i({action:"next"}),!0;case"ArrowRight":return t.shiftKey?i({action:"fastForward"}):i({action:"next"}),!0;case"PageUp":case"ArrowUp":return i({action:"prev"}),!0;case"ArrowLeft":return t.shiftKey?i({action:"fastBackward"}):i({action:"prev"}),!0;case"Escape":case"q":case"Q":return e.finish(),!0;case"a":case"A":return e.switchAnimationOption(!o.value),!0}return!1})(e,t)&&(t.preventDefault(),t.stopPropagation())};return t.addEventListener("keydown",i),e.on("beforeUnload",(()=>{t.removeEventListener("keydown",i)})),e}var w=i(87141);function S(e,t){return e.on("playWebVideo",(({payload:e})=>{var i,o,n;const l=null!==(o=null===(i=null==t?void 0:t.subWindow)||void 0===i?void 0:i.getBounds())&&void 0!==o?o:null===(n=null==t?void 0:t.mainWindow)||void 0===n?void 0:n.getBounds(),s=l?{...l,fullscreen:!0}:null;!function(e){const{handleCommand:t}=(0,w.JX)(),{videoSource:i,overrideSetting:o}=e;i&&t("videoViewer",{url:i,overrideSetting:o})}({videoSource:e.videoSource,overrideSetting:s})})),e}},78598:(e,t,i)=>{i.d(t,{xm:()=>h,pP:()=>v,n2:()=>c,d4:()=>p,nh:()=>F});var o=i(2954),n=i(1403),l=i(40623),s=i(84374);const{TopicQuickStyleClassName:r,PrimaryClassName:a,TopicPrimaryClassName:d}=s.viewerKit,u=Object.freeze({default:{[a.Map]:{fillColor:"#101010",multiLineColors:["#F6F6F6"].join(" ")},[a.Relationship]:{lineColor:"#F6F6F6",textColor:"#FFFFFF"},[a.Boundary]:{fillColor:"#F6F6F6",textColor:"#000000"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#F6F6F6",textColor:"#000000"},[d.MainTopic]:{fillColor:"#E3E3E3",textColor:"#000000"},[d.Subtopic]:{fillColor:"#B9B9B9",textColor:"#000000"},[d.FloatingTopic]:{fillColor:"#BABABA",textColor:"#000000"},[d.CalloutTopic]:{fillColor:"#F6F6F6",textColor:"#000000"},[d.SummaryTopic]:{fillColor:"#F6F6F6",textColor:"#000000"},[r.VeryImportant]:{fillColor:"#A43838"},[r.Important]:{fillColor:"#CFA362",textColor:"#000000"},[r.CrossOut]:{}},light:{[a.Map]:{fillColor:"#F4F4F4",multiLineColors:["#282828"].join(" ")},[a.Relationship]:{lineColor:"#282828",textColor:"#000000"},[a.Boundary]:{fillColor:"#282828",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[d.MainTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[d.Subtopic]:{fillColor:"#4F4F4F",textColor:"#FFFFFF"},[d.FloatingTopic]:{fillColor:"#4F4F4F",textColor:"#FFFFFF"},[d.CalloutTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[d.SummaryTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[r.VeryImportant]:{fillColor:"#A43838"},[r.Important]:{fillColor:"#CFA362",textColor:"#000000"},[r.CrossOut]:{}},Innocence:{[a.Map]:{fillColor:"#ECF4E9",multiLineColors:["#FF9A9A","#F9E168","#FFC368","#ACDB87","#749AC7","#FF9A9A"].join(" ")},[a.Relationship]:{lineColor:"#F06767",textColor:"#F7FFF4"},[a.Boundary]:{fillColor:"#F06767",textColor:"#F7FFF4"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#F06767"},[d.MainTopic]:{textColor:"#000000"},[d.Subtopic]:{textColor:"#000000"},[d.FloatingTopic]:{fillColor:"#797979",textColor:"#F7FFF4"},[d.CalloutTopic]:{fillColor:"#F06767",textColor:"#F7FFF4"},[d.SummaryTopic]:{fillColor:"#F06767",textColor:"#000000"},[r.VeryImportant]:{fillColor:"#1000C6"},[r.Important]:{fillColor:"#22D896",textColor:"#000000"},[r.CrossOut]:{}},"Hubble-Bubble":{[a.Map]:{fillColor:"#1D663A",multiLineColors:"#A2B864"},[a.Relationship]:{lineColor:"#A2B864",textColor:"#FEFFD0"},[a.Boundary]:{fillColor:"#A2B864",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#39B169",textColor:"#FEFFD0"},[d.MainTopic]:{fillColor:"#39B169",textColor:"#FEFFD0"},[d.Subtopic]:{fillColor:"#2E9356",textColor:"#FEFFD0"},[d.FloatingTopic]:{fillColor:"#A2B864",textColor:"#1D663A"},[d.CalloutTopic]:{fillColor:"#FEFFD0",textColor:"#000000"},[d.SummaryTopic]:{fillColor:"#A2B864",textColor:"#1D663A"},[r.VeryImportant]:{fillColor:"#FA813D",textColor:"#000000"},[r.Important]:{fillColor:"#ECDE5D",textColor:"#000000"},[r.CrossOut]:{}},"midnight-rose":{[a.Map]:{fillColor:"#010518",multiLineColors:"#9EAEFF"},[a.Relationship]:{lineColor:"#2C47D8",textColor:"#FFFFFF"},[a.Boundary]:{fillColor:"#2C47D8",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#2C47D8",textColor:"#FFFFFF"},[d.MainTopic]:{fillColor:"#2C47D8",textColor:"#FFFFFF"},[d.Subtopic]:{fillColor:"#3E4C95",textColor:"#FFFFFF"},[d.FloatingTopic]:{fillColor:"#DEE3FF",textColor:"#404E9C"},[d.CalloutTopic]:{fillColor:"#FEFFD0",textColor:"#404E9C"},[d.SummaryTopic]:{fillColor:"#9EAEFF",textColor:"#404E9C"},[r.VeryImportant]:{fillColor:"#A716CB",textColor:"#000000"},[r.Important]:{fillColor:"#D45757",textColor:"#000000"},[r.CrossOut]:{}},"shape-for-you":{[a.Map]:{fillColor:"#F5D8DD",multiLineColors:["#EDB998","#BEADA6","#E994B1","#ACBCD6","#B1ABD6","#B0CD99","#97D6C3","#BDB783"].join(" ")},[a.Relationship]:{lineColor:"#E59294",textColor:"#000000"},[a.Boundary]:{fillColor:"#E59294",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#E59294",textColor:"#000000"},[d.MainTopic]:{fillColor:"#E59294",textColor:"#000000"},[d.Subtopic]:{fillColor:"#E59294",textColor:"#000000"},[d.FloatingTopic]:{fillColor:"#4B4B4B",textColor:"#FFFFFF"},[d.CalloutTopic]:{fillColor:"#E59294",textColor:"#000000"},[d.SummaryTopic]:{fillColor:"#E59294",textColor:"#000000"},[r.VeryImportant]:{fillColor:"#50209E",textColor:"#000000"},[r.Important]:{fillColor:"#D45757",textColor:"#62A8CF"},[r.CrossOut]:{}},"hand-drawn":{[a.Map]:{fillColor:"#DCE2D4",multiLineColors:"#2F4DB5"},[a.Relationship]:{lineColor:"#2F4DB5",textColor:"#2F4DB5"},[a.Boundary]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[d.MainTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[d.Subtopic]:{fillColor:"#5E6AA2",textColor:"#FFFFFF"},[d.FloatingTopic]:{fillColor:"#5A5E74",textColor:"#EDF4E5"},[d.CalloutTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[d.SummaryTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[r.VeryImportant]:{fillColor:"#9433AC",textColor:"#FFFFFF"},[r.Important]:{fillColor:"#D05252",textColor:"#FFFFFF"},[r.CrossOut]:{}}});function c(e){const{sheets:t,activeSheetId:i,getSheetViewer:n}=(0,s.nZ)(),l=(0,o.Fl)((()=>t.value.find((t=>t.id===(null!=e?e:i.value))))),r=(0,o.Fl)((()=>n(l.value.id)));return{getStartingTopicId:()=>{var e,t,i;return null!==(i=null===(t=null===(e=l.value)||void 0===e?void 0:e.rootTopic)||void 0===t?void 0:t.id)&&void 0!==i?i:null},getTopicAttributes:e=>{var t,i,o,n,s,a,d,u,c,p,h;const F=null===(i=null===(t=l.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic(),f=null===(n=null===(o=r.value)||void 0===o?void 0:o.getSheetFigure())||void 0===n?void 0:n.topicFigureByTopicId[e],y=v(e);return F&&{id:null==F?void 0:F.id,title:null!==(s=null==F?void 0:F.title)&&void 0!==s?s:"",labels:null!==(a=null==F?void 0:F.labels)&&void 0!==a?a:[],note:(null==F?void 0:F.notes)&&{plainText:null===(d=F.notes)||void 0===d?void 0:d.text,html:null===(u=F.notes)||void 0===u?void 0:u.html},image:C(f),summaries:null===(c=null==F?void 0:F.summaries)||void 0===c?void 0:c.map((e=>({topicId:e.id,startIndex:e.rangeStart,endIndex:e.rangeEnd}))),markers:m(null!==(p=null==F?void 0:F.markers)&&void 0!==p?p:[]),video:g(f),calloutTopicId:null===(h=null==F?void 0:F.callout)||void 0===h?void 0:h.id,hyperlink:w(F),topicSlide:null==y?void 0:y["topic-slide-visibility"],topicSlideImagePlacement:null==y?void 0:y["topic-slide-image-placement"],listSlides:null==y?void 0:y["list-slide-visibility"],listSlideLayout:null==y?void 0:y["list-slide-layout"],listSlideDelivery:null==y?void 0:y["list-slide-delivery"],summarySlide:null==y?void 0:y["summary-slide-visibility"],preferredDefaultListSlideLayout:S(f)}},getSubtopics:e=>{var t,i,o,n;const s=null===(i=null===(t=l.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic();return null!==(n=null===(o=null==s?void 0:s.children)||void 0===o?void 0:o.map((e=>e.id)))&&void 0!==n?n:[]},getParentTopicId:e=>{var t,i,o,n;const s=null===(i=null===(t=l.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic();return null!==(n=null===(o=null==s?void 0:s.parentTopic)||void 0===o?void 0:o.id)&&void 0!==n?n:null},getFloatingTopics:()=>{var e,t,i;return null!==(i=null===(t=null===(e=l.value)||void 0===e?void 0:e.rootTopic)||void 0===t?void 0:t.detachedChildren.map((e=>e.id)))&&void 0!==i?i:[]},getEndingScreenContent:async e=>{var t,i,o,n,s,a,d,c;const p=null!==(s=null!==(t=null==e?void 0:e.appearance)&&void 0!==t?t:null===(n=v(null===(o=null===(i=l.value)||void 0===i?void 0:i.rootTopic)||void 0===o?void 0:o.id))||void 0===n?void 0:n["slide-appearance"])&&void 0!==s?s:"default",{svg:h,size:F}=await r.value.exportSVGElementWithSizeUsingSheetAppearance(l.value,null!==(a=u[p])&&void 0!==a?a:u.default,{padding:{left:20,right:20,top:20,bottom:20},disableEmbedFonts:!0});return{svgString:(new XMLSerializer).serializeToString(h),width:null!==(d=F.width)&&void 0!==d?d:parseInt(h.getAttribute("width")),height:null!==(c=F.height)&&void 0!==c?c:parseInt(h.getAttribute("height"))}}}}async function p(){const e=c(),t=e.getStartingTopicId(),i=e.getFloatingTopics(),o=[t,...i],n=t=>{const i=t.map((t=>e.getSubtopics(t))).flat();o.push(...i),i.length<=0||n(i)};n(o);const l={},s={},r={};o.forEach((t=>{l[t]=e.getTopicAttributes(t),s[t]=e.getParentTopicId(t),r[t]=e.getSubtopics(t)}));const a=await e.getEndingScreenContent(void 0);return{startingTopicId:t,floatingTopicIds:i,topicRecords:l,parentRecords:s,subTopicsRecords:r,endingScreenContent:a}}function h(e){const{startingTopicId:t,floatingTopicIds:i,topicRecords:o,subTopicsRecords:n,parentRecords:l,endingScreenContent:s}=e;return{getStartingTopicId:()=>t,getTopicAttributes:e=>{var t;return null!==(t=o[e])&&void 0!==t?t:null},getSubtopics:e=>{var t;return null!==(t=n[e])&&void 0!==t?t:[]},getParentTopicId:e=>{var t;return null!==(t=l[e])&&void 0!==t?t:null},getFloatingTopics:()=>i,getEndingScreenContent:async()=>s}}function v(e){var t,i,o;const{document:l}=(0,s.nZ)(),r=null===(i=null===(t=l.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic(),a=null==r?void 0:r.extensionBy(n.CU);return null!==(o=null==a?void 0:a.content)&&void 0!==o?o:null}function F(e,t){var i,o,l,r,a;const{document:d,changeDoc:u}=(0,s.nZ)(),c=null===(o=null===(i=d.value)||void 0===i?void 0:i.query({id:e}))||void 0===o?void 0:o.asTopic(),p={content:{...null!==(r=null===(l=null==c?void 0:c.extensionBy(n.CU))||void 0===l?void 0:l.content)&&void 0!==r?r:{},...t}},h=null===(a=null==c?void 0:c.asMutable())||void 0===a?void 0:a.extensionBy(n.CU,p).commit().ownerDocument;h&&u(h)}function m(e){const{markerModule:t}=(0,s.nZ)();return e.map((e=>({markerId:e,imageSource:t.getMarkerInfoById(e).imageSrc}))).filter((e=>!!e.imageSource))}function C(e){var t,i,o,n,l;if(!e)return null;const{imageView:r,measuredImageView:a,imageNaturalSize:d}=e.nodeContent,u=null==e?void 0:e.modelAttributes,c=null===(t=null==u?void 0:u.equation)||void 0===t?void 0:t.text;if(c)return function(e){var t,i;const o=(null!==(t=(0,s.nZ)().makeMathJaxSVG(e))&&void 0!==t?t:"").replace(/currentColor/g,"");if(!o)return null;const n=null===(i=(new DOMParser).parseFromString(o,"image/svg+xml"))||void 0===i?void 0:i.documentElement;return n?{source:o,size:{width:parseInt(n.getAttribute("width")),height:parseInt(n.getAttribute("height"))}}:null}(c);{const e=null!==(o=null!==(i=null==d?void 0:d.width)&&void 0!==i?i:null==a?void 0:a.width)&&void 0!==o?o:null==u?void 0:u.imageWidth,t=null!==(l=null!==(n=null==d?void 0:d.height)&&void 0!==n?n:null==a?void 0:a.height)&&void 0!==l?l:null==u?void 0:u.imageHeight,s=null==r?void 0:r.src;return e&&t&&s?{source:s,size:{width:e,height:t}}:null}}function g(e){var t,i;const o=null===(i=null===(t=null==e?void 0:e.modelAttributes)||void 0===t?void 0:t.webVideo)||void 0===i?void 0:i.embedUrl;return o?{videoSource:o}:null}function w(e){const t=null==e?void 0:e.href;if(!t)return null;const i=t&&function(e){return e.toLowerCase().startsWith("xap:resources")?"attachment":e.toLowerCase().startsWith("file:")?"local":e.toLowerCase().startsWith("xmind:")?null:"webpage"}(t);return t&&i?{href:t,type:i}:null}function S(e){var t,i;const o=null!==(i=null===(t=null==e?void 0:e.modelAttributes)||void 0===t?void 0:t.structureClass)&&void 0!==i?i:null;return[l.vP.FISHBONELEFTHEADED,l.vP.FISHBONERIGHTHEADED].includes(o)?"fishbone":[l.vP.TIMELINEHORIZONTAL,l.vP.TIMELINESIDEDHORIZONTAL,l.vP.TIMELINETHROUGHVERTICAL].includes(o)?"timeline":null}},58510:(e,t,i)=>{i.d(t,{Ur:()=>h,XT:()=>u,_x:()=>p,iA:()=>c});var o=i(67657),n=i(90435),l=i(54856),s=i(82361),r=i(1403),a=i(53775);const d=o.screen,u={AFTER_SUB_WINDOW_CREATED:"pitch:afterSubWindowCreated",AFTER_SUB_WINDOW_REMOVED:"pitch:afterSubWindowRemoved",ON_DISPLAY_ADDED:"pitch:onDisplayAdded",ON_DISPLAY_REMOVED:"pitch:onDisplayRemoved",ON_MAIN_WINDOW_ENTER_FULLSCREEN:"pitch:onMainWindowEnterFullScreen",ON_MAIN_WINDOW_LEAVE_FULLSCREEN:"pitch:onMainWindowLeaveFullScreen"};class c extends s.EventEmitter{constructor(){super(),this.mainWindowId=window.id,this.subWindowId=null,this.subWindowDisplayId=null,this.win=o.getCurrentWindow(),this._windowFittedSlideSize={},this.onDisplayAdded=async()=>{await new Promise((e=>setTimeout(e,1e3))),this.emit(u.ON_DISPLAY_ADDED)},this.onDisplayRemoved=()=>{d.getAllDisplays().map((e=>e.id)).includes(this.subWindowDisplayId)||this.closeSubWindow(),this.emit(u.ON_DISPLAY_REMOVED)},this.onMainWindowEnterFullScreen=()=>{this.emit(u.ON_MAIN_WINDOW_ENTER_FULLSCREEN)},this.onMainWindowLeaveFullScreen=()=>{this.emit(u.ON_MAIN_WINDOW_LEAVE_FULLSCREEN)},d.on("display-added",this.onDisplayAdded),d.on("display-removed",this.onDisplayRemoved),this.win.on("enter-full-screen",this.onMainWindowEnterFullScreen),this.win.on("leave-full-screen",this.onMainWindowLeaveFullScreen)}get subWindowCreated(){return null!==this.subWindowId}get mainWindow(){return this.win}get subWindow(){var e;return this.subWindowId&&(null===(e=o.BrowserWindow)||void 0===e?void 0:e.fromId(this.subWindowId))}get windowFittedSlideSize(){var e,t,i;const o=null!==(i=null===(t=null===(e=this.subWindow)||void 0===e?void 0:e.getContentSize)||void 0===t?void 0:t.call(e))&&void 0!==i?i:this.win.getContentSize();return this._windowFittedSlideSize.value=h(o),this._windowFittedSlideSize}async createSubWindow(){var e;if(this.subWindowCreated)return!1;const t=this.getSubWindowDisplay();if(!t)return!1;const i=await n.ZP.fetch(l.Fx,{name:"presentation",query:{remoteId:this.mainWindowId},backgroundThrottling:!1,overrideSetting:{x:t.bounds.x,y:t.bounds.y,fullscreen:!0,focusable:!1,backgroundColor:"#000000"}});return this.subWindowDisplayId=t.id,this.subWindowId=i.id,null===(e=this.subWindow)||void 0===e||e.on("focus",(()=>this.focusMainWindow())),this.emit(u.AFTER_SUB_WINDOW_CREATED,this.subWindowId),!0}getSubWindowDisplay(){const e=d.getDisplayMatching(o.getCurrentWindow().getBounds());return d.getAllDisplays().filter((t=>t.id!==e.id))[0]||null}closeSubWindow(){var e;this.subWindowId&&(null===(e=this.subWindow)||void 0===e||e.close(),this.subWindowId=null,this.subWindowDisplayId=null,this.emit(u.AFTER_SUB_WINDOW_REMOVED))}async enterFullscreen(e){return await n.ZP.fetch(l.IB,{fullscreen:!0,editorViewId:window.editorId,targetElementId:e})}async leaveFullscreen(e){return await n.ZP.fetch(l.IB,{fullscreen:!1,editorViewId:window.editorId,targetElementId:e})}focusMainWindow(){var e;null===(e=this.win)||void 0===e||e.focus()}unload(){d.removeListener("display-added",this.onDisplayAdded),d.removeListener("display-removed",this.onDisplayRemoved),this.win.removeListener("enter-full-screen",this.onMainWindowEnterFullScreen),this.win.removeListener("leave-full-screen",this.onMainWindowLeaveFullScreen),this.closeSubWindow()}}function p(e){e||(e=o.getCurrentWindow());return{lockAspect:t=>{if(!t){const{width:i,height:o}=e.getBounds();t=i/o}e.setAspectRatio(t)},releaseAspect:()=>e.setAspectRatio(0),setMinimumSize:(t,i)=>e.setMinimumSize(t,i),setBounds:t=>e.setBounds(t),smoothOnResize:t=>{e.on("resize",(0,a.P2)((()=>window.requestAnimationFrame(t)),1e3/60))},closeWindow:()=>e.close(),onWindowClose:t=>e.on("close",t),computeSuitableWindowSize:v,computeSuitableSlideSizeIdFromWindowSize:h}}function h(e){e||(e=o.getCurrentWindow().getContentSize());const t=e[0]/e[1];let i="16:9",n=1/0;for(const e of Object.keys(r.IE)){if(!/\d+:\d+/.test(e))continue;const o=e.split(":").map((e=>Number(e))),l=Math.abs(o[0]/o[1]-t);l<n&&(n=l,i=e)}return i}function v(e){const t=m().bounds,i=e=>e.width+80<t.width&&e.height+80<t.height;let o=F(function(){const e=m();if(!e)return"16:9";const t=e.bounds,i=t.width/t.height;let o="16:9",n=1/0;for(const e of Object.keys(r.IE)){if(!/\d+:\d+/.test(e))continue;const t=e.split(":").map((e=>Number(e))),l=Math.abs(t[0]/t[1]-i);l<n&&(n=l,o=e)}return o}());const n={width:1280,height:Math.floor(1280/o),x:0,y:0,minWidth:360,minHeight:360};if("Auto"!==e&&(o=F(e),n.height=Math.floor(n.width/o),o<1?n.minHeight=Math.floor(n.minWidth/o):n.minWidth=Math.floor(n.minHeight*o)),!i(n))for(const e of[960,640,360])if(n.width=e,n.height=Math.floor(e/o),i(n))break;return n.x=Math.floor(t.x+(t.width-n.width)/2),n.y=Math.floor(t.y+(t.height-n.height)/2),n}function F(e){const t=e.split(":").map((e=>Number(e)));return t[0]/t[1]}function m(){const e=o.screen,t=o.getCurrentWindow().getBounds();return e.getDisplayMatching(t)}},80705:(e,t,i)=>{i.r(t),i.d(t,{enterPitchMode:()=>a,startWindowedPitch:()=>d});var o=i(90435),n=i(54856),l=i(46016),s=i(84374),r=i(45133);function a(e){const t=(0,l.$)();t.pitchMode||(t.updateRightBarPanel({visible:!1}),t.setPitchMode({mode:!0,isPresenterView:e.isPresenterView}))}async function d(){var e,t;const{slideAspect:i,slideTheme:l,watermarkEnabled:a,animationEnabled:d}=(0,r.Y$)(),{computeSuitableWindowSize:u}=(0,r._x)(),{selection:c}=(0,s.nZ)(),p="topic"===(null===(e=c.value)||void 0===e?void 0:e.type)&&null!==(t=c.value.modelIds[0])&&void 0!==t?t:"",h=(0,r.zF)();return(await o.ZP.fetch(n.Fx,{name:"presentationwindowed",query:{editorId:window.editorId,portalId:h,startTopicId:p,initialAspect:i.value,initialSlideTheme:l.value,initialWatermarkEnabled:`${a.value}`,initialAnimationEnabled:`${d.value}`},backgroundThrottling:!1,overrideSetting:{...u(i.value),center:!0,fullscreen:!1,backgroundColor:"#000000"}})).id}}}]);